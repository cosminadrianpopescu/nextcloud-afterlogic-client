(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["main"],{

/***/ "./$$_lazy_route_resource lazy recursive":
/*!******************************************************!*\
  !*** ./$$_lazy_route_resource lazy namespace object ***!
  \******************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

function webpackEmptyAsyncContext(req) {
	// Here Promise.resolve().then() is used instead of new Promise() to prevent
	// uncaught exception popping up in devtools
	return Promise.resolve().then(function() {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	});
}
webpackEmptyAsyncContext.keys = function() { return []; };
webpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;
module.exports = webpackEmptyAsyncContext;
webpackEmptyAsyncContext.id = "./$$_lazy_route_resource lazy recursive";

/***/ }),

/***/ "./node_modules/@ionic/core/dist/esm lazy recursive ^\\.\\/.*\\.entry\\.js$ include: \\.entry\\.js$ exclude: \\.system\\.entry\\.js$":
/*!*****************************************************************************************************************************************!*\
  !*** ./node_modules/@ionic/core/dist/esm lazy ^\.\/.*\.entry\.js$ include: \.entry\.js$ exclude: \.system\.entry\.js$ namespace object ***!
  \*****************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

var map = {
	"./ion-action-sheet-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-action-sheet-ios.entry.js",
		"common",
		0
	],
	"./ion-action-sheet-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-action-sheet-md.entry.js",
		"common",
		1
	],
	"./ion-alert-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-alert-ios.entry.js",
		"common",
		2
	],
	"./ion-alert-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-alert-md.entry.js",
		"common",
		3
	],
	"./ion-app_8-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-app_8-ios.entry.js",
		"common",
		4
	],
	"./ion-app_8-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-app_8-md.entry.js",
		"common",
		5
	],
	"./ion-avatar_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-avatar_3-ios.entry.js",
		"common",
		6
	],
	"./ion-avatar_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-avatar_3-md.entry.js",
		"common",
		7
	],
	"./ion-back-button-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-back-button-ios.entry.js",
		"common",
		8
	],
	"./ion-back-button-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-back-button-md.entry.js",
		"common",
		9
	],
	"./ion-backdrop-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-backdrop-ios.entry.js",
		10
	],
	"./ion-backdrop-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-backdrop-md.entry.js",
		11
	],
	"./ion-button_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-button_2-ios.entry.js",
		"common",
		12
	],
	"./ion-button_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-button_2-md.entry.js",
		"common",
		13
	],
	"./ion-card_5-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-card_5-ios.entry.js",
		"common",
		14
	],
	"./ion-card_5-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-card_5-md.entry.js",
		"common",
		15
	],
	"./ion-checkbox-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-checkbox-ios.entry.js",
		"common",
		16
	],
	"./ion-checkbox-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-checkbox-md.entry.js",
		"common",
		17
	],
	"./ion-chip-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-chip-ios.entry.js",
		"common",
		18
	],
	"./ion-chip-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-chip-md.entry.js",
		"common",
		19
	],
	"./ion-col_3.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-col_3.entry.js",
		20
	],
	"./ion-datetime_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-datetime_3-ios.entry.js",
		"common",
		21
	],
	"./ion-datetime_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-datetime_3-md.entry.js",
		"common",
		22
	],
	"./ion-fab_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-fab_3-ios.entry.js",
		"common",
		23
	],
	"./ion-fab_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-fab_3-md.entry.js",
		"common",
		24
	],
	"./ion-img.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-img.entry.js",
		25
	],
	"./ion-infinite-scroll_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-infinite-scroll_2-ios.entry.js",
		26
	],
	"./ion-infinite-scroll_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-infinite-scroll_2-md.entry.js",
		27
	],
	"./ion-input-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-input-ios.entry.js",
		"common",
		28
	],
	"./ion-input-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-input-md.entry.js",
		"common",
		29
	],
	"./ion-item-option_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-item-option_3-ios.entry.js",
		"common",
		30
	],
	"./ion-item-option_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-item-option_3-md.entry.js",
		"common",
		31
	],
	"./ion-item_8-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-item_8-ios.entry.js",
		"common",
		32
	],
	"./ion-item_8-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-item_8-md.entry.js",
		"common",
		33
	],
	"./ion-loading-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-loading-ios.entry.js",
		"common",
		34
	],
	"./ion-loading-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-loading-md.entry.js",
		"common",
		35
	],
	"./ion-menu_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-menu_3-ios.entry.js",
		"common",
		36
	],
	"./ion-menu_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-menu_3-md.entry.js",
		"common",
		37
	],
	"./ion-modal-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-modal-ios.entry.js",
		"common",
		38
	],
	"./ion-modal-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-modal-md.entry.js",
		"common",
		39
	],
	"./ion-nav_2.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-nav_2.entry.js",
		"common",
		40
	],
	"./ion-popover-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-popover-ios.entry.js",
		"common",
		41
	],
	"./ion-popover-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-popover-md.entry.js",
		"common",
		42
	],
	"./ion-progress-bar-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-progress-bar-ios.entry.js",
		"common",
		43
	],
	"./ion-progress-bar-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-progress-bar-md.entry.js",
		"common",
		44
	],
	"./ion-radio_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-radio_2-ios.entry.js",
		"common",
		45
	],
	"./ion-radio_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-radio_2-md.entry.js",
		"common",
		46
	],
	"./ion-range-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-range-ios.entry.js",
		"common",
		47
	],
	"./ion-range-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-range-md.entry.js",
		"common",
		48
	],
	"./ion-refresher_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-refresher_2-ios.entry.js",
		"common",
		49
	],
	"./ion-refresher_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-refresher_2-md.entry.js",
		"common",
		50
	],
	"./ion-reorder_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-reorder_2-ios.entry.js",
		"common",
		51
	],
	"./ion-reorder_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-reorder_2-md.entry.js",
		"common",
		52
	],
	"./ion-ripple-effect.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-ripple-effect.entry.js",
		53
	],
	"./ion-route_4.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-route_4.entry.js",
		"common",
		54
	],
	"./ion-searchbar-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-searchbar-ios.entry.js",
		"common",
		55
	],
	"./ion-searchbar-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-searchbar-md.entry.js",
		"common",
		56
	],
	"./ion-segment_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-segment_2-ios.entry.js",
		"common",
		57
	],
	"./ion-segment_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-segment_2-md.entry.js",
		"common",
		58
	],
	"./ion-select_3-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-select_3-ios.entry.js",
		"common",
		59
	],
	"./ion-select_3-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-select_3-md.entry.js",
		"common",
		60
	],
	"./ion-slide_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-slide_2-ios.entry.js",
		61
	],
	"./ion-slide_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-slide_2-md.entry.js",
		62
	],
	"./ion-spinner.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-spinner.entry.js",
		"common",
		63
	],
	"./ion-split-pane-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-split-pane-ios.entry.js",
		64
	],
	"./ion-split-pane-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-split-pane-md.entry.js",
		65
	],
	"./ion-tab-bar_2-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-tab-bar_2-ios.entry.js",
		"common",
		66
	],
	"./ion-tab-bar_2-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-tab-bar_2-md.entry.js",
		"common",
		67
	],
	"./ion-tab_2.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-tab_2.entry.js",
		"common",
		68
	],
	"./ion-text.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-text.entry.js",
		"common",
		69
	],
	"./ion-textarea-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-textarea-ios.entry.js",
		"common",
		70
	],
	"./ion-textarea-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-textarea-md.entry.js",
		"common",
		71
	],
	"./ion-toast-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-toast-ios.entry.js",
		"common",
		72
	],
	"./ion-toast-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-toast-md.entry.js",
		"common",
		73
	],
	"./ion-toggle-ios.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-toggle-ios.entry.js",
		"common",
		74
	],
	"./ion-toggle-md.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-toggle-md.entry.js",
		"common",
		75
	],
	"./ion-virtual-scroll.entry.js": [
		"./node_modules/@ionic/core/dist/esm/ion-virtual-scroll.entry.js",
		76
	]
};
function webpackAsyncContext(req) {
	if(!__webpack_require__.o(map, req)) {
		return Promise.resolve().then(function() {
			var e = new Error("Cannot find module '" + req + "'");
			e.code = 'MODULE_NOT_FOUND';
			throw e;
		});
	}

	var ids = map[req], id = ids[0];
	return Promise.all(ids.slice(1).map(__webpack_require__.e)).then(function() {
		return __webpack_require__(id);
	});
}
webpackAsyncContext.keys = function webpackAsyncContextKeys() {
	return Object.keys(map);
};
webpackAsyncContext.id = "./node_modules/@ionic/core/dist/esm lazy recursive ^\\.\\/.*\\.entry\\.js$ include: \\.entry\\.js$ exclude: \\.system\\.entry\\.js$";
module.exports = webpackAsyncContext;

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/attachments.html":
/*!*************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/attachments.html ***!
  \*************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div [hidden]=\"attachments.length == 0\">\n  <p-table [value]=\"attachments\" [loading]=\"view._attDownloading\">\n    <ng-template pTemplate=\"header\">\n      <tr>\n        <th style=\"width: 3em\"></th>\n        <th style=\"text-align: left\">\n          Attachment\n        </th>\n        <th style=\"width: 3em\"></th>\n        <th style=\"width: 3em\" *ngIf=\"view._isCloud && message\"></th>\n      </tr>\n    </ng-template>\n    <ng-template pTemplate=\"body\" let-row>\n      <tr>\n        <td><i class=\"fa fa-{{row | fileIcon}}\"></i></td>\n        <td (click)=\"view._viewAttachment(row)\">\n          <div>{{row.FileName}}</div>\n          <div>{{(row.EstimatedSize || row.Size) | humanFileSize}}</div>\n        </td>\n        <td>\n          <i *ngIf=\"message\" (click)=\"view._downloadAttachment(row)\" class=\"fa fa-download\"></i>\n          <i *ngIf=\"!message\" (click)=\"view._removeAttachment(row)\" class=\"fa fa-trash\"></i>\n        </td>\n        <td *ngIf=\"view._isCloud && message\">\n          <i (click)=\"view._uploadToCloud(row)\" class=\"fa fa-cloud-download\"></i>\n        </td>\n      </tr>\n    </ng-template>\n  </p-table>\n</div>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/avatar.html":
/*!********************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/avatar.html ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div [style.background-color]=\"contact | avatarColor\" class=\"color-circle\">\n  <span class=\"text\">{{contact | avatarText}}</span>\n</div>\n\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/compose.html":
/*!*********************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/compose.html ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"form\" *ngIf=\"view._model\">\n  <div class=\"p-grid ui-fluid\">\n    <div class=\"p-col-6\"></div>\n    <div class=\"p-col-6 options\">\n      <button (click)=\"view._save(false)\" style=\"width: 73px\" pButton icon=\"fa fa-floppy-o\" label=\"Save\"></button>\n      <button (click)=\"view._send()\" style=\"width: 73px; margin-left: 10px;\" pButton icon=\"fa fa-paper-plane\" label=\"Send\"></button>\n      <button (click)=\"view._attach()\" style=\"width: 87px; margin-left: 10px\" pButton icon=\"{{view._attaching ? 'fa fa-spinner fa-spin' : 'fa fa-paperclip'}}\" label=\"Attach\"></button>\n      <button *ngIf=\"view._incloud\" (click)=\"view._cloudAttach()\" style=\"width: 87px; margin-left: 10px\" pButton icon=\"{{view._cloudAttaching ? 'fa fa-spinner fa-spin' : 'fa fa-cloud'}}\" label=\"Attach\"></button>\n      <input #file type=\"file\" multiple=\"true\" style=\"display: none\"/>\n    </div>\n    <div class=\"p-col-12\" *ngIf=\"view._combinedView\">\n      <span class=\"ui-inputgroup ui-float-label\">\n        <p-dropdown id=\"from-dropdown\"\n          [options]=\"view._accounts$ | async\"\n          [(ngModel)]=\"view._account\"\n          [disabled]=\"view._model?.Attachments.length > 0\"\n          optionLabel=\"Email\"></p-dropdown>\n        <label for=\"from-dropdown\">From</label>\n      </span>\n    </div>\n    <ng-container [ngTemplateOutlet]=\"field\" [ngTemplateOutletContext]=\"{$implicit: {field: 'To'}}\"></ng-container>\n    <ng-container [ngTemplateOutlet]=\"field\" [ngTemplateOutletContext]=\"{$implicit: {field: 'Cc'}}\"></ng-container>\n    <ng-container [ngTemplateOutlet]=\"field\" [ngTemplateOutletContext]=\"{$implicit: {field: 'Bcc'}}\"></ng-container>\n    <div class=\"p-col-12\">\n      <span class=\"ui-inputgroup ui-float-label\">\n        <input type=\"text\" pInputText id=\"subject-id\" [(ngModel)]=\"view._model.Subject\"/>\n        <label for=\"subject-id\">Subject</label>\n      </span>\n    </div>\n    <div class=\"p-col-12\">\n      <al-editor [(model)]=\"view._model.Body\" #editor *ngIf=\"view._type == 'HTML'\"></al-editor>\n      <textarea pInputTextarea [(ngModel)]=\"view._model.Body\" *ngIf=\"view._type != 'HTML'\"></textarea>\n    </div>\n    <div class=\"p-col-12\">\n      <al-attachments [account]=\"view._account\" [attachments]=\"view._model.Attachments\" autoResize=\"autoResize\"></al-attachments>\n    </div>\n  </div>\n\n  <ng-template #field let-context>\n    <div class=\"p-col-12\" [hidden]=\"!view._showCc && context.field != 'To'\">\n      <span class=\"ui-inputgroup ui-float-label\">\n        <p-autoComplete\n          #autocomplete\n          [(ngModel)]=\"view._model[context.field]\"\n          [suggestions]=\"view._contacts\"\n          [autoHighlight]=\"true\"\n          (onBlur)=\"view._blur(autocomplete)\"\n          (onFocus)=\"view._focus(autocomplete)\"\n          delay=\"0\"\n          [id]=\"context.field\"\n          [multiple]=\"true\"\n          field=\"display\"\n          (completeMethod)=\"view._filterContact($event)\"\n          >\n          <ng-template pTemplate=\"item\" let-item>\n            <span *ngIf=\"item.DisplayName\">{{item.DisplayName}} ({{item.Email}})</span>\n            <span *ngIf=\"!item.DisplayName\">{{item.Email}}</span>\n          </ng-template>\n        </p-autoComplete>\n        <button (click)=\"view._showCc = true\" pButton icon=\"fa fa-angle-down\" *ngIf=\"!view._showCc && context.field == 'To'\"></button>\n        <label [for]=\"context.field\">{{context.field}}</label>\n      </span>\n    </div>\n  </ng-template>\n</div>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/editor.html":
/*!********************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/editor.html ***!
  \********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"editor\" #editor contenteditable=\"true\" [innerHTML]=\"view._html | asHtml\" (keyup)=\"view._keyup()\"></div>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/folders-list.html":
/*!**************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/folders-list.html ***!
  \**************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div style=\"position: relative\">\n  <p-blockUI [target]=\"folders\" [blocked]=\"view._loading\"></p-blockUI>\n  <div #folders>\n    <p-tree selectionMode=\"single\" (onNodeSelect)=\"view._select($event.node?.data)\" [value]=\"view._account?.Folders$ | async | foldersTree\">\n      <ng-template let-node pTemplate=\"default\">\n        <span [ngClass]=\"{selected: view._selected == node.data}\">{{node.data | folderLabel | async}}</span>\n      </ng-template>\n    </p-tree>\n  </div>\n</div>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/home.html":
/*!******************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/home.html ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<ng-container [ngTemplateOutlet]=\"view._isMobile ? mobile : desktop\"></ng-container>\n\n<ng-template #desktop>\n  <p-table [value]=\"view._row\" [resizableColumns]=\"true\">\n    <ng-template pTemplate=\"header\">\n      <tr>\n        <th class=\"folders-col\">\n          <button (click)=\"view._newMessage('new')\" pButton icon=\"fa fa-envelope-o\" label=\"New message\"></button>\n        </th>\n        <th class=\"mails-col\">\n          <div>\n            <div class=\"left\">\n              <ng-container [ngTemplateOutlet]=\"toolbarButtons\" [ngTemplateOutletContext]=\"{$implicit: actionButton}\"></ng-container>\n            </div>\n            <div class=\"right\">\n              <button (click)=\"view._refresh()\" pButton icon=\"{{view._refreshing ? 'fa fa-spinner fa-spin' : 'fa fa-refresh'}}\"></button>\n            </div>\n          </div>\n        </th>\n        <th class=\"mail-col\">\n          <div class=\"right\">\n            {{view._account | currentEmail}}\n            <p-menu #menu [popup]=\"true\" [model]=\"view._userMenu\" styleClass=\"menuWidth\"></p-menu>\n            <button type=\"button\" pButton icon=\"fa fa-user\" (click)=\"menu.toggle($event)\"></button>\n          </div>\n        </th>\n      </tr>\n    </ng-template>\n    <ng-template pTemplate=\"body\">\n      <tr class=\"top\">\n        <td>\n          <div class=\"wrapper\">\n            <al-folders-list [account]=\"view._account\"></al-folders-list>\n          </div>\n        </td>\n        <td>\n          <div class=\"messages-wrapper\">\n            <al-messages-list\n              #messagesList\n              (selectionChanged)=\"view._selectionChanged($event)\"\n              (notify)=\"view._messageNotify($event)\"\n              [account]=\"view._account\"\n              [folder]=\"view._folder\"></al-messages-list>\n          </div>\n        </td>\n        <td>\n          <div class=\"wrapper\">\n            <al-message (notify)=\"view._msgBodyNotify($event)\" [message]=\"view._message\"></al-message>\n          </div>\n        </td>\n      </tr>\n    </ng-template>\n  </p-table>\n  <p-dialog\n    (onHide)=\"view._hideCompose(null)\"\n    [autoZIndex]=\"false\"\n    [header]=\"view._composeTitle\" [(visible)]=\"view._compose\"\n    [closeOnEscape]=\"true\" [style]=\"{width: '600px'}\">\n    <al-compose\n      (notify)=\"view._hideCompose($event)\"\n      *ngIf=\"view._composer\"\n      [composeType]=\"view._composeType\"\n      [message]=\"view._composeMessage\"\n      [to]=\"view._composeTo\"></al-compose>\n  </p-dialog>\n  <p-dialog header=\"Settings\" [resizable]=\"true\" [closeOnEscape]=\"true\" [style]=\"{width: '600px'}\" [(visible)]=\"view._showSettings\">\n    <al-settings></al-settings>\n  </p-dialog>\n</ng-template>\n<ng-template #mobile>\n  <p-sidebar [style]=\"{width: '400px'}\" [(visible)]=\"view._toolbarVisible\" [baseZIndex]=\"10000\">\n    <div class=\"p-grid ui-fluid\">\n      <div class=\"flex p-col-12\" *ngFor=\"let account of (view._accounts$ | async)\">\n        <div class=\"avatar\">\n          <al-avatar [contact]=\"account | accountToContact\"></al-avatar>\n        </div>\n        <div class=\"account\" [ngClass]=\"{selected: account.Email == view._account?.Email}\" (click)=\"view._changeAccount(account.Email)\">\n          <h3 class=\"name\" *ngIf=\"account.FriendlyName\">{{account.FriendlyName}}</h3>\n          <h4 class=\"email\" *ngIf=\"!(account | isCombinedAccount)\">{{account.Email}}</h4>\n          <h4 class=\"email\" *ngIf=\"account | isCombinedAccount\">{{(view._accounts$ | async | count) - 1}} accounts</h4>\n        </div>\n      </div>\n      <div class=\"p-col-12\">\n        <al-folders-list [account]=\"view._account\"></al-folders-list>\n      </div>\n      <div class=\"p-col-12\" (click)=\"view._settingsClick()\">\n        <i class=\"fa fa-cog\"></i> Settings\n      </div>\n    </div>\n  </p-sidebar>\n\n  <p-toolbar>\n    <div class=\"ui-toolbar-group-left\">\n      <i (click)=\"view._toolbarVisible = true\"\n        [hidden]=\"view._mobileViewType != 'list'\"\n        class=\"fa fa-bars\"\n        style=\"vertical-align: middle\"></i>\n      <i (click)=\"view._toolbarBack()\" \n        [hidden]=\"view._mobileViewType == 'list'\"\n        class=\"fa fa-arrow-left\"\n        style=\"vertical-align: middle\"></i>\n      <i (click)=\"view._newMessage('new')\" \n        [hidden]=\"view._mobileViewType != 'list'\"\n        class=\"fa fa-plus\"\n        style=\"vertical-align: middle\"></i>\n      <ng-container [ngTemplateOutlet]=\"toolbarButtons\" [ngTemplateOutletContext]=\"{$implicit: actionIcon}\"></ng-container>\n      <i (click)=\"view._refresh()\" \n        [hidden]=\"view._mobileViewType != 'list'\"\n        class=\"{{view._refreshing ? 'fa fa-spinner fa-spin' : 'fa fa-refresh'}}\"\n        style=\"vertical-align: middle\"></i>\n    </div>\n  </p-toolbar>\n\n  <div class=\"p-grid ui-fluid mobile-messages-list\">\n    <al-messages-list\n      class=\"mobile\"\n      [hidden]=\"view._mobileViewType != 'list'\"\n      #messagesList\n      (selectionChanged)=\"view._selectionChanged($event)\"\n      (notify)=\"view._messageNotify($event)\"\n      [account]=\"view._account\"\n      [folder]=\"view._folder\"></al-messages-list>\n    <div class=\"wrapper w100 ui-fluid p-grid\" [hidden]=\"view._mobileViewType != 'message'\">\n      <al-message (notify)=\"view._msgBodyNotify($event)\" [message]=\"view._message\"></al-message>\n    </div>\n\n    <div class=\"wrapper w100 padding-10\" *ngIf=\"view._mobileViewType == 'settings'\">\n      <al-settings></al-settings>\n    </div>\n\n    <div class=\"w100 padding-10\" [hidden]=\"view._mobileViewType != 'compose'\">\n      <al-compose\n        (notify)=\"view._hideCompose($event)\"\n        *ngIf=\"view._composer\"\n        [composeType]=\"view._composeType\"\n        [message]=\"view._composeMessage\"\n        [to]=\"view._composeTo\"></al-compose>\n    </div>\n  </div>\n</ng-template>\n<ng-template #toolbarButtons let-tpl>\n  <ng-container [ngTemplateOutlet]=\"tpl\" [ngTemplateOutletContext]=\"{$implicit: {icon: 'envelope-open-o', action: 'mark-read'}}\"></ng-container>\n  <ng-container [ngTemplateOutlet]=\"tpl\" [ngTemplateOutletContext]=\"{$implicit: {icon: 'envelope-o', action: 'mark-unread'}}\"></ng-container>\n  <ng-container [ngTemplateOutlet]=\"tpl\" [ngTemplateOutletContext]=\"{$implicit: {icon: 'trash-o', action: 'delete'}}\"></ng-container>\n  <ng-container [ngTemplateOutlet]=\"tpl\" [ngTemplateOutletContext]=\"{$implicit: {icon: view._spamFolder ? 'thumbs-o-up' : 'thumbs-o-down', action: 'spam'}}\"></ng-container>\n</ng-template>\n<ng-template #actionIcon let-context>\n  <i (click)=\"view._actionIcon(context.action)\" \n    [hidden]=\"view._mobileViewType != 'list'\"\n    class=\"fa fa-{{context.icon}}\"\n    [ngClass]=\"{disabled: view._selection?.length == 0 && !view._message}\"\n    style=\"vertical-align: middle\"></i>\n</ng-template>\n<ng-template #actionButton let-context>\n  <button (click)=\"view._action(context.action)\" pButton [disabled]=\"view._selection?.length == 0 && !view._message\" icon=\"fa fa-{{context.icon}}\"></button>\n</ng-template>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/loading.html":
/*!*********************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/loading.html ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<p-blockUI [blocked]=\"true\" #blockedUI [target]=\"target\">\n    <i class=\"fa fa-spinner fa-spin fa-3w\" style=\"position:absolute;top:calc(50% - 30px);left:calc(50% - 30px);font-size: 60px;font-weight: bold\"></i>\n</p-blockUI>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/main.html":
/*!******************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/main.html ***!
  \******************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<span [hidden]=\"!view._ready\">\n  <div class=\"content\">\n    <router-outlet></router-outlet>\n  </div>\n</span>\n<p-toast key=\"abc\" position=\"top-center\"></p-toast>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/message.html":
/*!*********************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/message.html ***!
  \*********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"center p-grid ui-fluid\" *ngIf=\"!view._message\">\n  <div class=\"p-col-12\"><h2>No message selected</h2></div>\n  <div class=\"p-col-12\">Select a message from the list in order to view it!</div>\n</div>\n<div style=\"position: relative\" *ngIf=\"view._message\" class=\"main-container\">\n  <div class=\"ui-fluid p-grid\">\n    <div class=\"p-col-11\">\n      <h2>{{view._message?.Subject}}</h2>\n    </div>\n    <div class=\"p-col-1\">\n      <i (click)=\"view._star()\" class=\"fa fa-star{{!view._message?.IsFlagged ? '-o' : ''}}\"></i>\n    </div>\n    <div class=\"p-col avatar\">\n      <al-avatar [contact]=\"view._message | messageFrom\"></al-avatar>\n    </div>\n    <div class=\"p-col details\">\n      <div>{{view._message | messageFrom | messageFromTxt}}</div>\n      <div>{{view._message | messageDate}}\n        <span (click)=\"view._detailsHidden = !view._detailsHidden\" class=\"extra\">{{view._detailsHidden ? 'Show' : 'Hide'}} details</span>\n      </div>\n      <div [hidden]=\"view._detailsHidden\" class=\"extra-details\">\n        <ng-container [ngTemplateOutlet]=\"detailsTpl\" [ngTemplateOutletContext]=\"{$implicit: 'From'}\"></ng-container>\n        <ng-container [ngTemplateOutlet]=\"detailsTpl\" [ngTemplateOutletContext]=\"{$implicit: 'To'}\"></ng-container>\n        <ng-container [ngTemplateOutlet]=\"detailsTpl\" [ngTemplateOutletContext]=\"{$implicit: 'Cc'}\"></ng-container>\n        <ng-template #detailsTpl let-field>\n          <div>{{field}}: \n            <span\n              (click)=\"view._emailClick(contact)\"\n              class=\"contact-detail\"\n              *ngFor=\"let contact of (view._message[field] | contactsArray)\"\n              [innerHTML]=\"contact | messageFromTxtFull | asHtml\"></span>\n          </div>\n        </ng-template>\n      </div>\n      <div [hidden]=\"!view._hasImages\" (click)=\"view._showImages()\">\n        <i class=\"fa fa-picture-o\"></i>&nbsp;Show images\n      </div>\n    </div>\n    <div class=\"p-col actions\">\n      <i *ngIf=\"!view._isDraft\" (click)=\"view._action('reply')\" class=\"fa fa-reply\"></i>\n      <i *ngIf=\"view._isDraft\" (click)=\"view._action('from-draft')\" class=\"fa fa-pencil\"></i>\n      <span (click)=\"menu.toggle($event)\">\n        <i class=\"fa fa-ellipsis-v\"></i>\n      </span>\n    </div>\n  </div>\n  <div class=\"message-body\" [ngClass]=\"{'hide-quote': view._quotedText}\" #messageBody [innerHTML]=\"view._html | asHtml\"></div>\n  <div [hidden]=\"!view._quotedText\">\n    <div (click)=\"view._showHiddenContent()\" class=\"extra\">Show quoted text</div>\n  </div>\n  <div class=\"attachments\" [hidden]=\"!view._message || (view._message | attachmentsList).length == 0\">\n    <al-attachments [attachments]=\"view._message | attachmentsList\" [message]=\"view._message\" [account]=\"view._account\"></al-attachments>\n  </div>\n</div>\n<p-overlayPanel #menu styleClass=\"max-width\">\n  <ng-template pTemplate>\n    <div class=\"p-grid ui-fluid menu-options\">\n      <div class=\"p-col-12\" (click)=\"view._action('reply-all'); menu.hide()\"><i class=\"fa fa-reply-all\"></i>Reply all</div>\n      <div class=\"p-col-12\" (click)=\"view._action('forward'); menu.hide()\"><i class=\"fa fa-share\"></i>Forward</div>\n      <div class=\"p-col-12\" (click)=\"view._download(); menu.hide()\"><i class=\"fa fa-download\"></i>Download</div>\n    </div>\n  </ng-template>\n</p-overlayPanel>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/messages-list.html":
/*!***************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/messages-list.html ***!
  \***************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<p-table #table [value]=\"view._messages\" [lazy]=\"true\" selectionMode=\"single\" (onLazyLoad)=\"view._loadMessages($event)\" [paginator]=\"true\"\n  [loading]=\"view._loading\" [rows]=\"view._pageSize\" [totalRecords]=\"view._totalRecords\" (onRowSelect)=\"view._selectionChanged()\"\n  (onRowUnselect)=\"view._selectionChanged()\" (onHeaderCheckboxToggle)=\"view._selectionChanged()\" [pageLinks]=\"view._combinedView ? 1 : 5\"\n  [ngClass]=\"{'combined-view': view._combinedView}\">\n  <ng-template pTemplate=\"header\">\n    <tr>\n      <th style=\"width: 3em\">\n        <p-tableHeaderCheckbox></p-tableHeaderCheckbox>\n      </th>\n      <th>\n        <div class=\"header p-grid ui-fluid\">\n          <div class=\"p-col-12\">\n            <div class=\"ui-inputgroup\">\n              <input (keyup)=\"view._keyup($event)\" [(ngModel)]=\"view._search.simple\" type=\"text\" pInputText placeholder=\"Search\">\n              <i (click)=\"view._clearSearch()\" class=\"fa fa-times\" *ngIf=\"view._search.simple\"></i>\n              <button (click)=\"advancedSearch.toggle($event)\" pButton icon=\"fa fa-angle-down\"></button>\n            </div>\n          </div>\n        </div>\n      </th>\n    </tr>\n  </ng-template>\n  <ng-template pTemplate=\"body\" let-row>\n    <tr [ngClass]=\"{'ui-state-highlight': view._selected?.Uid == row.Uid}\">\n      <td>\n        <p-tableCheckbox [value]=\"row\"></p-tableCheckbox>\n      </td>\n      <td [ngClass]=\"{unread: !row.IsSeen}\" (click)=\"view._select(row)\" [ngStyle]=\"row | borderRight | async\">\n        <div class=\"p-grid ui-fluid\">\n          <div class=\"avatar\" *ngIf=\"row.From.Collection?.length > 0\">\n            <al-avatar [contact]=\"row.From.Collection[0]\"></al-avatar>\n          </div>\n          <div class=\"message\">\n            <div class=\"flex ui-fluid\">\n              <div class=\"from\">{{row | messageFrom | messageFromTxt}}</div>\n              <div class=\"flags\">\n                <i *ngIf=\"row.IsForwarded\" class=\"fa fa-share\"></i>\n                <i *ngIf=\"row.IsAnswered\" class=\"fa fa-reply\"></i>\n                <i *ngIf=\"row.HasAttachments\" class=\"fa fa-paperclip\"></i>\n              </div>\n              <div class=\"date\">{{row | messageDate}}</div>\n            </div>\n            <div class=\"flex ui-fluid margin-top\">\n              <div class=\"subject\">\n                <i *ngIf=\"row.IsFlagged\" class=\"fa fa-star\"></i>{{row.Subject}}\n              </div>\n            </div>\n          </div>\n        </div>\n      </td>\n    </tr>\n  </ng-template>\n</p-table>\n\n<p-overlayPanel #advancedSearch [dismissable]=\"false\" baseZIndex=\"990\">\n  <ng-template pTemplate>\n    <div class=\"p-grid ui-fluid\">\n      <div class=\"p-col-6\"><input type=\"text\" [(ngModel)]=\"view._search.from\" pInputText placeholder=\"From\"/></div>\n      <div class=\"p-col-6\"><input type=\"text\" [(ngModel)]=\"view._search.to\" pInputText placeholder=\"To\"/></div>\n      <div class=\"p-col-6\"><input type=\"text\" [(ngModel)]=\"view._search.subject\" pInputText placeholder=\"Subject\"/></div>\n      <div class=\"p-col-6\"><input type=\"text\" [(ngModel)]=\"view._search.text\" pInputText placeholder=\"Text\"/></div>\n      <div class=\"p-col-6\"><p-calendar [touchUI]=\"true\" [readonlyInput]=\"true\" [(ngModel)]=\"view._search.since\" placeholder=\"Since\" [showIcon]=\"true\"></p-calendar></div>\n      <div class=\"p-col-6\"><p-calendar [touchUI]=\"true\" [readonlyInput]=\"true\" [(ngModel)]=\"view._search.till\" placeholder=\"Till\" [showIcon]=\"true\"></p-calendar></div>\n      <div class=\"p-col-6\"><p-checkbox [binary]=\"true\" label=\"Has Attachments\" [(ngModel)]=\"view._search.attachments\"></p-checkbox></div>\n      <div class=\"p-col-6 right\"><button (click)=\"view._advSearch(); advancedSearch.hide()\" pButton label=\"Search\"></button></div>\n    </div>\n  </ng-template>\n</p-overlayPanel>\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/playground.html":
/*!************************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/playground.html ***!
  \************************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div>\n  <al-compose composeType=\"new\"></al-compose>\n</div>\n  <!--div>\n    <al-folders-list [account]=\"view._account\" (notify)=\"view._folderNotify($event)\"></al-folders-list>\n  </div>\n  <div>\n    <al-messages-list (notify)=\"view._messageNotify($event)\" [account]=\"view._account\" [folder]=\"view._folder\"></al-messages-list>\n  </div>\n  <div>\n    <al-message (notify)=\"view._msgBodyNotify($event)\" [message]=\"view._message\"></al-message>\n  </div-->\n");

/***/ }),

/***/ "./node_modules/raw-loader/dist/cjs.js!./src/html/settings.html":
/*!**********************************************************************!*\
  !*** ./node_modules/raw-loader/dist/cjs.js!./src/html/settings.html ***!
  \**********************************************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("<div class=\"content-section\" *ngIf=\"view._model\">\n  <p-panel header=\"Server\">\n    <div class=\"panel-container p-fluid forms-grid ui-fluid\" style=\"margin: 1em 0;\">\n      <div class=\"flex\">\n        <span class=\"ui-float-label\">\n          <input type=\"text\" id=\"server-url\" pInputText [ngModel]=\"view._model?.server.url\" (ngModelChange)=\"view._model.server.url = $event\" />\n          <label for=\"server-url\">Server url</label>\n        </span>\n        <p-message [hidden]=\"view._model.server && view._model.server.url\" severity=\"error\" text=\"Url is required\"></p-message>\n      </div>\n    </div>\n  </p-panel>\n</div>\n\n<div class=\"content-section\" *ngIf=\"view._model\">\n  <p-panel>\n    <p-header>\n      <div class=\"ui-helper-clearfix\">\n        <span class=\"ui-panel-title\">Accounts</span>\n        <button (click)=\"view._add()\" pButton style=\"float: right\" icon=\"fa fa-user-plus\"></button>\n      </div>\n    </p-header>\n    <div class=\"panel-container p-fluid forms-grid ui-fluid\" style=\"margin: 1em 0;\">\n      <div [ngClass]=\"{invalid: view._validate && !user.token}\" class=\"flex users\" *ngFor=\"let user of view._model?.server.users || []\">\n        <span class=\"ui-float-label\">\n          <input type=\"text\" [id]=\"user.email\" pInputText [(ngModel)]=\"user.email\" />\n          <label [for]=\"user.email\">Email</label>\n        </span>\n        <span class=\"ui-float-label right\">\n          <input type=\"password\" id=\"{{user.email}}-pass\" pInputText [(ngModel)]=\"user.pass\" />\n          <label for=\"{{user.email}}-pass\">Password</label>\n        </span>\n        <button pButton icon=\"fa fa-user-times\" (click)=\"view._remove(user)\"></button>\n      </div>\n    </div>\n  </p-panel>\n</div>\n\n<div class=\"content-section\" *ngIf=\"view._model\">\n  <p-panel header=\"App settings\">\n    <div class=\"panel-container p-fluid forms-grid ui-fluid\" style=\"margin: 1em 0;\">\n      <ng-container [ngTemplateOutlet]=\"settingTpl\" [ngTemplateOutletContext]=\"{$implicit: {field: 'checkEmailInterval', label: 'Interval to check new emails (minutes)'}}\"></ng-container>\n      <ng-container [ngTemplateOutlet]=\"settingTpl\" [ngTemplateOutletContext]=\"{$implicit: {field: 'pageSize', label: 'Number of messages displayed on a page'}}\"></ng-container>\n      <ng-container [ngTemplateOutlet]=\"settingTpl\" [ngTemplateOutletContext]=\"{$implicit: {field: 'composeType', label: 'Type of messages to compose'}}\"></ng-container>\n    </div>\n  </p-panel>\n</div>\n\n<ng-template #settingTpl let-context>\n  <div class=\"flex\">\n    <span class=\"ui-float-label\">\n      <p-dropdown id=\"setting-{{context.field}}\"\n                  [options]=\"view._model[context.field].options\"\n                  [(ngModel)]=\"view._model[context.field].model\"\n                  optionLabel=\"label\"></p-dropdown>\n      <label for=\"setting-{{context.field}}\">{{context.label}}</label>\n    </span>\n  </div>\n</ng-template>\n\n<div class=\"content-section\" *ngIf=\"view._model\">\n  <button [disabled]=\"!view._model?.server.url\" pButton label=\"Save\" (click)=\"view._save()\"></button>\n</div>\n");

/***/ }),

/***/ "./src/assets/scss/attachments.scss":
/*!******************************************!*\
  !*** ./src/assets/scss/attachments.scss ***!
  \******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("i {\n  font-size: 30px;\n  margin-left: -3px;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xpeGEvcHJvZ3JhbXMvYWZ0ZXJsb2dpYy1jbGllbnQvc3JjL2Fzc2V0cy9zY3NzL2F0dGFjaG1lbnRzLnNjc3MiLCJzcmMvYXNzZXRzL3Njc3MvYXR0YWNobWVudHMuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGVBQUE7RUFDQSxpQkFBQTtBQ0NGIiwiZmlsZSI6InNyYy9hc3NldHMvc2Nzcy9hdHRhY2htZW50cy5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaSB7XG4gIGZvbnQtc2l6ZTogMzBweDtcbiAgbWFyZ2luLWxlZnQ6IC0zcHg7XG59XG4iLCJpIHtcbiAgZm9udC1zaXplOiAzMHB4O1xuICBtYXJnaW4tbGVmdDogLTNweDtcbn0iXX0= */");

/***/ }),

/***/ "./src/assets/scss/avatar.scss":
/*!*************************************!*\
  !*** ./src/assets/scss/avatar.scss ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".color-circle {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n}\n\n.text {\n  color: white;\n  text-align: center;\n  font-size: 24px;\n  font-weight: bold;\n  display: inline-block;\n  width: 40px;\n  height: 40px;\n  vertical-align: middle;\n  position: relative;\n  top: 4px;\n  font-family: \"Open Sans\";\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xpeGEvcHJvZ3JhbXMvYWZ0ZXJsb2dpYy1jbGllbnQvc3JjL2Fzc2V0cy9zY3NzL2F2YXRhci5zY3NzIiwic3JjL2Fzc2V0cy9zY3NzL2F2YXRhci5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsV0FBQTtFQUNBLFlBQUE7RUFDQSxrQkFBQTtBQ0NGOztBREVBO0VBQ0UsWUFBQTtFQUNBLGtCQUFBO0VBQ0EsZUFBQTtFQUNBLGlCQUFBO0VBQ0EscUJBQUE7RUFDQSxXQUFBO0VBQ0EsWUFBQTtFQUNBLHNCQUFBO0VBQ0Esa0JBQUE7RUFDQSxRQUFBO0VBQ0Esd0JBQUE7QUNDRiIsImZpbGUiOiJzcmMvYXNzZXRzL3Njc3MvYXZhdGFyLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29sb3ItY2lyY2xlIHtcbiAgd2lkdGg6IDQwcHg7XG4gIGhlaWdodDogNDBweDtcbiAgYm9yZGVyLXJhZGl1czogNTAlO1xufVxuXG4udGV4dCB7XG4gIGNvbG9yOiB3aGl0ZTtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBmb250LXNpemU6IDI0cHg7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIHdpZHRoOiA0MHB4O1xuICBoZWlnaHQ6IDQwcHg7XG4gIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdG9wOiA0cHg7XG4gIGZvbnQtZmFtaWx5OiBcIk9wZW4gU2Fuc1wiO1xufVxuXG4iLCIuY29sb3ItY2lyY2xlIHtcbiAgd2lkdGg6IDQwcHg7XG4gIGhlaWdodDogNDBweDtcbiAgYm9yZGVyLXJhZGl1czogNTAlO1xufVxuXG4udGV4dCB7XG4gIGNvbG9yOiB3aGl0ZTtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBmb250LXNpemU6IDI0cHg7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xuICBkaXNwbGF5OiBpbmxpbmUtYmxvY2s7XG4gIHdpZHRoOiA0MHB4O1xuICBoZWlnaHQ6IDQwcHg7XG4gIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdG9wOiA0cHg7XG4gIGZvbnQtZmFtaWx5OiBcIk9wZW4gU2Fuc1wiO1xufSJdfQ== */");

/***/ }),

/***/ "./src/assets/scss/compose.scss":
/*!**************************************!*\
  !*** ./src/assets/scss/compose.scss ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".options {\n  justify-content: flex-end;\n  display: flex;\n}\n\nbutton {\n  width: inherit;\n}\n\n.ui-float-label {\n  display: flex;\n}\n\n.form {\n  margin: 0.5em;\n  height: calc(100vh - 40px);\n  overflow-y: auto;\n}\n\n.ui-inputgroup .ui-inputtext:not(:last-child) {\n  border-right-width: thin;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xpeGEvcHJvZ3JhbXMvYWZ0ZXJsb2dpYy1jbGllbnQvc3JjL2Fzc2V0cy9zY3NzL2NvbXBvc2Uuc2NzcyIsInNyYy9hc3NldHMvc2Nzcy9jb21wb3NlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0E7RUFDRSx5QkFBQTtFQUNBLGFBQUE7QUNBRjs7QURHQTtFQUNFLGNBQUE7QUNBRjs7QURHQTtFQUNFLGFBQUE7QUNBRjs7QURHQTtFQUNFLGFBQUE7RUFDQSwwQkFBQTtFQUNBLGdCQUFBO0FDQUY7O0FER0E7RUFDRSx3QkFBQTtBQ0FGIiwiZmlsZSI6InNyYy9hc3NldHMvc2Nzcy9jb21wb3NlLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJcbi5vcHRpb25zIHtcbiAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcbiAgZGlzcGxheTogZmxleDtcbn1cblxuYnV0dG9uIHtcbiAgd2lkdGg6IGluaGVyaXQ7XG59XG5cbi51aS1mbG9hdC1sYWJlbCB7XG4gIGRpc3BsYXk6IGZsZXg7XG59XG5cbi5mb3JtIHtcbiAgbWFyZ2luOiAwLjVlbTtcbiAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNDBweCk7XG4gIG92ZXJmbG93LXk6IGF1dG87XG59XG5cbi51aS1pbnB1dGdyb3VwIC51aS1pbnB1dHRleHQ6bm90KDpsYXN0LWNoaWxkKSB7XG4gIGJvcmRlci1yaWdodC13aWR0aDogdGhpbjtcbn1cblxuIiwiLm9wdGlvbnMge1xuICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xuICBkaXNwbGF5OiBmbGV4O1xufVxuXG5idXR0b24ge1xuICB3aWR0aDogaW5oZXJpdDtcbn1cblxuLnVpLWZsb2F0LWxhYmVsIHtcbiAgZGlzcGxheTogZmxleDtcbn1cblxuLmZvcm0ge1xuICBtYXJnaW46IDAuNWVtO1xuICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA0MHB4KTtcbiAgb3ZlcmZsb3cteTogYXV0bztcbn1cblxuLnVpLWlucHV0Z3JvdXAgLnVpLWlucHV0dGV4dDpub3QoOmxhc3QtY2hpbGQpIHtcbiAgYm9yZGVyLXJpZ2h0LXdpZHRoOiB0aGluO1xufSJdfQ== */");

/***/ }),

/***/ "./src/assets/scss/editor.scss":
/*!*************************************!*\
  !*** ./src/assets/scss/editor.scss ***!
  \*************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".editor {\n  padding: 10px;\n  border: 1px solid gray;\n  width: 100% !important;\n  overflow-x: auto;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xpeGEvcHJvZ3JhbXMvYWZ0ZXJsb2dpYy1jbGllbnQvc3JjL2Fzc2V0cy9zY3NzL2VkaXRvci5zY3NzIiwic3JjL2Fzc2V0cy9zY3NzL2VkaXRvci5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0UsYUFBQTtFQUNBLHNCQUFBO0VBQ0Esc0JBQUE7RUFDQSxnQkFBQTtBQ0NGIiwiZmlsZSI6InNyYy9hc3NldHMvc2Nzcy9lZGl0b3Iuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbIi5lZGl0b3Ige1xuICBwYWRkaW5nOiAxMHB4O1xuICBib3JkZXI6IDFweCBzb2xpZCBncmF5O1xuICB3aWR0aDogMTAwJSAhaW1wb3J0YW50O1xuICBvdmVyZmxvdy14OiBhdXRvO1xufVxuIiwiLmVkaXRvciB7XG4gIHBhZGRpbmc6IDEwcHg7XG4gIGJvcmRlcjogMXB4IHNvbGlkIGdyYXk7XG4gIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7XG4gIG92ZXJmbG93LXg6IGF1dG87XG59Il19 */");

/***/ }),

/***/ "./src/assets/scss/folders-list.scss":
/*!*******************************************!*\
  !*** ./src/assets/scss/folders-list.scss ***!
  \*******************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("al-folders-list .ui-tree {\n  width: 100%;\n  border: none;\n}\nal-folders-list .ui-treenode-content:focus {\n  box-shadow: none !important;\n}\nal-folders-list .ui-tree-wrapper {\n  border: none;\n}\nal-folders-list .selected {\n  font-weight: bold;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xpeGEvcHJvZ3JhbXMvYWZ0ZXJsb2dpYy1jbGllbnQvc3JjL2Fzc2V0cy9zY3NzL2ZvbGRlcnMtbGlzdC5zY3NzIiwic3JjL2Fzc2V0cy9zY3NzL2ZvbGRlcnMtbGlzdC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUNFO0VBQ0UsV0FBQTtFQUNBLFlBQUE7QUNBSjtBREdFO0VBQ0UsMkJBQUE7QUNESjtBRElFO0VBQ0UsWUFBQTtBQ0ZKO0FES0U7RUFDRSxpQkFBQTtBQ0hKIiwiZmlsZSI6InNyYy9hc3NldHMvc2Nzcy9mb2xkZXJzLWxpc3Quc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImFsLWZvbGRlcnMtbGlzdCB7XG4gIC51aS10cmVlIHtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBib3JkZXI6IG5vbmU7XG4gIH1cblxuICAudWktdHJlZW5vZGUtY29udGVudDpmb2N1cyB7XG4gICAgYm94LXNoYWRvdzogbm9uZSAhaW1wb3J0YW50O1xuICB9XG5cbiAgLnVpLXRyZWUtd3JhcHBlciB7XG4gICAgYm9yZGVyOiBub25lO1xuICB9XG5cbiAgLnNlbGVjdGVkIHtcbiAgICBmb250LXdlaWdodDogYm9sZDtcbiAgfVxufVxuIiwiYWwtZm9sZGVycy1saXN0IC51aS10cmVlIHtcbiAgd2lkdGg6IDEwMCU7XG4gIGJvcmRlcjogbm9uZTtcbn1cbmFsLWZvbGRlcnMtbGlzdCAudWktdHJlZW5vZGUtY29udGVudDpmb2N1cyB7XG4gIGJveC1zaGFkb3c6IG5vbmUgIWltcG9ydGFudDtcbn1cbmFsLWZvbGRlcnMtbGlzdCAudWktdHJlZS13cmFwcGVyIHtcbiAgYm9yZGVyOiBub25lO1xufVxuYWwtZm9sZGVycy1saXN0IC5zZWxlY3RlZCB7XG4gIGZvbnQtd2VpZ2h0OiBib2xkO1xufSJdfQ== */");

/***/ }),

/***/ "./src/assets/scss/home.scss":
/*!***********************************!*\
  !*** ./src/assets/scss/home.scss ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("body {\n  overflow: hidden;\n}\n\napp-home #container {\n  text-align: center;\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 50%;\n  transform: translateY(-50%);\n}\n\napp-home #container strong {\n  font-size: 20px;\n  line-height: 26px;\n}\n\napp-home #container p {\n  font-size: 16px;\n  line-height: 22px;\n  color: #8c8c8c;\n  margin: 0;\n}\n\napp-home #container a {\n  text-decoration: none;\n}\n\napp-home .folders-col {\n  width: 200px;\n  max-width: 300px;\n}\n\napp-home .mails-col {\n  width: 400px;\n}\n\napp-home .mails-col button {\n  margin-left: 10px;\n}\n\napp-home .mails-col .left {\n  float: left;\n}\n\napp-home .right {\n  float: right;\n}\n\napp-home .menuWidth {\n  min-width: 300px;\n  text-align: left;\n}\n\napp-home .mail-col {\n  width: calc(100% - 600px);\n}\n\napp-home .top td {\n  vertical-align: top;\n  overflow-y: auto;\n}\n\napp-home .messages-wrapper {\n  overflow-y: hidden;\n}\n\napp-home .wrapper {\n  height: calc(100vh - 48px);\n  overflow-y: auto;\n}\n\napp-home al-messages-list .ui-table-wrapper {\n  height: calc(100vh - 97px);\n  overflow-y: auto;\n}\n\napp-home al-messages-list.mobile .ui-table-wrapper {\n  width: calc(100% - 8px);\n  padding-left: 9px;\n  overflow-x: hidden;\n  height: calc(100vh - 81px);\n}\n\napp-home .mobile-messages-list {\n  position: relative;\n  top: 8px;\n}\n\napp-home .w100 {\n  width: 100%;\n}\n\napp-home .mobile-messages-list al-message {\n  margin-left: 9px;\n  margin-right: 9px;\n}\n\napp-home .padding-10 {\n  padding-left: 10px;\n  padding-right: 10px;\n}\n\napp-home .ui-toolbar-group-left i {\n  margin-left: 30px;\n  font-size: 30px;\n}\n\napp-home .ui-toolbar-group-left {\n  margin-left: -30px;\n}\n\napp-home [hidden] {\n  display: none !important;\n}\n\napp-home .ui-sidebar {\n  height: 100vh;\n  overflow-y: auto;\n}\n\napp-home .disabled {\n  opacity: 0.2;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xpeGEvcHJvZ3JhbXMvYWZ0ZXJsb2dpYy1jbGllbnQvc3JjL2Fzc2V0cy9zY3NzL2hvbWUuc2NzcyIsInNyYy9hc3NldHMvc2Nzcy9ob21lLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxnQkFBQTtBQ0NGOztBREVFO0VBQ0Usa0JBQUE7RUFFQSxrQkFBQTtFQUNBLE9BQUE7RUFDQSxRQUFBO0VBQ0EsUUFBQTtFQUNBLDJCQUFBO0FDQUo7O0FER0U7RUFDRSxlQUFBO0VBQ0EsaUJBQUE7QUNESjs7QURJRTtFQUNFLGVBQUE7RUFDQSxpQkFBQTtFQUVBLGNBQUE7RUFFQSxTQUFBO0FDSko7O0FET0U7RUFDRSxxQkFBQTtBQ0xKOztBRFFFO0VBQ0UsWUFBQTtFQUNBLGdCQUFBO0FDTko7O0FEU0U7RUFDRSxZQUFBO0FDUEo7O0FEU0k7RUFDRSxpQkFBQTtBQ1BOOztBRFVJO0VBQ0UsV0FBQTtBQ1JOOztBRGFFO0VBQ0UsWUFBQTtBQ1hKOztBRGNFO0VBQ0UsZ0JBQUE7RUFDQSxnQkFBQTtBQ1pKOztBRGVFO0VBQ0UseUJBQUE7QUNiSjs7QURnQkU7RUFDRSxtQkFBQTtFQUNBLGdCQUFBO0FDZEo7O0FEaUJFO0VBQ0Usa0JBQUE7QUNmSjs7QURrQkU7RUFDRSwwQkFBQTtFQUNBLGdCQUFBO0FDaEJKOztBRG1CRTtFQUNFLDBCQUFBO0VBQ0EsZ0JBQUE7QUNqQko7O0FEb0JFO0VBQ0UsdUJBQUE7RUFDQSxpQkFBQTtFQUNBLGtCQUFBO0VBQ0EsMEJBQUE7QUNsQko7O0FEcUJFO0VBQ0Usa0JBQUE7RUFDQSxRQUFBO0FDbkJKOztBRHNCRTtFQUNFLFdBQUE7QUNwQko7O0FEdUJFO0VBQ0UsZ0JBQUE7RUFDQSxpQkFBQTtBQ3JCSjs7QUR3QkU7RUFDRSxrQkFBQTtFQUNBLG1CQUFBO0FDdEJKOztBRHlCRTtFQUNFLGlCQUFBO0VBQ0EsZUFBQTtBQ3ZCSjs7QUQwQkU7RUFDRSxrQkFBQTtBQ3hCSjs7QUQyQkU7RUFDRSx3QkFBQTtBQ3pCSjs7QUQ0QkU7RUFDRSxhQUFBO0VBQ0EsZ0JBQUE7QUMxQko7O0FENkJFO0VBQ0UsWUFBQTtBQzNCSiIsImZpbGUiOiJzcmMvYXNzZXRzL3Njc3MvaG9tZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiYm9keSB7XG4gIG92ZXJmbG93OiBoaWRkZW47XG59XG5hcHAtaG9tZSB7XG4gICNjb250YWluZXIge1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcblxuICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgICBsZWZ0OiAwO1xuICAgIHJpZ2h0OiAwO1xuICAgIHRvcDogNTAlO1xuICAgIHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtNTAlKTtcbiAgfVxuXG4gICNjb250YWluZXIgc3Ryb25nIHtcbiAgICBmb250LXNpemU6IDIwcHg7XG4gICAgbGluZS1oZWlnaHQ6IDI2cHg7XG4gIH1cblxuICAjY29udGFpbmVyIHAge1xuICAgIGZvbnQtc2l6ZTogMTZweDtcbiAgICBsaW5lLWhlaWdodDogMjJweDtcblxuICAgIGNvbG9yOiAjOGM4YzhjO1xuXG4gICAgbWFyZ2luOiAwO1xuICB9XG5cbiAgI2NvbnRhaW5lciBhIHtcbiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7XG4gIH1cblxuICAuZm9sZGVycy1jb2wge1xuICAgIHdpZHRoOiAyMDBweDtcbiAgICBtYXgtd2lkdGg6IDMwMHB4O1xuICB9XG5cbiAgLm1haWxzLWNvbCB7XG4gICAgd2lkdGg6IDQwMHB4O1xuXG4gICAgYnV0dG9uIHtcbiAgICAgIG1hcmdpbi1sZWZ0OiAxMHB4O1xuICAgIH1cblxuICAgIC5sZWZ0IHtcbiAgICAgIGZsb2F0OiBsZWZ0O1xuICAgIH1cblxuICB9XG5cbiAgLnJpZ2h0IHtcbiAgICBmbG9hdDogcmlnaHQ7XG4gIH1cblxuICAubWVudVdpZHRoIHtcbiAgICBtaW4td2lkdGg6IDMwMHB4O1xuICAgIHRleHQtYWxpZ246IGxlZnQ7XG4gIH1cblxuICAubWFpbC1jb2wge1xuICAgIHdpZHRoOiBjYWxjKDEwMCUgLSA2MDBweCk7XG4gIH1cblxuICAudG9wIHRkIHtcbiAgICB2ZXJ0aWNhbC1hbGlnbjogdG9wO1xuICAgIG92ZXJmbG93LXk6IGF1dG87XG4gIH1cblxuICAubWVzc2FnZXMtd3JhcHBlciB7XG4gICAgb3ZlcmZsb3cteTogaGlkZGVuO1xuICB9XG5cbiAgLndyYXBwZXIge1xuICAgIGhlaWdodDogY2FsYygxMDB2aCAtIDQ4cHgpO1xuICAgIG92ZXJmbG93LXk6IGF1dG87XG4gIH1cblxuICBhbC1tZXNzYWdlcy1saXN0IC51aS10YWJsZS13cmFwcGVyIHtcbiAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA5N3B4KTtcbiAgICBvdmVyZmxvdy15OiBhdXRvO1xuICB9XG5cbiAgYWwtbWVzc2FnZXMtbGlzdC5tb2JpbGUgLnVpLXRhYmxlLXdyYXBwZXIge1xuICAgIHdpZHRoOiBjYWxjKDEwMCUgLSA4cHgpO1xuICAgIHBhZGRpbmctbGVmdDogOXB4O1xuICAgIG92ZXJmbG93LXg6IGhpZGRlbjtcbiAgICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA4MXB4KTtcbiAgfVxuXG4gIC5tb2JpbGUtbWVzc2FnZXMtbGlzdCB7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIHRvcDogOHB4O1xuICB9XG5cbiAgLncxMDAge1xuICAgIHdpZHRoOiAxMDAlO1xuICB9XG5cbiAgLm1vYmlsZS1tZXNzYWdlcy1saXN0IGFsLW1lc3NhZ2Uge1xuICAgIG1hcmdpbi1sZWZ0OiA5cHg7XG4gICAgbWFyZ2luLXJpZ2h0OiA5cHg7XG4gIH1cblxuICAucGFkZGluZy0xMCB7XG4gICAgcGFkZGluZy1sZWZ0OiAxMHB4O1xuICAgIHBhZGRpbmctcmlnaHQ6IDEwcHg7XG4gIH1cblxuICAudWktdG9vbGJhci1ncm91cC1sZWZ0IGkge1xuICAgIG1hcmdpbi1sZWZ0OiAzMHB4O1xuICAgIGZvbnQtc2l6ZTogMzBweDtcbiAgfVxuXG4gIC51aS10b29sYmFyLWdyb3VwLWxlZnQge1xuICAgIG1hcmdpbi1sZWZ0OiAtMzBweDtcbiAgfVxuXG4gIFtoaWRkZW5dIHtcbiAgICBkaXNwbGF5OiBub25lICFpbXBvcnRhbnQ7XG4gIH1cblxuICAudWktc2lkZWJhciB7XG4gICAgaGVpZ2h0OiAxMDB2aDtcbiAgICBvdmVyZmxvdy15OiBhdXRvO1xuICB9XG5cbiAgLmRpc2FibGVkIHtcbiAgICBvcGFjaXR5OiAwLjI7XG4gIH1cbn1cbiIsImJvZHkge1xuICBvdmVyZmxvdzogaGlkZGVuO1xufVxuXG5hcHAtaG9tZSAjY29udGFpbmVyIHtcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIGxlZnQ6IDA7XG4gIHJpZ2h0OiAwO1xuICB0b3A6IDUwJTtcbiAgdHJhbnNmb3JtOiB0cmFuc2xhdGVZKC01MCUpO1xufVxuYXBwLWhvbWUgI2NvbnRhaW5lciBzdHJvbmcge1xuICBmb250LXNpemU6IDIwcHg7XG4gIGxpbmUtaGVpZ2h0OiAyNnB4O1xufVxuYXBwLWhvbWUgI2NvbnRhaW5lciBwIHtcbiAgZm9udC1zaXplOiAxNnB4O1xuICBsaW5lLWhlaWdodDogMjJweDtcbiAgY29sb3I6ICM4YzhjOGM7XG4gIG1hcmdpbjogMDtcbn1cbmFwcC1ob21lICNjb250YWluZXIgYSB7XG4gIHRleHQtZGVjb3JhdGlvbjogbm9uZTtcbn1cbmFwcC1ob21lIC5mb2xkZXJzLWNvbCB7XG4gIHdpZHRoOiAyMDBweDtcbiAgbWF4LXdpZHRoOiAzMDBweDtcbn1cbmFwcC1ob21lIC5tYWlscy1jb2wge1xuICB3aWR0aDogNDAwcHg7XG59XG5hcHAtaG9tZSAubWFpbHMtY29sIGJ1dHRvbiB7XG4gIG1hcmdpbi1sZWZ0OiAxMHB4O1xufVxuYXBwLWhvbWUgLm1haWxzLWNvbCAubGVmdCB7XG4gIGZsb2F0OiBsZWZ0O1xufVxuYXBwLWhvbWUgLnJpZ2h0IHtcbiAgZmxvYXQ6IHJpZ2h0O1xufVxuYXBwLWhvbWUgLm1lbnVXaWR0aCB7XG4gIG1pbi13aWR0aDogMzAwcHg7XG4gIHRleHQtYWxpZ246IGxlZnQ7XG59XG5hcHAtaG9tZSAubWFpbC1jb2wge1xuICB3aWR0aDogY2FsYygxMDAlIC0gNjAwcHgpO1xufVxuYXBwLWhvbWUgLnRvcCB0ZCB7XG4gIHZlcnRpY2FsLWFsaWduOiB0b3A7XG4gIG92ZXJmbG93LXk6IGF1dG87XG59XG5hcHAtaG9tZSAubWVzc2FnZXMtd3JhcHBlciB7XG4gIG92ZXJmbG93LXk6IGhpZGRlbjtcbn1cbmFwcC1ob21lIC53cmFwcGVyIHtcbiAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNDhweCk7XG4gIG92ZXJmbG93LXk6IGF1dG87XG59XG5hcHAtaG9tZSBhbC1tZXNzYWdlcy1saXN0IC51aS10YWJsZS13cmFwcGVyIHtcbiAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gOTdweCk7XG4gIG92ZXJmbG93LXk6IGF1dG87XG59XG5hcHAtaG9tZSBhbC1tZXNzYWdlcy1saXN0Lm1vYmlsZSAudWktdGFibGUtd3JhcHBlciB7XG4gIHdpZHRoOiBjYWxjKDEwMCUgLSA4cHgpO1xuICBwYWRkaW5nLWxlZnQ6IDlweDtcbiAgb3ZlcmZsb3cteDogaGlkZGVuO1xuICBoZWlnaHQ6IGNhbGMoMTAwdmggLSA4MXB4KTtcbn1cbmFwcC1ob21lIC5tb2JpbGUtbWVzc2FnZXMtbGlzdCB7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdG9wOiA4cHg7XG59XG5hcHAtaG9tZSAudzEwMCB7XG4gIHdpZHRoOiAxMDAlO1xufVxuYXBwLWhvbWUgLm1vYmlsZS1tZXNzYWdlcy1saXN0IGFsLW1lc3NhZ2Uge1xuICBtYXJnaW4tbGVmdDogOXB4O1xuICBtYXJnaW4tcmlnaHQ6IDlweDtcbn1cbmFwcC1ob21lIC5wYWRkaW5nLTEwIHtcbiAgcGFkZGluZy1sZWZ0OiAxMHB4O1xuICBwYWRkaW5nLXJpZ2h0OiAxMHB4O1xufVxuYXBwLWhvbWUgLnVpLXRvb2xiYXItZ3JvdXAtbGVmdCBpIHtcbiAgbWFyZ2luLWxlZnQ6IDMwcHg7XG4gIGZvbnQtc2l6ZTogMzBweDtcbn1cbmFwcC1ob21lIC51aS10b29sYmFyLWdyb3VwLWxlZnQge1xuICBtYXJnaW4tbGVmdDogLTMwcHg7XG59XG5hcHAtaG9tZSBbaGlkZGVuXSB7XG4gIGRpc3BsYXk6IG5vbmUgIWltcG9ydGFudDtcbn1cbmFwcC1ob21lIC51aS1zaWRlYmFyIHtcbiAgaGVpZ2h0OiAxMDB2aDtcbiAgb3ZlcmZsb3cteTogYXV0bztcbn1cbmFwcC1ob21lIC5kaXNhYmxlZCB7XG4gIG9wYWNpdHk6IDAuMjtcbn0iXX0= */");

/***/ }),

/***/ "./src/assets/scss/main.scss":
/*!***********************************!*\
  !*** ./src/assets/scss/main.scss ***!
  \***********************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = (".container {\n  height: calc(100vh - 53px);\n}\n\nbody {\n  margin: 0px;\n}\n\n.avatar {\n  width: 40px;\n  height: 40px;\n  margin-right: 8px;\n  margin-top: 8px;\n}\n\n.account {\n  width: calc(100% - 48px);\n}\n\n.name {\n  margin-top: 10px;\n  margin-bottom: 0px;\n  font-weight: normal;\n}\n\n.email {\n  margin-top: 0px;\n  margin-bottom: 0px;\n  font-weight: normal;\n}\n\n.selected .email, .selected .name {\n  font-weight: bold !important;\n}\n\n.flex {\n  display: flex;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xpeGEvcHJvZ3JhbXMvYWZ0ZXJsb2dpYy1jbGllbnQvc3JjL2Fzc2V0cy9zY3NzL21haW4uc2NzcyIsInNyYy9hc3NldHMvc2Nzcy9tYWluLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSwwQkFBQTtBQ0NGOztBREVBO0VBQ0UsV0FBQTtBQ0NGOztBREVBO0VBQ0UsV0FBQTtFQUNBLFlBQUE7RUFDQSxpQkFBQTtFQUNBLGVBQUE7QUNDRjs7QURFQTtFQUNFLHdCQUFBO0FDQ0Y7O0FERUE7RUFDRSxnQkFBQTtFQUNBLGtCQUFBO0VBQ0EsbUJBQUE7QUNDRjs7QURFQTtFQUNFLGVBQUE7RUFDQSxrQkFBQTtFQUNBLG1CQUFBO0FDQ0Y7O0FERUE7RUFDRSw0QkFBQTtBQ0NGOztBREVBO0VBQ0UsYUFBQTtBQ0NGIiwiZmlsZSI6InNyYy9hc3NldHMvc2Nzcy9tYWluLnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyIuY29udGFpbmVyIHtcbiAgaGVpZ2h0OiBjYWxjKDEwMHZoIC0gNTNweCk7XG59XG5cbmJvZHkge1xuICBtYXJnaW46IDBweDtcbn1cblxuLmF2YXRhciB7XG4gIHdpZHRoOiA0MHB4O1xuICBoZWlnaHQ6IDQwcHg7XG4gIG1hcmdpbi1yaWdodDogOHB4O1xuICBtYXJnaW4tdG9wOiA4cHg7XG59XG5cbi5hY2NvdW50IHtcbiAgd2lkdGg6IGNhbGMoMTAwJSAtIDQ4cHgpO1xufVxuXG4ubmFtZSB7XG4gIG1hcmdpbi10b3A6IDEwcHg7XG4gIG1hcmdpbi1ib3R0b206IDBweDtcbiAgZm9udC13ZWlnaHQ6IG5vcm1hbDtcbn1cblxuLmVtYWlsIHtcbiAgbWFyZ2luLXRvcDogMHB4O1xuICBtYXJnaW4tYm90dG9tOiAwcHg7XG4gIGZvbnQtd2VpZ2h0OiBub3JtYWw7XG59XG5cbi5zZWxlY3RlZCAuZW1haWwsIC5zZWxlY3RlZCAubmFtZXtcbiAgZm9udC13ZWlnaHQ6IGJvbGQgIWltcG9ydGFudDtcbn1cblxuLmZsZXgge1xuICBkaXNwbGF5OiBmbGV4O1xufVxuIiwiLmNvbnRhaW5lciB7XG4gIGhlaWdodDogY2FsYygxMDB2aCAtIDUzcHgpO1xufVxuXG5ib2R5IHtcbiAgbWFyZ2luOiAwcHg7XG59XG5cbi5hdmF0YXIge1xuICB3aWR0aDogNDBweDtcbiAgaGVpZ2h0OiA0MHB4O1xuICBtYXJnaW4tcmlnaHQ6IDhweDtcbiAgbWFyZ2luLXRvcDogOHB4O1xufVxuXG4uYWNjb3VudCB7XG4gIHdpZHRoOiBjYWxjKDEwMCUgLSA0OHB4KTtcbn1cblxuLm5hbWUge1xuICBtYXJnaW4tdG9wOiAxMHB4O1xuICBtYXJnaW4tYm90dG9tOiAwcHg7XG4gIGZvbnQtd2VpZ2h0OiBub3JtYWw7XG59XG5cbi5lbWFpbCB7XG4gIG1hcmdpbi10b3A6IDBweDtcbiAgbWFyZ2luLWJvdHRvbTogMHB4O1xuICBmb250LXdlaWdodDogbm9ybWFsO1xufVxuXG4uc2VsZWN0ZWQgLmVtYWlsLCAuc2VsZWN0ZWQgLm5hbWUge1xuICBmb250LXdlaWdodDogYm9sZCAhaW1wb3J0YW50O1xufVxuXG4uZmxleCB7XG4gIGRpc3BsYXk6IGZsZXg7XG59Il19 */");

/***/ }),

/***/ "./src/assets/scss/message.scss":
/*!**************************************!*\
  !*** ./src/assets/scss/message.scss ***!
  \**************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("al-message {\n  /*.ui-overlaypanel {\n    top: 150px !important;\n    left: 370px !important;\n  }*/\n}\nal-message .center {\n  text-align: center;\n}\nal-message .from {\n  display: flex;\n  align-items: center;\n}\nal-message .margin {\n  margin-left: 10px;\n}\nal-message .buttons {\n  text-align: right;\n}\nal-message .buttons button {\n  margin-left: 4px;\n}\nal-message .avatar {\n  max-width: 56px;\n  margin: 8px;\n}\nal-message .details {\n  flex: 1;\n  margin-top: 11px;\n}\nal-message .actions {\n  max-width: 102px;\n  margin-top: 11px;\n}\nal-message .actions .fa {\n  font-size: 30px;\n  margin-left: 20px;\n}\nal-message .p-col-1 {\n  align-items: center;\n  display: flex;\n  justify-content: flex-end;\n}\nal-message .extra {\n  color: blue;\n}\nal-message .extra-details {\n  font-size: 0.8em;\n}\nal-message .contact-detail {\n  margin-right: 5px;\n}\nal-message .menu-options i {\n  margin-right: 10px;\n}\nal-message .max-width {\n  max-width: 150px;\n}\nal-message .message-body {\n  overflow-x: overlay;\n}\nal-message .hide-quote blockquote {\n  display: none;\n}\nal-message .main-container {\n  padding-left: 15px;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xpeGEvcHJvZ3JhbXMvYWZ0ZXJsb2dpYy1jbGllbnQvc3JjL2Fzc2V0cy9zY3NzL21lc3NhZ2Uuc2NzcyIsInNyYy9hc3NldHMvc2Nzcy9tZXNzYWdlLnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUEwRUU7OztJQUFBO0FDckVGO0FESkU7RUFDRSxrQkFBQTtBQ01KO0FESEU7RUFDRSxhQUFBO0VBQ0EsbUJBQUE7QUNLSjtBREZFO0VBQ0UsaUJBQUE7QUNJSjtBRERFO0VBSUUsaUJBQUE7QUNBSjtBREhJO0VBQ0UsZ0JBQUE7QUNLTjtBREFFO0VBQ0UsZUFBQTtFQUNBLFdBQUE7QUNFSjtBRENFO0VBQ0UsT0FBQTtFQUNBLGdCQUFBO0FDQ0o7QURFRTtFQUNFLGdCQUFBO0VBQ0EsZ0JBQUE7QUNBSjtBRENJO0VBQ0UsZUFBQTtFQUNBLGlCQUFBO0FDQ047QURHRTtFQUNFLG1CQUFBO0VBQ0EsYUFBQTtFQUNBLHlCQUFBO0FDREo7QURJRTtFQUNFLFdBQUE7QUNGSjtBREtFO0VBQ0UsZ0JBQUE7QUNISjtBRE1FO0VBQ0UsaUJBQUE7QUNKSjtBRE9FO0VBQ0Usa0JBQUE7QUNMSjtBRFFFO0VBQ0UsZ0JBQUE7QUNOSjtBRFNFO0VBQ0UsbUJBQUE7QUNQSjtBRFVFO0VBQ0UsYUFBQTtBQ1JKO0FEZ0JFO0VBQ0Usa0JBQUE7QUNkSiIsImZpbGUiOiJzcmMvYXNzZXRzL3Njc3MvbWVzc2FnZS5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiYWwtbWVzc2FnZSB7XG4gIC5jZW50ZXIge1xuICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgfVxuXG4gIC5mcm9tIHtcbiAgICBkaXNwbGF5OiBmbGV4O1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIH1cblxuICAubWFyZ2luIHtcbiAgICBtYXJnaW4tbGVmdDogMTBweDtcbiAgfVxuXG4gIC5idXR0b25zIHtcbiAgICBidXR0b24ge1xuICAgICAgbWFyZ2luLWxlZnQ6IDRweDtcbiAgICB9XG4gICAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gIH1cblxuICAuYXZhdGFyIHtcbiAgICBtYXgtd2lkdGg6IDU2cHg7XG4gICAgbWFyZ2luOiA4cHg7XG4gIH1cblxuICAuZGV0YWlscyB7XG4gICAgZmxleDogMTtcbiAgICBtYXJnaW4tdG9wOiAxMXB4O1xuICB9XG5cbiAgLmFjdGlvbnMge1xuICAgIG1heC13aWR0aDogMTAycHg7XG4gICAgbWFyZ2luLXRvcDogMTFweDtcbiAgICAuZmEge1xuICAgICAgZm9udC1zaXplOiAzMHB4O1xuICAgICAgbWFyZ2luLWxlZnQ6IDIwcHg7XG4gICAgfVxuICB9XG5cbiAgLnAtY29sLTEge1xuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gICAgZGlzcGxheTogZmxleDtcbiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xuICB9XG5cbiAgLmV4dHJhIHtcbiAgICBjb2xvcjogYmx1ZTtcbiAgfVxuXG4gIC5leHRyYS1kZXRhaWxzIHtcbiAgICBmb250LXNpemU6IDAuOGVtO1xuICB9XG5cbiAgLmNvbnRhY3QtZGV0YWlsIHtcbiAgICBtYXJnaW4tcmlnaHQ6IDVweDtcbiAgfVxuICBcbiAgLm1lbnUtb3B0aW9ucyBpe1xuICAgIG1hcmdpbi1yaWdodDogMTBweDtcbiAgfVxuXG4gIC5tYXgtd2lkdGgge1xuICAgIG1heC13aWR0aDogMTUwcHg7XG4gIH1cblxuICAubWVzc2FnZS1ib2R5IHtcbiAgICBvdmVyZmxvdy14OiBvdmVybGF5O1xuICB9XG5cbiAgLmhpZGUtcXVvdGUgYmxvY2txdW90ZSB7XG4gICAgZGlzcGxheTogbm9uZTtcbiAgfVxuXG4gIC8qLnVpLW92ZXJsYXlwYW5lbCB7XG4gICAgdG9wOiAxNTBweCAhaW1wb3J0YW50O1xuICAgIGxlZnQ6IDM3MHB4ICFpbXBvcnRhbnQ7XG4gIH0qL1xuXG4gIC5tYWluLWNvbnRhaW5lciB7XG4gICAgcGFkZGluZy1sZWZ0OiAxNXB4O1xuICB9XG59XG4iLCJhbC1tZXNzYWdlIHtcbiAgLyoudWktb3ZlcmxheXBhbmVsIHtcbiAgICB0b3A6IDE1MHB4ICFpbXBvcnRhbnQ7XG4gICAgbGVmdDogMzcwcHggIWltcG9ydGFudDtcbiAgfSovXG59XG5hbC1tZXNzYWdlIC5jZW50ZXIge1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG59XG5hbC1tZXNzYWdlIC5mcm9tIHtcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbn1cbmFsLW1lc3NhZ2UgLm1hcmdpbiB7XG4gIG1hcmdpbi1sZWZ0OiAxMHB4O1xufVxuYWwtbWVzc2FnZSAuYnV0dG9ucyB7XG4gIHRleHQtYWxpZ246IHJpZ2h0O1xufVxuYWwtbWVzc2FnZSAuYnV0dG9ucyBidXR0b24ge1xuICBtYXJnaW4tbGVmdDogNHB4O1xufVxuYWwtbWVzc2FnZSAuYXZhdGFyIHtcbiAgbWF4LXdpZHRoOiA1NnB4O1xuICBtYXJnaW46IDhweDtcbn1cbmFsLW1lc3NhZ2UgLmRldGFpbHMge1xuICBmbGV4OiAxO1xuICBtYXJnaW4tdG9wOiAxMXB4O1xufVxuYWwtbWVzc2FnZSAuYWN0aW9ucyB7XG4gIG1heC13aWR0aDogMTAycHg7XG4gIG1hcmdpbi10b3A6IDExcHg7XG59XG5hbC1tZXNzYWdlIC5hY3Rpb25zIC5mYSB7XG4gIGZvbnQtc2l6ZTogMzBweDtcbiAgbWFyZ2luLWxlZnQ6IDIwcHg7XG59XG5hbC1tZXNzYWdlIC5wLWNvbC0xIHtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgZGlzcGxheTogZmxleDtcbiAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcbn1cbmFsLW1lc3NhZ2UgLmV4dHJhIHtcbiAgY29sb3I6IGJsdWU7XG59XG5hbC1tZXNzYWdlIC5leHRyYS1kZXRhaWxzIHtcbiAgZm9udC1zaXplOiAwLjhlbTtcbn1cbmFsLW1lc3NhZ2UgLmNvbnRhY3QtZGV0YWlsIHtcbiAgbWFyZ2luLXJpZ2h0OiA1cHg7XG59XG5hbC1tZXNzYWdlIC5tZW51LW9wdGlvbnMgaSB7XG4gIG1hcmdpbi1yaWdodDogMTBweDtcbn1cbmFsLW1lc3NhZ2UgLm1heC13aWR0aCB7XG4gIG1heC13aWR0aDogMTUwcHg7XG59XG5hbC1tZXNzYWdlIC5tZXNzYWdlLWJvZHkge1xuICBvdmVyZmxvdy14OiBvdmVybGF5O1xufVxuYWwtbWVzc2FnZSAuaGlkZS1xdW90ZSBibG9ja3F1b3RlIHtcbiAgZGlzcGxheTogbm9uZTtcbn1cbmFsLW1lc3NhZ2UgLm1haW4tY29udGFpbmVyIHtcbiAgcGFkZGluZy1sZWZ0OiAxNXB4O1xufSJdfQ== */");

/***/ }),

/***/ "./src/assets/scss/messages-list.scss":
/*!********************************************!*\
  !*** ./src/assets/scss/messages-list.scss ***!
  \********************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("al-messages-list .header {\n  margin-top: 0px;\n}\nal-messages-list .from, al-messages-list .subject {\n  flex-grow: 1;\n  max-width: 100%;\n  overflow: hidden;\n  white-space: nowrap;\n}\nal-messages-list .subject {\n  font-size: 18px;\n}\nal-messages-list .margin-top {\n  margin-top: 0px;\n}\nal-messages-list .date {\n  justify-content: right;\n}\nal-messages-list .flags {\n  justify-content: right;\n  margin-right: 4px;\n}\nal-messages-list .fa-star {\n  font-size: 0.9em;\n  padding-right: 5px;\n}\nal-messages-list .unread {\n  font-weight: bold;\n}\nal-messages-list .ui-inputgroup {\n  position: relative;\n}\nal-messages-list .ui-inputgroup .fa-times {\n  position: absolute;\n  right: 38px;\n  top: 9px;\n}\nal-messages-list .right {\n  text-align: right;\n}\nal-messages-list .avatar {\n  width: 40px;\n  height: 40px;\n  margin-right: 8px;\n  margin-top: 8px;\n}\nal-messages-list .message {\n  width: calc(100% - 48px);\n  margin-top: 8px;\n}\nal-messages-list .flex {\n  display: flex;\n}\nal-messages-list td {\n  overflow: hidden;\n}\nal-messages-list .ui-overlaypanel {\n  max-width: 400px;\n}\nal-messages-list .fix-search-form .ui-overlaypanel {\n  top: 50px !important;\n  left: 107px !important;\n}\nal-messages-list .ui-datepicker {\n  min-width: 300px !important;\n}\nal-messages-list .combined-view .ui-paginator-first, al-messages-list .combined-view .ui-paginator-last {\n  display: none;\n}\nal-messages-list td.highlight {\n  border-right: 5px solid !important;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xpeGEvcHJvZ3JhbXMvYWZ0ZXJsb2dpYy1jbGllbnQvc3JjL2Fzc2V0cy9zY3NzL21lc3NhZ2VzLWxpc3Quc2NzcyIsInNyYy9hc3NldHMvc2Nzcy9tZXNzYWdlcy1saXN0LnNjc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0U7RUFDRSxlQUFBO0FDQUo7QURHRTtFQUNFLFlBQUE7RUFDQSxlQUFBO0VBQ0EsZ0JBQUE7RUFDQSxtQkFBQTtBQ0RKO0FESUU7RUFDRSxlQUFBO0FDRko7QURLRTtFQUNFLGVBQUE7QUNISjtBRE1FO0VBQ0Usc0JBQUE7QUNKSjtBRE9FO0VBQ0Usc0JBQUE7RUFFQSxpQkFBQTtBQ05KO0FEU0U7RUFDRSxnQkFBQTtFQUNBLGtCQUFBO0FDUEo7QURVRTtFQUNFLGlCQUFBO0FDUko7QURXRTtFQUNFLGtCQUFBO0FDVEo7QURVSTtFQUNFLGtCQUFBO0VBQ0EsV0FBQTtFQUNBLFFBQUE7QUNSTjtBRFlFO0VBQ0UsaUJBQUE7QUNWSjtBRGFFO0VBQ0UsV0FBQTtFQUNBLFlBQUE7RUFDQSxpQkFBQTtFQUNBLGVBQUE7QUNYSjtBRGNFO0VBQ0Usd0JBQUE7RUFDQSxlQUFBO0FDWko7QURlRTtFQUNFLGFBQUE7QUNiSjtBRGdCRTtFQUNFLGdCQUFBO0FDZEo7QURpQkU7RUFDRSxnQkFBQTtBQ2ZKO0FEa0JFO0VBQ0Usb0JBQUE7RUFDQSxzQkFBQTtBQ2hCSjtBRG1CRTtFQUNFLDJCQUFBO0FDakJKO0FEcUJJO0VBQ0UsYUFBQTtBQ25CTjtBRHVCRTtFQUNFLGtDQUFBO0FDckJKIiwiZmlsZSI6InNyYy9hc3NldHMvc2Nzcy9tZXNzYWdlcy1saXN0LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyJhbC1tZXNzYWdlcy1saXN0IHtcbiAgLmhlYWRlciB7XG4gICAgbWFyZ2luLXRvcDogMHB4O1xuICB9XG5cbiAgLmZyb20sIC5zdWJqZWN0IHtcbiAgICBmbGV4LWdyb3c6IDE7XG4gICAgbWF4LXdpZHRoOiAxMDAlO1xuICAgIG92ZXJmbG93OiBoaWRkZW47XG4gICAgd2hpdGUtc3BhY2U6IG5vd3JhcDtcbiAgfVxuXG4gIC5zdWJqZWN0IHtcbiAgICBmb250LXNpemU6IDE4cHg7XG4gIH1cblxuICAubWFyZ2luLXRvcCB7XG4gICAgbWFyZ2luLXRvcDogMHB4O1xuICB9XG5cbiAgLmRhdGUge1xuICAgIGp1c3RpZnktY29udGVudDogcmlnaHQ7XG4gIH1cblxuICAuZmxhZ3Mge1xuICAgIGp1c3RpZnktY29udGVudDogcmlnaHQ7XG4gICAgLy8gbWFyZ2luLXRvcDogNHB4O1xuICAgIG1hcmdpbi1yaWdodDogNHB4O1xuICB9XG5cbiAgLmZhLXN0YXIge1xuICAgIGZvbnQtc2l6ZTogMC45ZW07XG4gICAgcGFkZGluZy1yaWdodDogNXB4O1xuICB9XG5cbiAgLnVucmVhZCB7XG4gICAgZm9udC13ZWlnaHQ6IGJvbGQ7XG4gIH1cblxuICAudWktaW5wdXRncm91cCB7XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIC5mYS10aW1lcyB7XG4gICAgICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gICAgICByaWdodDogMzhweDtcbiAgICAgIHRvcDogOXB4O1xuICAgIH1cbiAgfVxuXG4gIC5yaWdodCB7XG4gICAgdGV4dC1hbGlnbjogcmlnaHQ7XG4gIH1cblxuICAuYXZhdGFyIHtcbiAgICB3aWR0aDogNDBweDtcbiAgICBoZWlnaHQ6IDQwcHg7XG4gICAgbWFyZ2luLXJpZ2h0OiA4cHg7XG4gICAgbWFyZ2luLXRvcDogOHB4O1xuICB9XG5cbiAgLm1lc3NhZ2Uge1xuICAgIHdpZHRoOiBjYWxjKDEwMCUgLSA0OHB4KTtcbiAgICBtYXJnaW4tdG9wOiA4cHg7XG4gIH1cblxuICAuZmxleCB7XG4gICAgZGlzcGxheTogZmxleDtcbiAgfVxuXG4gIHRkIHtcbiAgICBvdmVyZmxvdzogaGlkZGVuO1xuICB9XG5cbiAgLnVpLW92ZXJsYXlwYW5lbCB7XG4gICAgbWF4LXdpZHRoOiA0MDBweDtcbiAgfVxuXG4gIC5maXgtc2VhcmNoLWZvcm0gLnVpLW92ZXJsYXlwYW5lbCB7XG4gICAgdG9wOiA1MHB4ICFpbXBvcnRhbnQ7XG4gICAgbGVmdDogMTA3cHggIWltcG9ydGFudDtcbiAgfVxuXG4gIC51aS1kYXRlcGlja2VyIHtcbiAgICBtaW4td2lkdGg6IDMwMHB4ICFpbXBvcnRhbnQ7XG4gIH1cblxuICAuY29tYmluZWQtdmlldyB7XG4gICAgLnVpLXBhZ2luYXRvci1maXJzdCwgLnVpLXBhZ2luYXRvci1sYXN0IHtcbiAgICAgIGRpc3BsYXk6IG5vbmU7XG4gICAgfVxuICB9XG5cbiAgdGQuaGlnaGxpZ2h0IHtcbiAgICBib3JkZXItcmlnaHQ6IDVweCBzb2xpZCAhaW1wb3J0YW50O1xuICB9XG59XG4iLCJhbC1tZXNzYWdlcy1saXN0IC5oZWFkZXIge1xuICBtYXJnaW4tdG9wOiAwcHg7XG59XG5hbC1tZXNzYWdlcy1saXN0IC5mcm9tLCBhbC1tZXNzYWdlcy1saXN0IC5zdWJqZWN0IHtcbiAgZmxleC1ncm93OiAxO1xuICBtYXgtd2lkdGg6IDEwMCU7XG4gIG92ZXJmbG93OiBoaWRkZW47XG4gIHdoaXRlLXNwYWNlOiBub3dyYXA7XG59XG5hbC1tZXNzYWdlcy1saXN0IC5zdWJqZWN0IHtcbiAgZm9udC1zaXplOiAxOHB4O1xufVxuYWwtbWVzc2FnZXMtbGlzdCAubWFyZ2luLXRvcCB7XG4gIG1hcmdpbi10b3A6IDBweDtcbn1cbmFsLW1lc3NhZ2VzLWxpc3QgLmRhdGUge1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHJpZ2h0O1xufVxuYWwtbWVzc2FnZXMtbGlzdCAuZmxhZ3Mge1xuICBqdXN0aWZ5LWNvbnRlbnQ6IHJpZ2h0O1xuICBtYXJnaW4tcmlnaHQ6IDRweDtcbn1cbmFsLW1lc3NhZ2VzLWxpc3QgLmZhLXN0YXIge1xuICBmb250LXNpemU6IDAuOWVtO1xuICBwYWRkaW5nLXJpZ2h0OiA1cHg7XG59XG5hbC1tZXNzYWdlcy1saXN0IC51bnJlYWQge1xuICBmb250LXdlaWdodDogYm9sZDtcbn1cbmFsLW1lc3NhZ2VzLWxpc3QgLnVpLWlucHV0Z3JvdXAge1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG59XG5hbC1tZXNzYWdlcy1saXN0IC51aS1pbnB1dGdyb3VwIC5mYS10aW1lcyB7XG4gIHBvc2l0aW9uOiBhYnNvbHV0ZTtcbiAgcmlnaHQ6IDM4cHg7XG4gIHRvcDogOXB4O1xufVxuYWwtbWVzc2FnZXMtbGlzdCAucmlnaHQge1xuICB0ZXh0LWFsaWduOiByaWdodDtcbn1cbmFsLW1lc3NhZ2VzLWxpc3QgLmF2YXRhciB7XG4gIHdpZHRoOiA0MHB4O1xuICBoZWlnaHQ6IDQwcHg7XG4gIG1hcmdpbi1yaWdodDogOHB4O1xuICBtYXJnaW4tdG9wOiA4cHg7XG59XG5hbC1tZXNzYWdlcy1saXN0IC5tZXNzYWdlIHtcbiAgd2lkdGg6IGNhbGMoMTAwJSAtIDQ4cHgpO1xuICBtYXJnaW4tdG9wOiA4cHg7XG59XG5hbC1tZXNzYWdlcy1saXN0IC5mbGV4IHtcbiAgZGlzcGxheTogZmxleDtcbn1cbmFsLW1lc3NhZ2VzLWxpc3QgdGQge1xuICBvdmVyZmxvdzogaGlkZGVuO1xufVxuYWwtbWVzc2FnZXMtbGlzdCAudWktb3ZlcmxheXBhbmVsIHtcbiAgbWF4LXdpZHRoOiA0MDBweDtcbn1cbmFsLW1lc3NhZ2VzLWxpc3QgLmZpeC1zZWFyY2gtZm9ybSAudWktb3ZlcmxheXBhbmVsIHtcbiAgdG9wOiA1MHB4ICFpbXBvcnRhbnQ7XG4gIGxlZnQ6IDEwN3B4ICFpbXBvcnRhbnQ7XG59XG5hbC1tZXNzYWdlcy1saXN0IC51aS1kYXRlcGlja2VyIHtcbiAgbWluLXdpZHRoOiAzMDBweCAhaW1wb3J0YW50O1xufVxuYWwtbWVzc2FnZXMtbGlzdCAuY29tYmluZWQtdmlldyAudWktcGFnaW5hdG9yLWZpcnN0LCBhbC1tZXNzYWdlcy1saXN0IC5jb21iaW5lZC12aWV3IC51aS1wYWdpbmF0b3ItbGFzdCB7XG4gIGRpc3BsYXk6IG5vbmU7XG59XG5hbC1tZXNzYWdlcy1saXN0IHRkLmhpZ2hsaWdodCB7XG4gIGJvcmRlci1yaWdodDogNXB4IHNvbGlkICFpbXBvcnRhbnQ7XG59Il19 */");

/***/ }),

/***/ "./src/assets/scss/settings.scss":
/*!***************************************!*\
  !*** ./src/assets/scss/settings.scss ***!
  \***************************************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony default export */ __webpack_exports__["default"] = ("al-settings .flex {\n  display: flex;\n  align-items: center;\n}\nal-settings .flex button {\n  margin-left: 5px;\n}\nal-settings .flex:not(:last-child) {\n  margin-bottom: 20px;\n}\nal-settings .ui-float-label {\n  width: 100%;\n}\nal-settings .ui-panel {\n  margin-bottom: 15px;\n}\nal-settings .right {\n  margin-left: 5px;\n}\nal-settings p-message {\n  width: 153px;\n}\nal-settings .invalid {\n  border: 1px solid red;\n}\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9ob21lL2xpeGEvcHJvZ3JhbXMvYWZ0ZXJsb2dpYy1jbGllbnQvc3JjL2Fzc2V0cy9zY3NzL3NldHRpbmdzLnNjc3MiLCJzcmMvYXNzZXRzL3Njc3Mvc2V0dGluZ3Muc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDRTtFQUNFLGFBQUE7RUFDQSxtQkFBQTtBQ0FKO0FERUk7RUFDRSxnQkFBQTtBQ0FOO0FER0U7RUFDRSxtQkFBQTtBQ0RKO0FESUU7RUFDRSxXQUFBO0FDRko7QURLRTtFQUNFLG1CQUFBO0FDSEo7QURNRTtFQUNFLGdCQUFBO0FDSko7QURPRTtFQUNFLFlBQUE7QUNMSjtBRFFFO0VBQ0UscUJBQUE7QUNOSiIsImZpbGUiOiJzcmMvYXNzZXRzL3Njc3Mvc2V0dGluZ3Muc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImFsLXNldHRpbmdzIHtcbiAgLmZsZXgge1xuICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcblxuICAgIGJ1dHRvbiB7XG4gICAgICBtYXJnaW4tbGVmdDogNXB4O1xuICAgIH1cbiAgfVxuICAuZmxleDpub3QoOmxhc3QtY2hpbGQpIHtcbiAgICBtYXJnaW4tYm90dG9tOiAyMHB4O1xuICB9XG5cbiAgLnVpLWZsb2F0LWxhYmVsIHtcbiAgICB3aWR0aDogMTAwJTtcbiAgfVxuXG4gIC51aS1wYW5lbCB7XG4gICAgbWFyZ2luLWJvdHRvbTogMTVweDtcbiAgfVxuICBcbiAgLnJpZ2h0IHtcbiAgICBtYXJnaW4tbGVmdDogNXB4O1xuICB9XG5cbiAgcC1tZXNzYWdlIHtcbiAgICB3aWR0aDogMTUzcHg7XG4gIH1cblxuICAuaW52YWxpZCB7XG4gICAgYm9yZGVyOiAxcHggc29saWQgcmVkO1xuICB9XG59XG4iLCJhbC1zZXR0aW5ncyAuZmxleCB7XG4gIGRpc3BsYXk6IGZsZXg7XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG59XG5hbC1zZXR0aW5ncyAuZmxleCBidXR0b24ge1xuICBtYXJnaW4tbGVmdDogNXB4O1xufVxuYWwtc2V0dGluZ3MgLmZsZXg6bm90KDpsYXN0LWNoaWxkKSB7XG4gIG1hcmdpbi1ib3R0b206IDIwcHg7XG59XG5hbC1zZXR0aW5ncyAudWktZmxvYXQtbGFiZWwge1xuICB3aWR0aDogMTAwJTtcbn1cbmFsLXNldHRpbmdzIC51aS1wYW5lbCB7XG4gIG1hcmdpbi1ib3R0b206IDE1cHg7XG59XG5hbC1zZXR0aW5ncyAucmlnaHQge1xuICBtYXJnaW4tbGVmdDogNXB4O1xufVxuYWwtc2V0dGluZ3MgcC1tZXNzYWdlIHtcbiAgd2lkdGg6IDE1M3B4O1xufVxuYWwtc2V0dGluZ3MgLmludmFsaWQge1xuICBib3JkZXI6IDFweCBzb2xpZCByZWQ7XG59Il19 */");

/***/ }),

/***/ "./src/environments/environment.ts":
/*!*****************************************!*\
  !*** ./src/environments/environment.ts ***!
  \*****************************************/
/*! exports provided: environment */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "environment", function() { return environment; });
/* harmony import */ var _ts_models__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ts/models */ "./src/ts/models.ts");
// This file can be replaced during build by using the `fileReplacements` array.
// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.
// The list of file replacements can be found in `angular.json`.

const environment = {
    production: false,
    logLevel: _ts_models__WEBPACK_IMPORTED_MODULE_0__["LogLevel"].DEBUG,
    logStack: false,
};
/*
 * For easier debugging in development mode, you can import the following file
 * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.
 *
 * This import should be commented out in production mode because it will have a negative impact
 * on performance if an error is thrown.
 */
// import 'zone.js/dist/zone-error';  // Included with Angular CLI.


/***/ }),

/***/ "./src/main.ts":
/*!*********************!*\
  !*** ./src/main.ts ***!
  \*********************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _angular_platform_browser_dynamic__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/platform-browser-dynamic */ "./node_modules/@angular/platform-browser-dynamic/__ivy_ngcc__/fesm2015/platform-browser-dynamic.js");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./environments/environment */ "./src/environments/environment.ts");
/* harmony import */ var _ts_modules_main__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ts/modules/main */ "./src/ts/modules/main.ts");




if (_environments_environment__WEBPACK_IMPORTED_MODULE_2__["environment"].production) {
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_0__["enableProdMode"])();
}
Object(_angular_platform_browser_dynamic__WEBPACK_IMPORTED_MODULE_1__["platformBrowserDynamic"])().bootstrapModule(_ts_modules_main__WEBPACK_IMPORTED_MODULE_3__["Main"])
    .catch(err => console.log(err));


/***/ }),

/***/ "./src/ts/base.ts":
/*!************************!*\
  !*** ./src/ts/base.ts ***!
  \************************/
/*! exports provided: Statics, BaseClass, BaseComponent, BaseTestUnit */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Statics", function() { return Statics; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseClass", function() { return BaseClass; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseComponent", function() { return BaseComponent; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BaseTestUnit", function() { return BaseTestUnit; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _angular_core_testing__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core/testing */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/testing.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _services_logging__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./services/logging */ "./src/ts/services/logging.ts");
/* harmony import */ var _components_loading__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./components/loading */ "./src/ts/components/loading.ts");
/* harmony import */ var primeng_api__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! primeng/api */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-api.js");
/* harmony import */ var primeng_blockui__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! primeng/blockui */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-blockui.js");









class BlockableComponent {
    getBlockableElement() {
        return this.el;
    }
}
primeng_blockui__WEBPACK_IMPORTED_MODULE_8__["BlockUI"].prototype.block = function () {
    if (this.target) {
        const el = this.target.getBlockableElement ? this.target.getBlockableElement() : this.target;
        el.appendChild(this.mask.nativeElement);
        let style = this.target.style || {};
        style.position = 'relative';
        this.target.style = style;
    }
    else {
        document.body.appendChild(this.mask.nativeElement);
    }
    if (this.autoZIndex) {
        this.mask.nativeElement.style.zIndex = String(this.baseZIndex + (10000));
    }
};
class Statics {
}
class BaseClassWithDecorations {
    static UUID() {
        return 'xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
            var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    }
    __resolveDecorations__(protoName, component, callback) {
        if (component.name == '') {
            return;
        }
        const values = _decorators__WEBPACK_IMPORTED_MODULE_4__["METADATA"].get(component) || new Map();
        if (Array.isArray(values.get(protoName))) {
            values.get(protoName).forEach(callback.bind(this));
        }
        this.__resolveDecorations__(protoName, component.__proto__, callback);
    }
    __resolveInjectors__() {
        this.__resolveDecorations__('__injectors__', this.constructor, (obj) => this[obj['prop']] = Statics.injector.get(obj['arg']));
    }
}
class BaseClass extends BaseClassWithDecorations {
    constructor() {
        super();
        this._logger = _services_logging__WEBPACK_IMPORTED_MODULE_5__["LoggingInstance"].logger;
        this.__resolveInjectors__();
    }
}
class BaseComponent extends BaseClass {
    constructor() {
        super();
        this.__cycles__ = new Map();
        this.__subscriptions__ = [];
        this.__loadingComponent__ = null;
        this._isValid = true;
        this.__resolveDecorations__('__cycles__', this.constructor, (obj) => {
            if (!this.__cycles__.get(obj['arg'])) {
                this.__cycles__.set(obj['arg'], []);
            }
            this.__cycles__.get(obj['arg']).push(obj['prop']);
        });
    }
    get view() {
        return this;
    }
    _runCycle(cycle, args) {
        const cycles = [].concat(this.__cycles__.get(cycle) || []);
        cycles.reverse().forEach(method => this[method](args));
    }
    ngOnDestroy() {
        this._runCycle('destroy');
        this.__subscriptions__.forEach(s => s.unsubscribe());
    }
    ngAfterViewInit() {
        this._runCycle('afterViewInit');
    }
    ngOnChanges(changes) {
        this._runCycle('change', changes);
    }
    _handleError(err) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this.hideLoading();
            console.error(err);
            this.alert(err.message || err['error'] || err.name || err.constructor.name, '');
        });
    }
    ngOnInit() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._runCycle('init');
        });
    }
    softRefresh() {
        this.ngOnDestroy();
        this.ngOnInit();
    }
    connect(obs, callback) {
        this.__subscriptions__.push(obs.subscribe(callback));
    }
    navigate(url) {
        return this._router.navigateByUrl(url);
    }
    showLoading(el) {
        this.__loadingComponent__ = this.__factoryResolver__.resolveComponentFactory(_components_loading__WEBPACK_IMPORTED_MODULE_6__["Loading"]).create(Statics.injector);
        if (!el && document.querySelectorAll('al-loading').length > 0) {
            return;
        }
        if (el) {
            const component = new BlockableComponent();
            component.el = el.nativeElement;
            this.__loadingComponent__.instance.target = component;
        }
        this.__loadingComponent__.instance.uuid = BaseComponent.UUID();
        this.__loadingComponent__.instance.initMe();
        this.__appRef__.attachView(this.__loadingComponent__.hostView);
        const node = this.__loadingComponent__.hostView.rootNodes[0];
        document.body.appendChild(node);
    }
    hideLoading() {
        if (!this.__loadingComponent__) {
            return;
        }
        this.__appRef__.detachView(this.__loadingComponent__.hostView);
        const el = document.querySelectorAll('al-loading');
        el.forEach(e => document.body.removeChild(e));
        this.__loadingComponent__ = null;
    }
    get isJobPage() {
        return this._router.url.match(/job$/) ? true : false;
    }
    alert(title, message, severity = 'success') {
        this._toast.add({ severity: severity, summary: title, detail: message, key: 'abc' });
    }
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_4__["NgInject"])(_angular_router__WEBPACK_IMPORTED_MODULE_3__["Router"])
], BaseComponent.prototype, "_router", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_4__["NgInject"])(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ComponentFactoryResolver"])
], BaseComponent.prototype, "__factoryResolver__", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_4__["NgInject"])(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ApplicationRef"])
], BaseComponent.prototype, "__appRef__", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_4__["NgInject"])(primeng_api__WEBPACK_IMPORTED_MODULE_7__["MessageService"])
], BaseComponent.prototype, "_toast", void 0);
class BaseTestUnit extends BaseClassWithDecorations {
    constructor(_providers) {
        super();
        this._providers = _providers;
        this.initialized = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
    }
    __init__() {
        _angular_core_testing__WEBPACK_IMPORTED_MODULE_2__["TestBed"].resetTestingModule();
        _angular_core_testing__WEBPACK_IMPORTED_MODULE_2__["TestBed"].configureTestingModule({ providers: this._providers });
        Statics.injector = _angular_core_testing__WEBPACK_IMPORTED_MODULE_2__["TestBed"];
        this.__resolveInjectors__();
        this.initialized.emit();
    }
}


/***/ }),

/***/ "./src/ts/components/attachments.ts":
/*!******************************************!*\
  !*** ./src/ts/components/attachments.ts ***!
  \******************************************/
/*! exports provided: Attachments */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Attachments", function() { return Attachments; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @capacitor/core */ "./node_modules/@capacitor/core/dist/esm/index.js");
/* harmony import */ var _ionic_native_web_intent_ngx__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @ionic-native/web-intent/ngx */ "./node_modules/@ionic-native/web-intent/__ivy_ngcc__/ngx/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../services/api */ "./src/ts/services/api.ts");
/* harmony import */ var _services_nextcloud__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/nextcloud */ "./src/ts/services/nextcloud.ts");
/* harmony import */ var _services_mails__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../services/mails */ "./src/ts/services/mails.ts");
/* harmony import */ var _services_settings__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../services/settings */ "./src/ts/services/settings.ts");










let Attachments = class Attachments extends _base__WEBPACK_IMPORTED_MODULE_4__["BaseComponent"] {
    constructor() {
        super(...arguments);
        this.attachments = [];
        this.message = null;
        this._attDownloading = false;
        this._isCloud = false;
    }
    _initMe() {
        this._isCloud = this._nc.isNextcloud();
    }
    _doDownload(a, where) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._attDownloading = true;
            const fileName = this.message ? `${this.message.Uid}-${a.FileName}` : a.FileName;
            const result = yield this._api.downloadAttachment(this.account, a, fileName, where, this.message);
            this._attDownloading = false;
            return result;
        });
    }
    _downloadAttachment(att) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const result = yield this._doDownload(att, _capacitor_core__WEBPACK_IMPORTED_MODULE_2__["FilesystemDirectory"].Documents);
            if (result == null) {
                return;
            }
            this.alert('Attachment downloaded', result.uri);
        });
    }
    _viewAttachment(a) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const result = yield this._doDownload(a, _capacitor_core__WEBPACK_IMPORTED_MODULE_2__["FilesystemDirectory"].Documents);
            if (result == null) {
                return;
            }
            this._intent.startActivity({
                action: this._intent.ACTION_VIEW,
                url: result.uri,
                type: a.MimeType,
            });
        });
    }
    _removeAttachment(a) {
        const idx = this.attachments.findIndex(_a => _a.Actions.view == a.Actions.view);
        if (idx != -1) {
            this.attachments.splice(idx, 1);
        }
    }
    _uploadToCloud(att) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (!this.message) {
                return;
            }
            if (!att.Actions.download) {
                throw 'NO_DOWNLOAD_ACTION';
            }
            const server = yield this._settings.getServer();
            const folder = yield this._nc.pickFolder();
            console.log('folder is', folder);
            const a = this._mails.accountById(this.message.AccountID);
            const content = yield this._api.getAttachmentContent(a, `${server.url}/${att.Actions.download}`);
            const path = `${folder}/${att.FileName}`;
            const uPath = yield this._nc.upload(path, content);
            this.alert('File uploaded to the cloud', uPath);
        });
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], Attachments.prototype, "attachments", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], Attachments.prototype, "message", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], Attachments.prototype, "account", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_api__WEBPACK_IMPORTED_MODULE_6__["Api"])
], Attachments.prototype, "_api", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_ionic_native_web_intent_ngx__WEBPACK_IMPORTED_MODULE_3__["WebIntent"])
], Attachments.prototype, "_intent", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_nextcloud__WEBPACK_IMPORTED_MODULE_7__["Nextcloud"])
], Attachments.prototype, "_nc", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_mails__WEBPACK_IMPORTED_MODULE_8__["Mails"])
], Attachments.prototype, "_mails", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_settings__WEBPACK_IMPORTED_MODULE_9__["Settings"])
], Attachments.prototype, "_settings", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgCycle"])('init')
], Attachments.prototype, "_initMe", null);
Attachments = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'al-attachments',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/attachments.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/attachments.html")).default,
        styles: [Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! ../../assets/scss/attachments.scss */ "./src/assets/scss/attachments.scss")).default]
    })
], Attachments);



/***/ }),

/***/ "./src/ts/components/avatar.ts":
/*!*************************************!*\
  !*** ./src/ts/components/avatar.ts ***!
  \*************************************/
/*! exports provided: Avatar */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Avatar", function() { return Avatar; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");



let Avatar = class Avatar extends _base__WEBPACK_IMPORTED_MODULE_1__["BaseClass"] {
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
], Avatar.prototype, "contact", void 0);
Avatar = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Component"])({
        selector: 'al-avatar',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/avatar.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/avatar.html")).default,
        styles: [Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! ../../assets/scss/avatar.scss */ "./src/assets/scss/avatar.scss")).default]
    })
], Avatar);



/***/ }),

/***/ "./src/ts/components/compose.ts":
/*!**************************************!*\
  !*** ./src/ts/components/compose.ts ***!
  \**************************************/
/*! exports provided: Compose */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Compose", function() { return Compose; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm2015/index.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/api */ "./src/ts/services/api.ts");
/* harmony import */ var _services_contacts__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../services/contacts */ "./src/ts/services/contacts.ts");
/* harmony import */ var _services_file__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../services/file */ "./src/ts/services/file.ts");
/* harmony import */ var _services_mails__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../services/mails */ "./src/ts/services/mails.ts");
/* harmony import */ var _services_settings__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../services/settings */ "./src/ts/services/settings.ts");
/* harmony import */ var _services_utils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../services/utils */ "./src/ts/services/utils.ts");
/* harmony import */ var _services_nextcloud__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../services/nextcloud */ "./src/ts/services/nextcloud.ts");














let Compose = class Compose extends _base__WEBPACK_IMPORTED_MODULE_4__["BaseComponent"] {
    constructor() {
        super(...arguments);
        this.notify = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this._showCc = false;
        this._contacts = [];
        this._convertor = new _models__WEBPACK_IMPORTED_MODULE_6__["ContactConvertor"]();
        this._combinedView = false;
        this._attaching = false;
        this._cloudAttaching = false;
        this._incloud = false;
    }
    _initMe() {
        this._accounts$ = this._mails.accounts$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["tap"])(accounts => !this._account && setTimeout(() => this._account = accounts[0])), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(accounts => accounts.filter(a => a.AccountID != _models__WEBPACK_IMPORTED_MODULE_6__["COMBINED_ACCOUNT_ID"])));
        this.connect(this._mails.currentAccount$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["take"])(1)), (account) => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._account = this.message ? this._mails.accountById(this.message.AccountID) : account;
            if (this._account.AccountID == _models__WEBPACK_IMPORTED_MODULE_6__["COMBINED_ACCOUNT_ID"]) {
                this._combinedView = true;
                this._account = undefined;
            }
            yield new Promise(resolve => setTimeout(resolve));
            this._setModel();
            this._start();
            this._waitEditorReady();
            this._type = yield this._settings.getMessageType();
        }));
        this._incloud = this._nc.isNextcloud();
    }
    _setModel() {
        const conv = new _models__WEBPACK_IMPORTED_MODULE_6__["MessageComposeConvertor"]();
        conv.composeType = this.composeType;
        conv.currentEmail = this._account ? this._account.Email : '';
        this._model = conv.convert(this.message);
        if (this._model.Cc && ['reply', 'forward'].indexOf(this.composeType) != -1) {
            this._model.Bcc = [];
            this._model.Cc = [];
        }
        if (Array.isArray(this.to) && this.to.length > 0) {
            const conv = new _models__WEBPACK_IMPORTED_MODULE_6__["ContactConvertor"]();
            this._model.To = this.to.map(c => conv.convert(c));
        }
    }
    _start() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (!this._account) {
                return;
            }
            this._setModel();
            if (this._model.Cc.length > 0) {
                this._showCc = true;
            }
            if (_services_utils__WEBPACK_IMPORTED_MODULE_12__["Utils"].isDraftReply(this._model)) {
                const orig = yield this._api.getOriginalDraftReply(this._account, this._model);
                this._model.InReplyTo = orig.MessageId;
            }
            yield this._api.reloadAttachments(this._account, this._model.Attachments);
            this._contacts = this._contactsService.contacts.map(c => this._convertor.convert(c));
        });
    }
    _waitEditorReady() {
        Object(rxjs__WEBPACK_IMPORTED_MODULE_2__["interval"])(100).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["takeWhile"])(() => !this._editor), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["finalize"])(() => this._viewInit())).toPromise();
    }
    _viewInit() {
        this._saveSubscription = this._editor.modelChange.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["debounceTime"])(2000)).subscribe(() => this._save());
    }
    _destroy() {
        if (this._saveSubscription) {
            this._saveSubscription.unsubscribe();
        }
    }
    _filterContact(ev) {
        this._contacts = this._contactsService.contacts
            .filter(c => c.Email.toLowerCase().indexOf(ev.query.toLowerCase()) != -1)
            .map(c => this._convertor.convert(c));
        this._contacts.push(_models__WEBPACK_IMPORTED_MODULE_6__["ModelFactory"].instance({ Email: ev.query, display: ev.query }, _models__WEBPACK_IMPORTED_MODULE_6__["DisplayContact"]));
    }
    _send() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (this._model.To.length == 0) {
                this.alert('No recepient', 'Please add a recipient to receive the e-mail');
                return;
            }
            if (!this._mails.validate(this._model.To.concat(this._model.Cc).concat(this._model.Bcc))) {
                this.alert('Invalid address', 'Please check your addressed');
                return;
            }
            this._destroy();
            this.showLoading();
            const conv = new _models__WEBPACK_IMPORTED_MODULE_6__["MessageSaveConvertor"]();
            const model = conv.convert(this._model);
            const [err, result] = yield Object(_models__WEBPACK_IMPORTED_MODULE_6__["to"])(this._api.sendMessage(this._account, model));
            this.hideLoading();
            if (err) {
                this._save();
                this.alert('Error sending e-mail', err.message, 'error');
                return;
            }
            if (!result) {
                this._save();
                this.alert('Error sending e-mail', '', 'error');
                return;
            }
            this.notify.emit('sent');
        });
    }
    _save() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._destroy();
            this.showLoading();
            const conv = new _models__WEBPACK_IMPORTED_MODULE_6__["MessageSaveConvertor"]();
            const model = conv.convert(this._model);
            const result = yield this._api.saveMessage(this._account, model);
            this._model.DraftUid = result.NewUid;
            this.hideLoading();
            this._viewInit();
        });
    }
    _doAttach(promises) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const attachments = yield Promise.all(promises);
            this._model.Attachments.push.apply(this._model.Attachments, attachments.map(a => a.Attachment));
        });
    }
    _attach() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const files = yield this._fileService.get(this._file.nativeElement);
            this._attaching = true;
            const p = [];
            for (let i = 0; i < files.length; i++) {
                p.push(this._api.uploadAttachment(this._account, files[i]));
            }
            yield this._doAttach(p);
            this._attaching = false;
        });
    }
    _cloudAttach() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const files = yield this._nc.pickFile();
            this._cloudAttaching = true;
            console.log('files are', files);
            let p = [];
            files.forEach(file => {
                p.push(this._nc.download(file));
            });
            const contents = yield Promise.all(p);
            p = [];
            files.forEach((file, idx) => {
                // console.log('downloaded content', content);
                // const data = await this._fileService.read(new Blob([content]))
                const f = new _models__WEBPACK_IMPORTED_MODULE_6__["FileResult"]();
                f.content = new File([contents[idx]], file.replace(/^.*\/([^\/]+)$/, '$1'));
                p.push(this._api.uploadData(this._account, f));
            });
            yield this._doAttach(p);
            this._cloudAttaching = false;
        });
    }
    _blur(a) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (Array.isArray(a.suggestions) && a.suggestions.length > 0) {
                yield new Promise(resolve => setTimeout(resolve));
                if (!a.focus) {
                    a.selectItem(a.suggestions[0], false);
                }
            }
            a.suggestions = [];
        });
    }
    _focus(a) {
        a.suggestions = [];
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], Compose.prototype, "message", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], Compose.prototype, "to", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], Compose.prototype, "composeType", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])()
], Compose.prototype, "notify", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_contacts__WEBPACK_IMPORTED_MODULE_8__["Contacts"])
], Compose.prototype, "_contactsService", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_settings__WEBPACK_IMPORTED_MODULE_11__["Settings"])
], Compose.prototype, "_settings", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_api__WEBPACK_IMPORTED_MODULE_7__["Api"])
], Compose.prototype, "_api", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_mails__WEBPACK_IMPORTED_MODULE_10__["Mails"])
], Compose.prototype, "_mails", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_file__WEBPACK_IMPORTED_MODULE_9__["FileService"])
], Compose.prototype, "_fileService", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_nextcloud__WEBPACK_IMPORTED_MODULE_13__["Nextcloud"])
], Compose.prototype, "_nc", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('file', { static: false })
], Compose.prototype, "_file", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('editor', { static: false })
], Compose.prototype, "_editor", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgCycle"])('init')
], Compose.prototype, "_initMe", null);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgCycle"])('destroy')
], Compose.prototype, "_destroy", null);
Compose = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'al-compose',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/compose.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/compose.html")).default,
        styles: [Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! ../../assets/scss/compose.scss */ "./src/assets/scss/compose.scss")).default]
    })
], Compose);



/***/ }),

/***/ "./src/ts/components/editor.ts":
/*!*************************************!*\
  !*** ./src/ts/components/editor.ts ***!
  \*************************************/
/*! exports provided: Editor */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Editor", function() { return Editor; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");




let Editor = class Editor extends _base__WEBPACK_IMPORTED_MODULE_1__["BaseComponent"] {
    constructor() {
        super(...arguments);
        this.modelChange = new _angular_core__WEBPACK_IMPORTED_MODULE_2__["EventEmitter"]();
    }
    _initMe() {
        this._html = this.model;
    }
    _keyup() {
        this.model = this._editor.nativeElement.innerHTML;
        this.modelChange.emit(this.model);
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Input"])()
], Editor.prototype, "model", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Output"])()
], Editor.prototype, "modelChange", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["ViewChild"])('editor')
], Editor.prototype, "_editor", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgCycle"])('init')
], Editor.prototype, "_initMe", null);
Editor = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Component"])({
        selector: 'al-editor',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/editor.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/editor.html")).default,
        styles: [Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! ../../assets/scss/editor.scss */ "./src/assets/scss/editor.scss")).default]
    })
], Editor);



/***/ }),

/***/ "./src/ts/components/folders-list.ts":
/*!*******************************************!*\
  !*** ./src/ts/components/folders-list.ts ***!
  \*******************************************/
/*! exports provided: FoldersList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FoldersList", function() { return FoldersList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../services/api */ "./src/ts/services/api.ts");
/* harmony import */ var _services_mails__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/mails */ "./src/ts/services/mails.ts");








let FoldersList = class FoldersList extends _base__WEBPACK_IMPORTED_MODULE_3__["BaseComponent"] {
    constructor() {
        super(...arguments);
        this._loading = true;
        this._selected = null;
    }
    set account(a) {
        this._loading = true;
        if (!a) {
            return;
        }
        this._account = a;
        this._account.Folders$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_2__["take"])(1)).subscribe(() => this._loading = false);
        this._init();
    }
    _init() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const inbox = yield this._api.folderByType(_models__WEBPACK_IMPORTED_MODULE_5__["FolderType"].Inbox, this._account);
            this._mails.folderChanged$.emit(inbox);
        });
    }
    _select(folder) {
        if (!folder) {
            return;
        }
        this._selected = folder;
        this._mails.folderChanged$.emit(folder);
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_4__["NgInject"])(_services_mails__WEBPACK_IMPORTED_MODULE_7__["Mails"])
], FoldersList.prototype, "_mails", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_4__["NgInject"])(_services_api__WEBPACK_IMPORTED_MODULE_6__["Api"])
], FoldersList.prototype, "_api", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], FoldersList.prototype, "account", null);
FoldersList = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'al-folders-list',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/folders-list.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/folders-list.html")).default,
        encapsulation: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewEncapsulation"].None,
        styles: [Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! ../../assets/scss/folders-list.scss */ "./src/assets/scss/folders-list.scss")).default]
    })
], FoldersList);



/***/ }),

/***/ "./src/ts/components/loading.ts":
/*!**************************************!*\
  !*** ./src/ts/components/loading.ts ***!
  \**************************************/
/*! exports provided: Loading */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Loading", function() { return Loading; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");



let Loading = class Loading {
    constructor(_cd) {
        this._cd = _cd;
    }
    initMe() {
        if (!this.target) {
            this.target = document.body;
        }
        setTimeout(() => this._cd.detectChanges());
    }
};
Loading.ctorParameters = () => [
    { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ChangeDetectorRef"] }
];
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], Loading.prototype, "target", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_2__["NgCycle"])('init')
], Loading.prototype, "initMe", null);
Loading = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'al-loading',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/loading.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/loading.html")).default
    })
], Loading);



/***/ }),

/***/ "./src/ts/components/message.ts":
/*!**************************************!*\
  !*** ./src/ts/components/message.ts ***!
  \**************************************/
/*! exports provided: Message */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Message", function() { return Message; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @capacitor/core */ "./node_modules/@capacitor/core/dist/esm/index.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm2015/index.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../services/api */ "./src/ts/services/api.ts");
/* harmony import */ var _services_mails__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../services/mails */ "./src/ts/services/mails.ts");
/* harmony import */ var _services_settings__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../services/settings */ "./src/ts/services/settings.ts");
/* harmony import */ var _services_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../services/utils */ "./src/ts/services/utils.ts");












let Message = class Message extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseComponent"] {
    constructor() {
        super(...arguments);
        this.notify = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this._quotedText = false;
        this._isDraft = false;
        this._detailsHidden = true;
        this._hasImages = false;
        this._loading = true;
    }
    set message(m) {
        this._message = m;
        this._originalMessage = m;
        this._html = '';
        if (!m) {
            return;
        }
        if (this._body) {
            this._body.nativeElement.innerHTML = '';
        }
        this._loading = true;
        this._detailsHidden = true;
        this._quotedText = false;
        this._hasImages = false;
        // Keep the real account id (in case of combined view)
        this._accountId = m.AccountID;
        this.connect(this._mails.folderChanged$, f => this._isDraft = f.Type == _models__WEBPACK_IMPORTED_MODULE_7__["FolderType"].Drafts);
        this._mails.currentAccount$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["take"])(1), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["tap"])(account => this._account = account), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["switchMap"])(() => Object(rxjs__WEBPACK_IMPORTED_MODULE_3__["from"])(this._api.getMessageBody(this._account, m))), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["take"])(1)).subscribe(body => {
            this._message = body;
            this._appendBody();
            if (!m.IsSeen) {
                this._api.markRead(this._account, m.Folder, [m], true);
            }
        });
    }
    _initMe() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._server = yield this._settings.getServer();
        });
    }
    _appendBody() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const el = this._body.nativeElement;
            this._html = this._message.Html || this._message.Plain;
            setTimeout(() => {
                this._quotedText = el.querySelector('blockquote') != null;
                this._hasImages = el.querySelectorAll("*[data-x-src]").length > 0;
                this._loading = false;
                Array.from(el.querySelectorAll('a'))
                    .filter(el => el.href.match("^mailto:"))
                    .forEach(a => {
                    const email = a.href.replace(/^mailto:(.*)$/g, '$1');
                    a.href = "javascript: ";
                    a.target = '_self';
                    a.onclick = () => this._emailClick(_models__WEBPACK_IMPORTED_MODULE_7__["ModelFactory"].instance({ Email: email }, _models__WEBPACK_IMPORTED_MODULE_7__["Contact"]));
                });
                const att = this._message.Attachments;
                if (!att || !Array.isArray(att.Collection)) {
                    return;
                }
                const a = this._mails.accountById(this._accountId);
                const user = _services_utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].userByEmail(this._server.users, a.Email);
                att.Collection
                    .filter(a => a.CID)
                    .map(a => ({ a: a, img: el.querySelector(`*[data-x-src-cid="${a.CID}"]`) }))
                    .filter(obj => !!obj.a && !!obj.img)
                    .forEach(obj => {
                    obj.img.src = `${this._server.url}/${obj.a.Actions.view}`;
                    obj.img.onerror = () => {
                        fetch(`${this._server.url}/${obj.a.Actions.view}`, { headers: { Authorization: `Bearer ${user.token}` } })
                            .then(img => img.blob())
                            .then(d => obj.img.src = window.URL.createObjectURL(d));
                    };
                });
                this.hideLoading();
            });
        });
    }
    _showHiddenContent() {
        this._quotedText = false;
    }
    _emailClick(c) {
        const ev = _models__WEBPACK_IMPORTED_MODULE_7__["ModelFactory"].instance({ contact: c, type: 'new' }, _models__WEBPACK_IMPORTED_MODULE_7__["MessageNotify"]);
        this.notify.emit(ev);
    }
    _action(type) {
        const ev = _models__WEBPACK_IMPORTED_MODULE_7__["ModelFactory"].instance({ message: this._message, type: type }, _models__WEBPACK_IMPORTED_MODULE_7__["MessageNotify"]);
        this.notify.emit(ev);
    }
    _download() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (!this._message) {
                return;
            }
            const result = yield this._api.downloadUrl(this._account, `${this._server.url}/${this._message.DownloadAsEmlUrl}`, `${this._message.Uid}.eml`, _capacitor_core__WEBPACK_IMPORTED_MODULE_2__["FilesystemDirectory"].Documents, this._message);
            if (result == null) {
                return;
            }
            this.alert('Message downloaded', result.uri);
        });
    }
    _star() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (!this._message || !this._account) {
                return;
            }
            this._message.IsFlagged = !this._message.IsFlagged;
            yield this._api.flag(this._account, this._message.Folder, [this._message], this._message.IsFlagged);
            this._originalMessage.IsFlagged = this._message.IsFlagged;
        });
    }
    _showImages() {
        this._body.nativeElement.querySelectorAll("*[data-x-src]").forEach(n => n.setAttribute('src', n.getAttribute('data-x-src')));
        this._hasImages = false;
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_6__["NgInject"])(_services_api__WEBPACK_IMPORTED_MODULE_8__["Api"])
], Message.prototype, "_api", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_6__["NgInject"])(_services_mails__WEBPACK_IMPORTED_MODULE_9__["Mails"])
], Message.prototype, "_mails", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_6__["NgInject"])(_services_settings__WEBPACK_IMPORTED_MODULE_10__["Settings"])
], Message.prototype, "_settings", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('messageBody', { static: false })
], Message.prototype, "_body", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], Message.prototype, "message", null);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])()
], Message.prototype, "notify", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_6__["NgCycle"])('init')
], Message.prototype, "_initMe", null);
Message = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'al-message',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/message.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/message.html")).default,
        encapsulation: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewEncapsulation"].None,
        styles: [Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! ../../assets/scss/message.scss */ "./src/assets/scss/message.scss")).default]
    })
], Message);



/***/ }),

/***/ "./src/ts/components/messages-list.ts":
/*!********************************************!*\
  !*** ./src/ts/components/messages-list.ts ***!
  \********************************************/
/*! exports provided: MessagesList */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessagesList", function() { return MessagesList; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm2015/index.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/api */ "./src/ts/services/api.ts");
/* harmony import */ var _services_background__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../services/background */ "./src/ts/services/background.ts");
/* harmony import */ var _services_mails__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../services/mails */ "./src/ts/services/mails.ts");
/* harmony import */ var _services_settings__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../services/settings */ "./src/ts/services/settings.ts");
/* harmony import */ var _services_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../services/utils */ "./src/ts/services/utils.ts");












const DEFAULT = 'Inbox';
let MessagesList = class MessagesList extends _base__WEBPACK_IMPORTED_MODULE_4__["BaseComponent"] {
    constructor() {
        super();
        this.fixSearchForm = false;
        this.notify = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.selectionChanged = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this._loading = true;
        this._pageSize = 0;
        this._totalRecords = 0;
        this._search = new _models__WEBPACK_IMPORTED_MODULE_6__["SearchModel"]();
        this._messages = [];
        this._combinedMessages = [];
        this._combinedView = false;
        this._style = null;
        this._oldestMessage = null;
        this._subscriptions = false;
    }
    get rows() {
        return this._messages;
    }
    _initMe(folder) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this.connect(this._api.ready$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["skip"])(1)), () => {
                this._subscriptions = false;
                this.softRefresh();
            });
            this._pageSize = yield this._settings.getPageSize();
            if (!this.account) {
                return;
            }
            this._combinedView = this.account.AccountID == _models__WEBPACK_IMPORTED_MODULE_6__["COMBINED_ACCOUNT_ID"];
            const d = this.account.AccountID == _models__WEBPACK_IMPORTED_MODULE_6__["COMBINED_ACCOUNT_ID"] ? _models__WEBPACK_IMPORTED_MODULE_6__["FolderType"].Inbox : DEFAULT;
            this._folder = yield this._mails.folderById$(this.account, folder || d.toString()).toPromise();
            this._messages = [];
            this._reset();
            this._initSubscriptions();
        });
    }
    _change(changes) {
        if (!this.account) {
            this._messages = [];
            return;
        }
        if (changes['folder'] && changes['folder'].previousValue && _services_utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].foldersDiff(changes['folder'].previousValue, changes['folder'].currentValue)) {
            this._initMe(this.folder);
            return;
        }
        if (changes['account']) {
            this._initMe();
        }
    }
    _messagesRemoved(messages) {
        if (!messages || !Array.isArray(messages)) {
            return;
        }
        const map = messages.map(m => m.Uid);
        this._combinedMessages = this._combinedMessages.filter(m => map.indexOf(m.Uid) == -1);
        this._table.selection = this._table.selection.filter((m) => map.indexOf(m.Uid) == -1);
        this.selectionChanged.emit(this._table.selection);
    }
    _initSubscriptions() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (this._subscriptions) {
                return;
            }
            this._subscriptions = true;
            const msgChanged = Object(rxjs__WEBPACK_IMPORTED_MODULE_2__["merge"])(this._api.messagesDeleted$, this._api.messagesMoved$, this._mails.refresh$);
            this.connect(msgChanged.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["tap"])(messages => this._messagesRemoved(messages))), () => this._loadMessages({ first: this._table.first }));
            this._background.configure(this._checkMailsAuto.bind(this));
        });
    }
    _waitNewMails() {
        return this._oldestMessage && this._folder && this._folder.Type == _models__WEBPACK_IMPORTED_MODULE_6__["FolderType"].Inbox && _services_utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].emptySearch(this._search);
    }
    _checkMailsAuto() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            console.log('checking mails automatically', new Date());
            if (!this._waitNewMails()) {
                console.log('not waiting for new messages');
                return;
            }
            const [err, msgs] = yield Object(_models__WEBPACK_IMPORTED_MODULE_6__["to"])(this._api.getMessages(this.account, this._folder.Id, 0, 1));
            if (err) {
                throw err;
            }
            console.log('fetched', msgs.length, new Date());
            if (!this._waitNewMails() || msgs.length == 0) {
                return;
            }
            if (msgs.filter(m => m.TimeStampInUTC > this._oldestMessage.TimeStampInUTC).length > 0) {
                this._fetchMailsAuto();
            }
        });
    }
    _fetchMailsAuto() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (!this._folder) {
                return;
            }
            console.log('fetching mails automatically', new Date());
            const initialType = this._folder.Type;
            this._messages = yield this._fetch(this._table.first, true);
            console.log('messages fetched', this._messages.length);
            const selection = (this._table.selection || []).map(s => s.Uid);
            if (this._folder.Type == _models__WEBPACK_IMPORTED_MODULE_6__["FolderType"].Inbox && initialType == _models__WEBPACK_IMPORTED_MODULE_6__["FolderType"].Inbox) {
                this._mails.showNotifications(this._oldestMessage, this._messages);
            }
            this._setOldestMessage();
            this._table.selection = this._messages.filter(m => selection.indexOf(m.Uid) != -1);
            this.selectionChanged.emit(this._table.selection);
        });
    }
    _setOldestMessage() {
        if (this._table.first != 0 || !this._folder && this._folder.Type != _models__WEBPACK_IMPORTED_MODULE_6__["FolderType"].Inbox || !Array.isArray(this._messages) || this._messages.length == 0) {
            return;
        }
        this._oldestMessage = this._messages[0];
    }
    _fetch(first, auto = false) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const id = this._folder.Id;
            let result = yield this._api.getMessages(this.account, this._folder.Id, first, this._pageSize, this._search.simple, '', auto);
            if (this._folder.Id != id) {
                return this._messages.length > 0 && this._mails.messageInComposedFolder(this._messages[0], this._folder) ? this._messages : [];
            }
            if (this.account.AccountID != _models__WEBPACK_IMPORTED_MODULE_6__["COMBINED_ACCOUNT_ID"]) {
                return result;
            }
            if (first == 0) {
                this._combinedMessages = [];
            }
            const uids = result.map(x => x.Uid);
            this._combinedMessages = this._combinedMessages.filter(m => uids.indexOf(m.Uid) == -1).concat(result);
            this._combinedMessages.sort((a, b) => b.TimeStampInUTC - a.TimeStampInUTC);
            return this._combinedMessages.slice(first, first + this._pageSize);
        });
    }
    _reset() {
        this._combinedMessages = [];
        this._table.reset();
        this.selectionChanged.emit([]);
        this._table.selection = [];
    }
    _loadMessages(ev) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._loading = true;
            if (this.account == null || this._folder == null) {
                return;
            }
            this._messages = yield this._fetch(ev.first);
            this._setOldestMessage();
            this._totalRecords = this._api.lastSearchResults;
            this._loading = false;
            this._mails.refreshed$.emit();
        });
    }
    _keyup(ev) {
        if (ev.keyCode != 13) {
            return;
        }
        this._reset();
    }
    _advSearch() {
        const conv = new _models__WEBPACK_IMPORTED_MODULE_6__["SearchConvertor"]();
        this._search.simple = conv.convert(this._search);
        this._reset();
    }
    _clearSearch() {
        this._search = new _models__WEBPACK_IMPORTED_MODULE_6__["SearchModel"]();
        this._reset();
    }
    _select(row) {
        this.notify.emit(row);
        this._selected = row;
    }
    _selectionChanged() {
        this.selectionChanged.emit(this._table.selection);
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], MessagesList.prototype, "account", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], MessagesList.prototype, "folder", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Input"])()
], MessagesList.prototype, "fixSearchForm", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])()
], MessagesList.prototype, "notify", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Output"])()
], MessagesList.prototype, "selectionChanged", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_settings__WEBPACK_IMPORTED_MODULE_10__["Settings"])
], MessagesList.prototype, "_settings", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_mails__WEBPACK_IMPORTED_MODULE_9__["Mails"])
], MessagesList.prototype, "_mails", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_api__WEBPACK_IMPORTED_MODULE_7__["Api"])
], MessagesList.prototype, "_api", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_background__WEBPACK_IMPORTED_MODULE_8__["Background"])
], MessagesList.prototype, "_background", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('table', { static: true })
], MessagesList.prototype, "_table", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgCycle"])('init')
], MessagesList.prototype, "_initMe", null);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgCycle"])('change')
], MessagesList.prototype, "_change", null);
MessagesList = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'al-messages-list',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/messages-list.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/messages-list.html")).default,
        encapsulation: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewEncapsulation"].None,
        styles: [Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! ../../assets/scss/messages-list.scss */ "./src/assets/scss/messages-list.scss")).default]
    })
], MessagesList);



/***/ }),

/***/ "./src/ts/decorators.ts":
/*!******************************!*\
  !*** ./src/ts/decorators.ts ***!
  \******************************/
/*! exports provided: TEST_CASES, TEST_CASES_ONLY, METADATA, NgInject, NgCycle, deserialize, deserializers, NgTest */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TEST_CASES", function() { return TEST_CASES; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "TEST_CASES_ONLY", function() { return TEST_CASES_ONLY; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "METADATA", function() { return METADATA; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NgInject", function() { return NgInject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NgCycle", function() { return NgCycle; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deserialize", function() { return deserialize; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "deserializers", function() { return deserializers; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "NgTest", function() { return NgTest; });
const TEST_CASES = new Map();
const TEST_CASES_ONLY = new Map();
const METADATA = new Map();
function __decorate(protoName, arg) {
    return function (ctor, property) {
        if (!METADATA.get(ctor.constructor)) {
            METADATA.set(ctor.constructor, new Map());
        }
        const m = METADATA.get(ctor.constructor);
        if (typeof (m.get(protoName)) == 'undefined') {
            m.set(protoName, []);
        }
        m.get(protoName).push({ prop: property, arg: arg });
    };
}
function NgInject(type) {
    return __decorate('__injectors__', type);
}
function NgCycle(cycle) {
    return __decorate('__cycles__', cycle);
}
function deserialize(type) {
    return __decorate('__deserializers__', type);
}
function deserializers(ctor) {
    if (!METADATA.get(ctor)) {
        return [];
    }
    return METADATA.get(ctor).get('__deserializers__');
}
function add_to_testcases(which, ctor, property, name) {
    if (typeof (which.get(ctor.constructor)) == 'undefined') {
        which.set(ctor.constructor, []);
    }
    which.get(ctor.constructor).push({ name: name, method: property });
}
function NgTest(name, only = false) {
    return function (ctor, property) {
        add_to_testcases(only ? TEST_CASES_ONLY : TEST_CASES, ctor, property, name);
    };
}


/***/ }),

/***/ "./src/ts/models.ts":
/*!**************************!*\
  !*** ./src/ts/models.ts ***!
  \**************************/
/*! exports provided: COMBINED_ACCOUNT_ID, LogLevel, FolderType, ModelFactory, to, UserSetting, ServerSetting, HttpResponse, Server, Authentication, Folder, Contact, Contacts, Message, Messages, Action, SearchConvertor, FoldersConvertor, Attachment, Attachments, MessageBody, Account, FoldersInfoResult, SearchModel, MessageNotify, DisplayContact, MessageCompose, ContactConvertor, ReplyToBodyConvertor, ForwardBodyConvertor, MessageComposeConvertor, FileResult, UploadResult, Identity, MessageSave, MessageSaveConvertor, SaveMessageResponse, ComposedResult, FormDataSerialized, LabelValue, AppSetting, AppSettings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "COMBINED_ACCOUNT_ID", function() { return COMBINED_ACCOUNT_ID; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LogLevel", function() { return LogLevel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FolderType", function() { return FolderType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ModelFactory", function() { return ModelFactory; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "to", function() { return to; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UserSetting", function() { return UserSetting; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ServerSetting", function() { return ServerSetting; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HttpResponse", function() { return HttpResponse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Server", function() { return Server; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Authentication", function() { return Authentication; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Folder", function() { return Folder; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Contact", function() { return Contact; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Contacts", function() { return Contacts; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Message", function() { return Message; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Messages", function() { return Messages; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Action", function() { return Action; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SearchConvertor", function() { return SearchConvertor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FoldersConvertor", function() { return FoldersConvertor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Attachment", function() { return Attachment; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Attachments", function() { return Attachments; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageBody", function() { return MessageBody; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Account", function() { return Account; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FoldersInfoResult", function() { return FoldersInfoResult; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SearchModel", function() { return SearchModel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageNotify", function() { return MessageNotify; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DisplayContact", function() { return DisplayContact; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageCompose", function() { return MessageCompose; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContactConvertor", function() { return ContactConvertor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ReplyToBodyConvertor", function() { return ReplyToBodyConvertor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ForwardBodyConvertor", function() { return ForwardBodyConvertor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageComposeConvertor", function() { return MessageComposeConvertor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FileResult", function() { return FileResult; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "UploadResult", function() { return UploadResult; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Identity", function() { return Identity; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageSave", function() { return MessageSave; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageSaveConvertor", function() { return MessageSaveConvertor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "SaveMessageResponse", function() { return SaveMessageResponse; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ComposedResult", function() { return ComposedResult; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FormDataSerialized", function() { return FormDataSerialized; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LabelValue", function() { return LabelValue; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppSetting", function() { return AppSetting; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AppSettings", function() { return AppSettings; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! dateformat */ "./node_modules/dateformat/lib/dateformat.js");
/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_1__);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm2015/index.js");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./decorators */ "./src/ts/decorators.ts");




const COMBINED_ACCOUNT_ID = "-1";
var LogLevel;
(function (LogLevel) {
    LogLevel[LogLevel["DEBUG"] = 0] = "DEBUG";
    LogLevel[LogLevel["INFO"] = 1] = "INFO";
    LogLevel[LogLevel["ERROR"] = 2] = "ERROR";
})(LogLevel || (LogLevel = {}));
;
var FolderType;
(function (FolderType) {
    FolderType[FolderType["Inbox"] = 1] = "Inbox";
    FolderType[FolderType["Sent"] = 2] = "Sent";
    FolderType[FolderType["Drafts"] = 3] = "Drafts";
    FolderType[FolderType["Spam"] = 4] = "Spam";
    FolderType[FolderType["Trash"] = 5] = "Trash";
    FolderType[FolderType["Other"] = 10] = "Other";
})(FolderType || (FolderType = {}));
;
class ModelFactory {
    static _primitive(obj) {
        if (typeof (obj) == 'boolean') {
            return obj;
        }
        if (typeof (obj) == 'string') {
            return obj;
        }
        if (typeof (obj) == 'number') {
            return obj;
        }
    }
    static _create(json, type) {
        const result = new type();
        Object.keys(json).map(k => k.replace(/^@/g, '')).forEach(k => {
            const d = Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserializers"])(type).find(d => d.prop == k);
            const value = json[k] || json['@' + k];
            if (!d || typeof (value) == undefined || value == null) {
                result[k] = value;
                return;
            }
            if (d.arg == 'date') {
                result[k] = new Date(json[k]);
                return;
            }
            if (typeof (d.arg) == 'function' && !!d.arg.prototype['convert']) {
                const convertor = new d.arg();
                result[k] = convertor.convert(value);
                return;
            }
            result[k] = ModelFactory.instance(value, d.arg);
        });
        return result;
    }
    static instance(json, type) {
        if (typeof (json) == undefined || json == null) {
            return null;
        }
        if (typeof (type) == 'undefined') {
            if (typeof (json) == 'object' && !Array.isArray(json)) {
                throw Error('UNKNOWN_TYPE');
            }
            if (Array.isArray(json)) {
                return json.map(o => ModelFactory._primitive(o));
            }
            return ModelFactory._primitive(json);
        }
        if (Array.isArray(json)) {
            return json.map(j => ModelFactory._create(j, type));
        }
        return ModelFactory._create(json, type);
    }
}
function to(promise) {
    return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
        try {
            const data = yield promise;
            return [null, data];
        }
        catch (err) {
            return [err, null];
        }
    });
}
class UserSetting {
}
class ServerSetting {
}
class HttpResponse {
}
class Server {
}
class Authentication {
}
class Folder {
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Folder)
], Folder.prototype, "SubFolders", void 0);
class Contact {
}
class Contacts {
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contact)
], Contacts.prototype, "Collection", void 0);
class Message {
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contacts)
], Message.prototype, "From", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contacts)
], Message.prototype, "To", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contacts)
], Message.prototype, "Cc", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contacts)
], Message.prototype, "Bcc", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contacts)
], Message.prototype, "ReplyTo", void 0);
class Messages {
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Message)
], Messages.prototype, "Collection", void 0);
class Action {
}
class ActionConvertor {
    convert(src) {
        const result = new Action();
        if (src['view']) {
            result.view = src['view'].url;
        }
        if (src['download']) {
            result.download = src['download'].url;
        }
        return result;
    }
}
class SearchConvertor {
    _add(result, key, value) {
        if (!value) {
            return result;
        }
        return result + (result == '' ? '' : ' ') + `${key}:"${value}"`;
    }
    _date(d) {
        if (!d) {
            return '';
        }
        return dateformat__WEBPACK_IMPORTED_MODULE_1__(d, 'yyyy.mm.dd');
    }
    convert(src) {
        let result = '';
        result = this._add(result, 'from', src.from);
        result = this._add(result, 'to', src.to);
        result = this._add(result, 'subject', src.subject);
        result = this._add(result, 'text', src.text);
        if (src.attachments) {
            result = this._add(result, 'has', 'attachments');
        }
        if (src.since || src.till) {
            result = this._add(result, 'date', `${this._date(src.since)}/${this._date(src.till)}`);
        }
        return result;
    }
}
class FoldersConvertor {
    _addNewFolder(x, possibleParents) {
        const parts = x.split('/');
        const name = parts[parts.length - 1];
        const f = new Folder();
        f.Id = x;
        f.Count = 0;
        f.Unread = 0;
        f.Name = name;
        f.SubFolders = [];
        if (parts.length == 1) {
            possibleParents.push(f);
            return;
        }
        const parentName = parts[parts.length - 2];
        const parent = possibleParents.find(p => p.Name == parentName);
        if (!parent) {
            return;
        }
        parent.SubFolders.push(f);
    }
    convert(src) {
        if (!src) {
            return [];
        }
        let arr;
        try {
            arr = JSON.parse(src);
        }
        catch (_a) {
            arr = [];
        }
        arr.sort((a, b) => a.split('/').length - b.split('/').length);
        const levels = arr[arr.length - 1].split('/').length;
        const result = [];
        const tree = new Map();
        for (let level = 1; level <= levels; level++) {
            const items = arr.filter(x => x.split('/').length == level);
            if (level == 1) {
                items.forEach(i => this._addNewFolder(i, result));
                tree.set(level, result);
                continue;
            }
            items.forEach(i => this._addNewFolder(i, tree.get(level - 1)));
            tree.set(level, tree.get(level - 1).map(x => x.SubFolders).reduce((acc, v) => acc.concat(v), []));
        }
        return result;
    }
}
class Attachment {
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(ActionConvertor)
], Attachment.prototype, "Actions", void 0);
class Attachments {
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Attachment)
], Attachments.prototype, "Collection", void 0);
class MessageBody extends Message {
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contacts)
], MessageBody.prototype, "From", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contacts)
], MessageBody.prototype, "To", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contacts)
], MessageBody.prototype, "Cc", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contacts)
], MessageBody.prototype, "Bcc", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Contacts)
], MessageBody.prototype, "ReplyTo", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Attachments)
], MessageBody.prototype, "Attachments", void 0);
class Account {
    constructor() {
        this.Folders$ = new rxjs__WEBPACK_IMPORTED_MODULE_2__["ReplaySubject"]();
        this.TypesSet = false;
    }
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Server)
], Account.prototype, "Server", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(FoldersConvertor)
], Account.prototype, "FoldersOrder", void 0);
class FoldersInfoResult {
}
class SearchModel {
}
class MessageNotify {
}
class DisplayContact extends Contact {
}
class MessageCompose {
    constructor() {
        this.DraftInfo = [];
    }
}
class ContactConvertor {
    convert(src) {
        const result = ModelFactory.instance(src, DisplayContact);
        result.display = result.DisplayName || result.Email;
        return result;
    }
}
class ReplyToBodyConvertor {
    convert(msg) {
        const d = new Date(msg.TimeStampInUTC * 1000);
        const c = msg.From.Collection[0];
        return `
<br/>
On ${dateformat__WEBPACK_IMPORTED_MODULE_1__(d, 'ddd, mmm dd "at" HH:MM')}, ${c.DisplayName || c.Email} wrote:
<blockquote>${msg.Html || msg.Plain}</blockquote>
`;
    }
}
class ForwardBodyConvertor {
    _collection(contacts) {
        if (!contacts || !Array.isArray(contacts.Collection)) {
            return '';
        }
        return contacts.Collection.map(c => c.DisplayName ? `${c.DisplayName} &lt;${c.Email}&gt;` : c.Email).join(', ');
    }
    convert(msg) {
        const d = new Date(msg.TimeStampInUTC * 1000);
        const cc = this._collection(msg.Cc);
        return `
<br/>
---- Original message ----<br/>
From: ${this._collection(msg.From)}<br/>
To: ${this._collection(msg.To)}<br/>
${cc ? 'CC: ' + cc + '<br/>' : ''}
Sent: ${dateformat__WEBPACK_IMPORTED_MODULE_1__(d, 'ddd, mmm dd, yyyy HH:MM')}<br/>
Subject: ${msg.Subject}<br/>
<br/>
${msg.Html || msg.Plain}
`;
    }
}
class MessageComposeConvertor {
    constructor() {
        this.composeType = 'new';
        this.currentEmail = null;
        this._conv = new ContactConvertor();
    }
    _convertCollection(c) {
        if (!c || !Array.isArray(c.Collection)) {
            return [];
        }
        return c.Collection.map(c => this._conv.convert(c));
    }
    convert(src) {
        const result = new MessageCompose();
        if (!src) {
            result.Body = '';
            result.Subject = '';
            result.Attachments = [];
            result.Bcc = [];
            result.Cc = [];
            result.To = [];
            result.ReplyTo = [];
            result.DraftInfo = [];
        }
        else {
            result.Body = src.Html || src.Plain;
            result.Subject = src.Subject;
            result.Attachments = src.Attachments ? src.Attachments.Collection : [];
            result.Bcc = this._convertCollection(src.Bcc);
            result.AccountID = src.AccountID;
            result.Cc = this._convertCollection(src.Cc);
            result.To = this._convertCollection(src.To);
            result.ReplyTo = this._convertCollection(src.ReplyTo);
            result.DraftInfo = src.DraftInfo;
            if (this.composeType == 'from-draft') {
                result.DraftUid = src.Uid;
            }
            if (['reply', 'reply-all'].indexOf(this.composeType) != -1) {
                result.To = this._convertCollection(src.From);
                if (this.composeType == 'reply-all') {
                    result.To = result.To
                        .concat(this._convertCollection(src.To).filter(c => c.Email != this.currentEmail));
                    result.Cc = this._convertCollection(src.Cc).filter(c => c.Email != this.currentEmail);
                }
                const conv = new ReplyToBodyConvertor();
                result.Body = conv.convert(src);
                result.Attachments = [];
                result.Subject = `Re: ${result.Subject}`;
                result.InReplyTo = src.MessageId;
                if (!result.DraftInfo || !Array.isArray(result.DraftInfo) || result.DraftInfo.length == 0) {
                    result.DraftInfo = [this.composeType, src.Uid, src.Folder];
                }
            }
            if (this.composeType == 'forward') {
                result.To = [];
                result.Cc = [];
                result.References = ` ${src.MessageId}`;
                result.InReplyTo = src.MessageId;
                const conv = new ForwardBodyConvertor();
                result.Body = conv.convert(src);
                result.Subject = `Fwd: ${src.Subject}`;
                if (!result.DraftInfo || !Array.isArray(result.DraftInfo) || result.DraftInfo.length == 0) {
                    result.DraftInfo = ["forward", src.Uid, src.Folder];
                }
            }
        }
        return result;
    }
}
class FileResult {
}
class UploadResult {
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(Attachment)
], UploadResult.prototype, "Attachment", void 0);
class Identity {
}
class MessageSave {
    constructor() {
        this.FetcherID = '';
        this.DraftInfo = [];
        this.Importance = 3;
        this.SendReadingConfirmation = false;
        this.References = '';
        this.Sensitivity = 0;
    }
}
class MessageSaveConvertor {
    _mapCollection(arr) {
        return arr.map(a => a.DisplayName ? `${a.DisplayName} <${a.Email}>` : a.Email).join(",");
    }
    convert(src) {
        const result = new MessageSave();
        result.To = this._mapCollection(src.To);
        result.Cc = this._mapCollection(src.Cc);
        result.Bcc = this._mapCollection(src.Bcc);
        result.Subject = src.Subject;
        result.DraftUid = src.DraftUid;
        result.DraftInfo = src.DraftInfo;
        result.Text = src.Body;
        result.IsHtml = true;
        result.Attachments = src.Attachments.reduce((acc, v) => {
            acc[v.TempName] = [v.FileName, "", "0", "0", ""];
            return acc;
        }, {});
        result.InReplyTo = src.InReplyTo;
        result.References = src.References;
        return result;
    }
}
class SaveMessageResponse {
}
class ComposedResult {
}
class FormDataSerialized {
}
class LabelValue {
}
class AppSetting {
}
class AppSettings {
}
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(ServerSetting)
], AppSettings.prototype, "server", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(AppSetting)
], AppSettings.prototype, "pageSize", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(AppSetting)
], AppSettings.prototype, "composeType", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["deserialize"])(AppSetting)
], AppSettings.prototype, "checkEmailInterval", void 0);


/***/ }),

/***/ "./src/ts/modules/main.ts":
/*!********************************!*\
  !*** ./src/ts/modules/main.ts ***!
  \********************************/
/*! exports provided: Main */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Main", function() { return Main; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _angular_forms__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/forms */ "./node_modules/@angular/forms/__ivy_ngcc__/fesm2015/forms.js");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/__ivy_ngcc__/fesm2015/platform-browser.js");
/* harmony import */ var _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @angular/platform-browser/animations */ "./node_modules/@angular/platform-browser/__ivy_ngcc__/fesm2015/animations.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js");
/* harmony import */ var _ionic_native_file_chooser_ngx__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @ionic-native/file-chooser/ngx */ "./node_modules/@ionic-native/file-chooser/__ivy_ngcc__/ngx/index.js");
/* harmony import */ var _ionic_native_http_ngx__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @ionic-native/http/ngx */ "./node_modules/@ionic-native/http/__ivy_ngcc__/ngx/index.js");
/* harmony import */ var _ionic_native_splash_screen_ngx__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @ionic-native/splash-screen/ngx */ "./node_modules/@ionic-native/splash-screen/__ivy_ngcc__/ngx/index.js");
/* harmony import */ var _ionic_native_status_bar_ngx__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @ionic-native/status-bar/ngx */ "./node_modules/@ionic-native/status-bar/__ivy_ngcc__/ngx/index.js");
/* harmony import */ var _ionic_native_web_intent_ngx__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @ionic-native/web-intent/ngx */ "./node_modules/@ionic-native/web-intent/__ivy_ngcc__/ngx/index.js");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js");
/* harmony import */ var primeng_api__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! primeng/api */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-api.js");
/* harmony import */ var primeng_autocomplete__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! primeng/autocomplete */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-autocomplete.js");
/* harmony import */ var primeng_blockui__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! primeng/blockui */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-blockui.js");
/* harmony import */ var primeng_button__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! primeng/button */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-button.js");
/* harmony import */ var primeng_calendar__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! primeng/calendar */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-calendar.js");
/* harmony import */ var primeng_checkbox__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! primeng/checkbox */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-checkbox.js");
/* harmony import */ var primeng_chips__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! primeng/chips */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-chips.js");
/* harmony import */ var primeng_dialog__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! primeng/dialog */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-dialog.js");
/* harmony import */ var primeng_dropdown__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! primeng/dropdown */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-dropdown.js");
/* harmony import */ var primeng_inputtext__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! primeng/inputtext */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-inputtext.js");
/* harmony import */ var primeng_inputtextarea__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! primeng/inputtextarea */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-inputtextarea.js");
/* harmony import */ var primeng_menu__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! primeng/menu */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-menu.js");
/* harmony import */ var primeng_message__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! primeng/message */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-message.js");
/* harmony import */ var primeng_overlaypanel__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! primeng/overlaypanel */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-overlaypanel.js");
/* harmony import */ var primeng_panel__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! primeng/panel */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-panel.js");
/* harmony import */ var primeng_sidebar__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! primeng/sidebar */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-sidebar.js");
/* harmony import */ var primeng_table__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! primeng/table */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-table.js");
/* harmony import */ var primeng_toast__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! primeng/toast */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-toast.js");
/* harmony import */ var primeng_toolbar__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! primeng/toolbar */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-toolbar.js");
/* harmony import */ var primeng_tree__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! primeng/tree */ "./node_modules/primeng/__ivy_ngcc__/fesm2015/primeng-tree.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _components_attachments__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! ../components/attachments */ "./src/ts/components/attachments.ts");
/* harmony import */ var _components_avatar__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! ../components/avatar */ "./src/ts/components/avatar.ts");
/* harmony import */ var _components_compose__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ../components/compose */ "./src/ts/components/compose.ts");
/* harmony import */ var _components_editor__WEBPACK_IMPORTED_MODULE_36__ = __webpack_require__(/*! ../components/editor */ "./src/ts/components/editor.ts");
/* harmony import */ var _components_folders_list__WEBPACK_IMPORTED_MODULE_37__ = __webpack_require__(/*! ../components/folders-list */ "./src/ts/components/folders-list.ts");
/* harmony import */ var _components_loading__WEBPACK_IMPORTED_MODULE_38__ = __webpack_require__(/*! ../components/loading */ "./src/ts/components/loading.ts");
/* harmony import */ var _components_message__WEBPACK_IMPORTED_MODULE_39__ = __webpack_require__(/*! ../components/message */ "./src/ts/components/message.ts");
/* harmony import */ var _components_messages_list__WEBPACK_IMPORTED_MODULE_40__ = __webpack_require__(/*! ../components/messages-list */ "./src/ts/components/messages-list.ts");
/* harmony import */ var _pages_home__WEBPACK_IMPORTED_MODULE_41__ = __webpack_require__(/*! ../pages/home */ "./src/ts/pages/home.ts");
/* harmony import */ var _pages_main__WEBPACK_IMPORTED_MODULE_42__ = __webpack_require__(/*! ../pages/main */ "./src/ts/pages/main.ts");
/* harmony import */ var _pages_playground__WEBPACK_IMPORTED_MODULE_43__ = __webpack_require__(/*! ../pages/playground */ "./src/ts/pages/playground.ts");
/* harmony import */ var _pages_settings__WEBPACK_IMPORTED_MODULE_44__ = __webpack_require__(/*! ../pages/settings */ "./src/ts/pages/settings.ts");
/* harmony import */ var _pipes__WEBPACK_IMPORTED_MODULE_45__ = __webpack_require__(/*! ../pipes */ "./src/ts/pipes.ts");
/* harmony import */ var _routing__WEBPACK_IMPORTED_MODULE_46__ = __webpack_require__(/*! ../routing */ "./src/ts/routing.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_47__ = __webpack_require__(/*! ../services/api */ "./src/ts/services/api.ts");
/* harmony import */ var _services_contacts__WEBPACK_IMPORTED_MODULE_48__ = __webpack_require__(/*! ../services/contacts */ "./src/ts/services/contacts.ts");
/* harmony import */ var _services_file__WEBPACK_IMPORTED_MODULE_49__ = __webpack_require__(/*! ../services/file */ "./src/ts/services/file.ts");
/* harmony import */ var _services_layout__WEBPACK_IMPORTED_MODULE_50__ = __webpack_require__(/*! ../services/layout */ "./src/ts/services/layout.ts");
/* harmony import */ var _services_mails__WEBPACK_IMPORTED_MODULE_51__ = __webpack_require__(/*! ../services/mails */ "./src/ts/services/mails.ts");
/* harmony import */ var _services_navigation__WEBPACK_IMPORTED_MODULE_52__ = __webpack_require__(/*! ../services/navigation */ "./src/ts/services/navigation.ts");
/* harmony import */ var _services_route_reuse__WEBPACK_IMPORTED_MODULE_53__ = __webpack_require__(/*! ../services/route-reuse */ "./src/ts/services/route-reuse.ts");
/* harmony import */ var _services_settings__WEBPACK_IMPORTED_MODULE_54__ = __webpack_require__(/*! ../services/settings */ "./src/ts/services/settings.ts");
/* harmony import */ var _services_store__WEBPACK_IMPORTED_MODULE_55__ = __webpack_require__(/*! ../services/store */ "./src/ts/services/store.ts");
/* harmony import */ var _services_background__WEBPACK_IMPORTED_MODULE_56__ = __webpack_require__(/*! ../services/background */ "./src/ts/services/background.ts");
/* harmony import */ var _services_nextcloud__WEBPACK_IMPORTED_MODULE_57__ = __webpack_require__(/*! ../services/nextcloud */ "./src/ts/services/nextcloud.ts");


























































let Main = class Main {
    constructor(i) {
        _base__WEBPACK_IMPORTED_MODULE_32__["Statics"].injector = i;
    }
};
Main.ctorParameters = () => [
    { type: _angular_core__WEBPACK_IMPORTED_MODULE_1__["Injector"] }
];
Main = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgModule"])({
        declarations: [
            _pages_main__WEBPACK_IMPORTED_MODULE_42__["Main"], _pages_home__WEBPACK_IMPORTED_MODULE_41__["Home"], _pages_settings__WEBPACK_IMPORTED_MODULE_44__["Settings"], _components_loading__WEBPACK_IMPORTED_MODULE_38__["Loading"], _pages_playground__WEBPACK_IMPORTED_MODULE_43__["Playground"], _components_folders_list__WEBPACK_IMPORTED_MODULE_37__["FoldersList"], _pipes__WEBPACK_IMPORTED_MODULE_45__["FoldersTree"],
            _components_messages_list__WEBPACK_IMPORTED_MODULE_40__["MessagesList"], _pipes__WEBPACK_IMPORTED_MODULE_45__["MessageDate"], _pipes__WEBPACK_IMPORTED_MODULE_45__["MessageFrom"], _pipes__WEBPACK_IMPORTED_MODULE_45__["FolderLabel"], _components_message__WEBPACK_IMPORTED_MODULE_39__["Message"], _components_avatar__WEBPACK_IMPORTED_MODULE_34__["Avatar"],
            _pipes__WEBPACK_IMPORTED_MODULE_45__["AvatarText"], _pipes__WEBPACK_IMPORTED_MODULE_45__["AvatarColor"], _pipes__WEBPACK_IMPORTED_MODULE_45__["MessageFromTxt"], _pipes__WEBPACK_IMPORTED_MODULE_45__["MessageFromTxtFull"],
            _pipes__WEBPACK_IMPORTED_MODULE_45__["ContactsListTxt"], _pipes__WEBPACK_IMPORTED_MODULE_45__["ContactsArray"], _pipes__WEBPACK_IMPORTED_MODULE_45__["AsHtml"], _pipes__WEBPACK_IMPORTED_MODULE_45__["AttachmentsList"],
            _pipes__WEBPACK_IMPORTED_MODULE_45__["HumanFileSize"], _pipes__WEBPACK_IMPORTED_MODULE_45__["FileIconPipe"], _components_compose__WEBPACK_IMPORTED_MODULE_35__["Compose"], _components_attachments__WEBPACK_IMPORTED_MODULE_33__["Attachments"], _components_editor__WEBPACK_IMPORTED_MODULE_36__["Editor"], _pipes__WEBPACK_IMPORTED_MODULE_45__["CurrentEmail"],
            _pipes__WEBPACK_IMPORTED_MODULE_45__["BorderRight"], _pipes__WEBPACK_IMPORTED_MODULE_45__["AccountToContact"], _pipes__WEBPACK_IMPORTED_MODULE_45__["IsCombinedAccount"], _pipes__WEBPACK_IMPORTED_MODULE_45__["Count"],
        ],
        entryComponents: [_components_loading__WEBPACK_IMPORTED_MODULE_38__["Loading"]],
        imports: [
            _angular_platform_browser__WEBPACK_IMPORTED_MODULE_3__["BrowserModule"], _ionic_angular__WEBPACK_IMPORTED_MODULE_11__["IonicModule"].forRoot(),
            _angular_platform_browser_animations__WEBPACK_IMPORTED_MODULE_4__["BrowserAnimationsModule"], primeng_sidebar__WEBPACK_IMPORTED_MODULE_27__["SidebarModule"], primeng_button__WEBPACK_IMPORTED_MODULE_15__["ButtonModule"], primeng_toolbar__WEBPACK_IMPORTED_MODULE_30__["ToolbarModule"], primeng_panel__WEBPACK_IMPORTED_MODULE_26__["PanelModule"],
            primeng_inputtext__WEBPACK_IMPORTED_MODULE_21__["InputTextModule"], _angular_forms__WEBPACK_IMPORTED_MODULE_2__["FormsModule"], primeng_message__WEBPACK_IMPORTED_MODULE_24__["MessageModule"], primeng_blockui__WEBPACK_IMPORTED_MODULE_14__["BlockUIModule"], primeng_tree__WEBPACK_IMPORTED_MODULE_31__["TreeModule"],
            _angular_router__WEBPACK_IMPORTED_MODULE_5__["RouterModule"].forRoot(_routing__WEBPACK_IMPORTED_MODULE_46__["routes"], { preloadingStrategy: _angular_router__WEBPACK_IMPORTED_MODULE_5__["PreloadAllModules"], useHash: true }),
            primeng_table__WEBPACK_IMPORTED_MODULE_28__["TableModule"], primeng_overlaypanel__WEBPACK_IMPORTED_MODULE_25__["OverlayPanelModule"], primeng_calendar__WEBPACK_IMPORTED_MODULE_16__["CalendarModule"], primeng_checkbox__WEBPACK_IMPORTED_MODULE_17__["CheckboxModule"], primeng_chips__WEBPACK_IMPORTED_MODULE_18__["ChipsModule"], primeng_toast__WEBPACK_IMPORTED_MODULE_29__["ToastModule"],
            primeng_autocomplete__WEBPACK_IMPORTED_MODULE_13__["AutoCompleteModule"], primeng_inputtextarea__WEBPACK_IMPORTED_MODULE_22__["InputTextareaModule"], primeng_menu__WEBPACK_IMPORTED_MODULE_23__["MenuModule"], primeng_dialog__WEBPACK_IMPORTED_MODULE_19__["DialogModule"], primeng_dropdown__WEBPACK_IMPORTED_MODULE_20__["DropdownModule"],
        ],
        providers: [
            _ionic_native_status_bar_ngx__WEBPACK_IMPORTED_MODULE_9__["StatusBar"],
            _ionic_native_splash_screen_ngx__WEBPACK_IMPORTED_MODULE_8__["SplashScreen"], _services_api__WEBPACK_IMPORTED_MODULE_47__["Api"], _services_store__WEBPACK_IMPORTED_MODULE_55__["Store"], _services_settings__WEBPACK_IMPORTED_MODULE_54__["Settings"], _services_contacts__WEBPACK_IMPORTED_MODULE_48__["Contacts"], _services_layout__WEBPACK_IMPORTED_MODULE_50__["Layout"], _services_navigation__WEBPACK_IMPORTED_MODULE_52__["Navigation"],
            _services_mails__WEBPACK_IMPORTED_MODULE_51__["Mails"], primeng_api__WEBPACK_IMPORTED_MODULE_12__["MessageService"], _services_file__WEBPACK_IMPORTED_MODULE_49__["FileService"],
            { provide: _angular_router__WEBPACK_IMPORTED_MODULE_5__["RouteReuseStrategy"], useClass: _services_route_reuse__WEBPACK_IMPORTED_MODULE_53__["DefaultRouteReuseStrategy"] },
            _ionic_native_http_ngx__WEBPACK_IMPORTED_MODULE_7__["HTTP"], _ionic_native_file_chooser_ngx__WEBPACK_IMPORTED_MODULE_6__["FileChooser"], _services_background__WEBPACK_IMPORTED_MODULE_56__["Background"], _services_nextcloud__WEBPACK_IMPORTED_MODULE_57__["Nextcloud"],
            _ionic_native_web_intent_ngx__WEBPACK_IMPORTED_MODULE_10__["WebIntent"],
        ],
        bootstrap: [_pages_main__WEBPACK_IMPORTED_MODULE_42__["Main"]]
    })
], Main);



/***/ }),

/***/ "./src/ts/pages/home.ts":
/*!******************************!*\
  !*** ./src/ts/pages/home.ts ***!
  \******************************/
/*! exports provided: Home */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Home", function() { return Home; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/api */ "./src/ts/services/api.ts");
/* harmony import */ var _services_contacts__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../services/contacts */ "./src/ts/services/contacts.ts");
/* harmony import */ var _services_layout__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../services/layout */ "./src/ts/services/layout.ts");
/* harmony import */ var _services_mails__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../services/mails */ "./src/ts/services/mails.ts");
/* harmony import */ var _services_settings__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../services/settings */ "./src/ts/services/settings.ts");
/* harmony import */ var _services_utils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../services/utils */ "./src/ts/services/utils.ts");













let Home = class Home extends _base__WEBPACK_IMPORTED_MODULE_4__["BaseComponent"] {
    constructor(_route) {
        super();
        this._route = _route;
        this._isMobile = true;
        this._messages = [];
        this._row = [''];
        this._folder = 'inbox';
        this._selection = [];
        this._message = null;
        this._spamFolder = false;
        this._userMenu = [];
        this._compose = false;
        this._composer = false;
        this._composeType = 'new';
        this._toolbarVisible = false;
        this._composeTitle = '';
        this._mobileViewType = 'list';
        this._showSettings = false;
        this._refreshing = false;
        this._contacts.add([]);
    }
    _initMe() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            console.log('init main component');
            this.showLoading();
            this._accounts$ = this._mails.accounts$;
            this._isMobile = this._layout.isMobile;
            this.connect(this._mails.currentAccount$, (account) => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
                this._account = account;
                this.hideLoading();
            }));
            this.connect(this._mails.refreshed$, () => this._refreshing = false);
            this.connect(this._api.sessionExpired$, u => {
                this.alert('Session expired', `User: ${u.email}`);
                this.navigate('settings:empty');
            });
            this.connect(this._mails.folderChanged$, f => this._folderNotify(f));
            const server = yield this._settings.getServer();
            this._userMenu = _services_utils__WEBPACK_IMPORTED_MODULE_12__["Utils"].buildUserMenu(server, this._onMenu.bind(this));
            this.connect(this._route.paramMap.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["filter"])(map => map.has('action')), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(map => map.get('action'))), (url) => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
                const p = /^(.*):(.*)$/g;
                if (!url.match(p)) {
                    return;
                }
                const action = url.replace(p, '$1');
                const param = url.replace(p, '$2');
                if (action == 'mailto') {
                    this._newMessage('new', undefined, [_models__WEBPACK_IMPORTED_MODULE_6__["ModelFactory"].instance({ Email: param }, _models__WEBPACK_IMPORTED_MODULE_6__["Contact"])]);
                }
                else if (action == 'readmail') {
                    if (!this._list) {
                        return;
                    }
                    const m = this._list.rows.find(m => m.Uid == param);
                    if (!m) {
                        return;
                    }
                    this._zone.run(() => this._messageNotify(m));
                }
                else if (action == 'settings') {
                    this._zone.run(() => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
                        if (param == 'empty') {
                            this.hideLoading();
                            this._showSettings = true;
                            this._mobileViewType = 'settings';
                            return;
                        }
                        this._showSettings = false;
                        this._mobileViewType = 'list';
                        this._router.navigateByUrl('').then(() => {
                            this.softRefresh();
                        });
                    }));
                }
            }));
        });
    }
    _folderNotify(f) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._folder = f.Id;
            this._message = null;
            this._spamFolder = this._api.isSpamFolder(f);
        });
    }
    _messageNotify(m) {
        console.log('message notify');
        this._message = m;
        this._mobileViewType = 'message';
    }
    _selectionChanged(messages) {
        this._selection = messages;
    }
    _actionIcon(which) {
        if (this._selection.length == 0 && !this._message) {
            return;
        }
        this._action(which);
    }
    _action(which) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            let row;
            if (this._message) {
                row = this._list.rows.find(r => r.Uid == this._message.Uid);
            }
            const arr = this._selection.length > 0 ? this._selection : [row || this._message];
            let err = null;
            if (which == 'mark-read' || which == 'mark-unread') {
                [err,] = yield Object(_models__WEBPACK_IMPORTED_MODULE_6__["to"])(this._api.markRead(this._account, this._folder, arr, which == 'mark-read'));
            }
            if (which == 'delete') {
                [err,] = yield Object(_models__WEBPACK_IMPORTED_MODULE_6__["to"])(this._api.moveOrDeleteMessages(this._account, this._folder, arr));
                if (!err) {
                    if (arr.indexOf(this._message) != -1) {
                        this._message = null;
                    }
                }
            }
            if (which == 'spam') {
                [err,] = yield Object(_models__WEBPACK_IMPORTED_MODULE_6__["to"])(this._api.markSpam(this._account, this._folder, arr));
            }
            if (err) {
                this.alert('Error performing the action', err.message);
            }
        });
    }
    _refresh() {
        this._refreshing = true;
        this._mails.refresh$.emit();
    }
    _changeAccount(email) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._toolbarVisible = false;
            this._account = null;
            this.showLoading();
            yield this._mails.setCurrentAccount(email.match(/,/) ? _models__WEBPACK_IMPORTED_MODULE_6__["COMBINED_ACCOUNT_ID"] : email);
            this._message = null;
            this.hideLoading();
        });
    }
    _onMenu(item) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (item.id != 'settings') {
                yield this._changeAccount(item.id);
                return;
            }
            this._showSettings = true;
        });
    }
    _newMessage(type, msg, to) {
        const title = type == 'new' ? 'Compose new message' : (['reply', 'reply-all'].indexOf(type) != -1 ? 'Reply to message' : 'Forward message');
        this._composer = true;
        this._composeType = type;
        this._composeTitle = title;
        this._composeMessage = msg;
        this._mobileViewType = 'compose';
        if (type == 'new') {
            this._composeTo = to;
        }
        setTimeout(() => {
            this.hideLoading();
            this._compose = true;
        });
    }
    _hideCompose(ev) {
        this._compose = false;
        this._composeTo = [];
        this._composeMessage = null;
        this._mobileViewType = 'list';
        setTimeout(() => this._composer = false);
        if (ev == 'sent') {
            this._refresh();
        }
    }
    _toolbarBack() {
        this._message = null;
        this._hideCompose('cancel');
        if (['', '/'].indexOf(this._router.url) == -1) {
            this.navigate('');
        }
    }
    _msgBodyNotify(ev) {
        this._newMessage(ev.type, ev.message, [ev.contact]);
    }
    _settingsClick() {
        this._mobileViewType = 'settings';
        this._toolbarVisible = false;
    }
};
Home.ctorParameters = () => [
    { type: _angular_router__WEBPACK_IMPORTED_MODULE_2__["ActivatedRoute"] }
];
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_api__WEBPACK_IMPORTED_MODULE_7__["Api"])
], Home.prototype, "_api", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_layout__WEBPACK_IMPORTED_MODULE_9__["Layout"])
], Home.prototype, "_layout", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_mails__WEBPACK_IMPORTED_MODULE_10__["Mails"])
], Home.prototype, "_mails", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_settings__WEBPACK_IMPORTED_MODULE_11__["Settings"])
], Home.prototype, "_settings", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_contacts__WEBPACK_IMPORTED_MODULE_8__["Contacts"])
], Home.prototype, "_contacts", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"])
], Home.prototype, "_zone", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewChild"])('messagesList', { static: false })
], Home.prototype, "_list", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgCycle"])('init')
], Home.prototype, "_initMe", null);
Home = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'app-home',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/home.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/home.html")).default,
        encapsulation: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewEncapsulation"].None,
        styles: [Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! ../../assets/scss/home.scss */ "./src/assets/scss/home.scss")).default]
    })
], Home);



/***/ }),

/***/ "./src/ts/pages/main.ts":
/*!******************************!*\
  !*** ./src/ts/pages/main.ts ***!
  \******************************/
/*! exports provided: Main */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Main", function() { return Main; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _ionic_native_splash_screen_ngx__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ionic-native/splash-screen/ngx */ "./node_modules/@ionic-native/splash-screen/__ivy_ngcc__/ngx/index.js");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../services/api */ "./src/ts/services/api.ts");
/* harmony import */ var _services_layout__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/layout */ "./src/ts/services/layout.ts");
/* harmony import */ var _ionic_native_web_intent_ngx__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @ionic-native/web-intent/ngx */ "./node_modules/@ionic-native/web-intent/__ivy_ngcc__/ngx/index.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");










let Main = class Main extends _base__WEBPACK_IMPORTED_MODULE_4__["BaseComponent"] {
    constructor() {
        super();
        this._mobile = true;
        this._ready = false;
        this._initializeApp();
        this.connect(this._api.ready$, result => {
            if (!result) {
                this.navigate('settings:empty');
                this._ready = true;
                return;
            }
            this._ready = true;
        });
    }
    _initializeApp() {
        this._platform.ready().then(() => {
            document.addEventListener('backbutton', ev => {
                ev.stopPropagation();
                ev.preventDefault();
                this._zone.run(() => {
                    this.navigate('');
                });
            }, false);
            this._mobile = this._layout.isMobile;
            this._splash.hide();
            if (this._platform.is('desktop')) {
                return;
            }
            this.connect(this._intent.onIntent().pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_9__["filter"])(i => i.action == this._intent.ACTION_VIEW && !!i['data'])), i => this._zone.run(() => this.navigate(i['data'])));
        });
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_ionic_angular__WEBPACK_IMPORTED_MODULE_3__["Platform"])
], Main.prototype, "_platform", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_ionic_native_splash_screen_ngx__WEBPACK_IMPORTED_MODULE_2__["SplashScreen"])
], Main.prototype, "_splash", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_layout__WEBPACK_IMPORTED_MODULE_7__["Layout"])
], Main.prototype, "_layout", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_services_api__WEBPACK_IMPORTED_MODULE_6__["Api"])
], Main.prototype, "_api", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_ionic_native_web_intent_ngx__WEBPACK_IMPORTED_MODULE_8__["WebIntent"])
], Main.prototype, "_intent", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"])
], Main.prototype, "_zone", void 0);
Main = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'main-page',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/main.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/main.html")).default,
        encapsulation: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewEncapsulation"].None,
        styles: [Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! ../../assets/scss/main.scss */ "./src/assets/scss/main.scss")).default]
    })
], Main);



/***/ }),

/***/ "./src/ts/pages/playground.ts":
/*!************************************!*\
  !*** ./src/ts/pages/playground.ts ***!
  \************************************/
/*! exports provided: Playground */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Playground", function() { return Playground; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/* harmony import */ var _services_mails__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../services/mails */ "./src/ts/services/mails.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../services/api */ "./src/ts/services/api.ts");







let Playground = class Playground extends _base__WEBPACK_IMPORTED_MODULE_2__["BaseComponent"] {
    constructor() {
        super(...arguments);
        this._message = null;
        this._body = null;
    }
    _initMe() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._contact = _models__WEBPACK_IMPORTED_MODULE_4__["ModelFactory"].instance({ Email: 'cosmin@taid.be', DisplayName: 'Cosmin Popescu' }, _models__WEBPACK_IMPORTED_MODULE_4__["Contact"]);
            this.showLoading();
            this.connect(this._mails.currentAccount$, (account) => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
                this._account = account;
                this.hideLoading();
                // this._body = await this._api.getMessageBody(this._account, '[Gmail]/Drafts', '11021');
            }));
        });
    }
    _folderNotify(f) {
        console.log('selected folder', f);
        this._folder = f.Id;
    }
    _messageNotify(m) {
        this._message = m;
        console.log('message is', m);
    }
    _msgBodyNotify(ev) {
        console.log('notified with', ev);
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_services_mails__WEBPACK_IMPORTED_MODULE_5__["Mails"])
], Playground.prototype, "_mails", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_services_api__WEBPACK_IMPORTED_MODULE_6__["Api"])
], Playground.prototype, "_api", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgCycle"])('init')
], Playground.prototype, "_initMe", null);
Playground = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'al-playground',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/playground.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/playground.html")).default
    })
], Playground);



/***/ }),

/***/ "./src/ts/pages/settings.ts":
/*!**********************************!*\
  !*** ./src/ts/pages/settings.ts ***!
  \**********************************/
/*! exports provided: Settings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Settings", function() { return Settings; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/* harmony import */ var _services_settings__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../services/settings */ "./src/ts/services/settings.ts");
/* harmony import */ var _services_store__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../services/store */ "./src/ts/services/store.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../services/api */ "./src/ts/services/api.ts");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _services_mails__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../services/mails */ "./src/ts/services/mails.ts");










let Settings = class Settings extends _base__WEBPACK_IMPORTED_MODULE_2__["BaseComponent"] {
    constructor() {
        super(...arguments);
        this._validate = false;
        this._loading = true;
        this._urlFixed = false;
    }
    _initMe() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._model = yield this._settings.appSettings;
            if (!this._model.server) {
                this._model.server = new _models__WEBPACK_IMPORTED_MODULE_4__["ServerSetting"]();
                this._model.server.users = [];
            }
        });
    }
    _setFixUrl(value) {
        this._urlFixed = value;
    }
    _remove(user) {
        this._model.server.users = this._model.server.users.filter(u => u.email != user.email);
    }
    _add() {
        this._model.server.users.push(new _models__WEBPACK_IMPORTED_MODULE_4__["UserSetting"]());
    }
    _waitApiReady() {
        return this._api.ready$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_8__["take"])(1)).toPromise();
    }
    _save() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (!this._model.server && !Array.isArray(this._model.server.users) || this._model.server.users.length == 0) {
                this.alert('You have to have at least one account', '');
                return;
            }
            const users = yield this._settings.needAuthenticating(this._model.server);
            console.log('model is', JSON.parse(JSON.stringify(this._model)), users);
            if (users.length > 0) {
                this.showLoading();
                // To be able to do anything with the API we need a server url, at least.
                // So, we set this before.
                const server = new _models__WEBPACK_IMPORTED_MODULE_4__["ServerSetting"]();
                server.url = this._model.server.url;
                server.users = [];
                yield this._settings.setServer(server);
                yield this._waitApiReady();
                const [err, result] = yield Object(_models__WEBPACK_IMPORTED_MODULE_4__["to"])(this._api.login(users));
                this._validate = true;
                this.hideLoading();
                if (err || !result) {
                    this.alert('Some accounts could not be logged in', '');
                    console.log('err is', err);
                    return;
                }
                yield this._waitApiReady();
            }
            const email = yield this._store.getCurrentAccount();
            let x = false;
            if (email != _models__WEBPACK_IMPORTED_MODULE_4__["COMBINED_ACCOUNT_ID"] && !this._model.server.users.find(u => u.email == email)) {
                x = true;
            }
            yield this._settings.saveSettings(this._model);
            if (x) {
                yield this._mails.setCurrentAccount(this._model.server.users[0].email);
                this.navigate('').then(() => window.location.reload());
                return;
            }
            yield this._mails.setCurrentAccount(null);
            this.navigate('settings:saved');
            // window.location.reload();
            // this.navigate('settings:' + op);
        });
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_services_store__WEBPACK_IMPORTED_MODULE_6__["Store"])
], Settings.prototype, "_store", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_services_api__WEBPACK_IMPORTED_MODULE_7__["Api"])
], Settings.prototype, "_api", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_services_mails__WEBPACK_IMPORTED_MODULE_9__["Mails"])
], Settings.prototype, "_mails", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_services_settings__WEBPACK_IMPORTED_MODULE_5__["Settings"])
], Settings.prototype, "_settings", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgCycle"])('init')
], Settings.prototype, "_initMe", null);
Settings = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Component"])({
        selector: 'al-settings',
        template: Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! raw-loader!../../html/settings.html */ "./node_modules/raw-loader/dist/cjs.js!./src/html/settings.html")).default,
        encapsulation: _angular_core__WEBPACK_IMPORTED_MODULE_1__["ViewEncapsulation"].None,
        styles: [Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__importDefault"])(__webpack_require__(/*! ../../assets/scss/settings.scss */ "./src/assets/scss/settings.scss")).default]
    })
], Settings);



/***/ }),

/***/ "./src/ts/pipes.ts":
/*!*************************!*\
  !*** ./src/ts/pipes.ts ***!
  \*************************/
/*! exports provided: FoldersTree, FolderLabel, AttachmentsList, MessageDate, MessageFrom, MessageFromTxt, MessageFromTxtFull, AsHtml, ContactsListTxt, ContactsArray, AvatarColor, AccountToContact, AvatarText, HumanFileSize, FileIconPipe, CurrentEmail, BorderRight, IsCombinedAccount, Count */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FoldersTree", function() { return FoldersTree; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FolderLabel", function() { return FolderLabel; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AttachmentsList", function() { return AttachmentsList; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageDate", function() { return MessageDate; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageFrom", function() { return MessageFrom; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageFromTxt", function() { return MessageFromTxt; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "MessageFromTxtFull", function() { return MessageFromTxtFull; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AsHtml", function() { return AsHtml; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContactsListTxt", function() { return ContactsListTxt; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "ContactsArray", function() { return ContactsArray; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AvatarColor", function() { return AvatarColor; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AccountToContact", function() { return AccountToContact; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "AvatarText", function() { return AvatarText; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "HumanFileSize", function() { return HumanFileSize; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FileIconPipe", function() { return FileIconPipe; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "CurrentEmail", function() { return CurrentEmail; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "BorderRight", function() { return BorderRight; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "IsCombinedAccount", function() { return IsCombinedAccount; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Count", function() { return Count; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! dateformat */ "./node_modules/dateformat/lib/dateformat.js");
/* harmony import */ var dateformat__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(dateformat__WEBPACK_IMPORTED_MODULE_2__);
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm2015/index.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./models */ "./src/ts/models.ts");
/* harmony import */ var _services_api__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./services/api */ "./src/ts/services/api.ts");
/* harmony import */ var _services_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./services/utils */ "./src/ts/services/utils.ts");
/* harmony import */ var _angular_platform_browser__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @angular/platform-browser */ "./node_modules/@angular/platform-browser/__ivy_ngcc__/fesm2015/platform-browser.js");
/* harmony import */ var _services_mails__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./services/mails */ "./src/ts/services/mails.ts");












let FoldersTree = class FoldersTree extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(folders) {
        if (!folders || !Array.isArray(folders)) {
            return [];
        }
        return folders.map(f => ({
            label: f.Unread > 0 ? `${f.Name} (${f.Unread})` : f.Name,
            children: this.transform(f.SubFolders),
            data: f,
            selectable: f.SubFolders.length == 0,
        }));
    }
};
FoldersTree = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'foldersTree' })
], FoldersTree);

let FolderLabel = class FolderLabel extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    _label(f) {
        return f.Unread > 0 ? `${f.Name} (${f.Unread})` : f.Name;
    }
    transform(folder) {
        return Object(rxjs__WEBPACK_IMPORTED_MODULE_3__["merge"])(Object(rxjs__WEBPACK_IMPORTED_MODULE_3__["of"])(this._label(folder)), this._api.folderUpdated$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["filter"])(f => f.Id == folder.Id))).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["map"])(result => {
            if (typeof (result) == 'string') {
                return result;
            }
            return this._label(result);
        }));
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_6__["NgInject"])(_services_api__WEBPACK_IMPORTED_MODULE_8__["Api"])
], FolderLabel.prototype, "_api", void 0);
FolderLabel = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'folderLabel' })
], FolderLabel);

let AttachmentsList = class AttachmentsList extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(m) {
        return _services_utils__WEBPACK_IMPORTED_MODULE_9__["Utils"].extractCollection(m.Attachments);
    }
};
AttachmentsList = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'attachmentsList' })
], AttachmentsList);

let MessageDate = class MessageDate extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    _sameDay(d1, d2) {
        return d1.getFullYear() == d2.getFullYear() && d1.getMonth() == d2.getMonth() && d1.getDate() == d2.getDate();
    }
    transform(message) {
        const d1 = new Date();
        const d2 = new Date(message.TimeStampInUTC * 1000);
        if (this._sameDay(d1, d2)) {
            return dateformat__WEBPACK_IMPORTED_MODULE_2__(d2, 'hh:MM');
        }
        const d3 = new Date(d2.getTime() + 24 * 60 * 60 * 1000);
        if (this._sameDay(d1, d3)) {
            return 'Yesterday, ' + dateformat__WEBPACK_IMPORTED_MODULE_2__(d2, 'hh:MM');
        }
        if (d1.getTime() - d2.getTime() <= 15 * 24 * 60 * 60 * 1000) {
            return dateformat__WEBPACK_IMPORTED_MODULE_2__(d2, 'mmm dd');
        }
        return dateformat__WEBPACK_IMPORTED_MODULE_2__(d2, 'mmm dd, yyyy');
    }
};
MessageDate = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'messageDate' })
], MessageDate);

let MessageFrom = class MessageFrom extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(msg) {
        if (!msg.From && msg.From.Count < 1) {
            return null;
        }
        return msg.From.Collection[0];
    }
};
MessageFrom = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'messageFrom' })
], MessageFrom);

let MessageFromTxt = class MessageFromTxt extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(c) {
        return c.DisplayName || c.Email;
    }
};
MessageFromTxt = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'messageFromTxt' })
], MessageFromTxt);

let MessageFromTxtFull = class MessageFromTxtFull extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(c) {
        const toSpan = (x) => `<span style="color: blue">${x}</span>`;
        return c.DisplayName ? `${c.DisplayName} (${toSpan(c.Email)})` : toSpan(c.Email);
    }
};
MessageFromTxtFull = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'messageFromTxtFull' })
], MessageFromTxtFull);

let AsHtml = class AsHtml extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(html) {
        return this._sanitizer.bypassSecurityTrustHtml(html);
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_6__["NgInject"])(_angular_platform_browser__WEBPACK_IMPORTED_MODULE_10__["DomSanitizer"])
], AsHtml.prototype, "_sanitizer", void 0);
AsHtml = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'asHtml' })
], AsHtml);

let ContactsListTxt = class ContactsListTxt extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(c) {
        const collection = _services_utils__WEBPACK_IMPORTED_MODULE_9__["Utils"].extractCollection(c);
        if (collection.length == 0) {
            return '';
        }
        const pipe = new MessageFromTxtFull();
        return collection
            .map(c => pipe.transform(c))
            .reduce((acc, v) => acc + (acc == '' ? '' : ', ') + v, '');
    }
};
ContactsListTxt = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'contactsListTxt' })
], ContactsListTxt);

let ContactsArray = class ContactsArray extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(c) {
        return _services_utils__WEBPACK_IMPORTED_MODULE_9__["Utils"].extractCollection(c);
    }
};
ContactsArray = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'contactsArray' })
], ContactsArray);

let AvatarColor = class AvatarColor extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(c) {
        return _services_utils__WEBPACK_IMPORTED_MODULE_9__["Utils"].avatarColor(c);
    }
};
AvatarColor = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'avatarColor' })
], AvatarColor);

let AccountToContact = class AccountToContact extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(a) {
        return _models__WEBPACK_IMPORTED_MODULE_7__["ModelFactory"].instance({ Email: a.Email, DisplayName: a.FriendlyName }, _models__WEBPACK_IMPORTED_MODULE_7__["Contact"]);
    }
};
AccountToContact = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'accountToContact' })
], AccountToContact);

let AvatarText = class AvatarText extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(c) {
        const x = c.DisplayName || c.Email;
        return x.substr(0, 1).toUpperCase();
    }
};
AvatarText = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'avatarText' })
], AvatarText);

let HumanFileSize = class HumanFileSize extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(size) {
        const i = Math.floor(Math.log(size) / Math.log(1024));
        return (size / Math.pow(1024, i)).toFixed(2) + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];
    }
};
HumanFileSize = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'humanFileSize' })
], HumanFileSize);

let FileIconPipe = class FileIconPipe extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(a) {
        if (a.MimeType.match(/pdf/i)) {
            return "file-pdf-o";
        }
        if (a.MimeType.match(/text|txt/i)) {
            return 'file-text-o';
        }
        if (a.MimeType.match(/excel/i)) {
            return 'file-excel-o';
        }
        if (a.MimeType.match(/word/i)) {
            return 'file-word-o';
        }
        if (a.MimeType.match(/gif|jpg|jpeg|png|bmp/i)) {
            return 'file-image-o';
        }
        return 'file-o';
    }
};
FileIconPipe = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'fileIcon' })
], FileIconPipe);

let CurrentEmail = class CurrentEmail extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(a) {
        if (!a) {
            return '';
        }
        return a.FriendlyName ? `${a.FriendlyName} (${a.Email})` : a.Email;
    }
};
CurrentEmail = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'currentEmail' })
], CurrentEmail);

let BorderRight = class BorderRight extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(msg) {
        return this._service.currentAccount$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["map"])(account => {
            if (account.AccountID != _models__WEBPACK_IMPORTED_MODULE_7__["COMBINED_ACCOUNT_ID"]) {
                return {};
            }
            ;
            const a = this._service.accountById(msg.AccountID);
            if (!a) {
                return {};
            }
            const pipe = new AccountToContact();
            return { borderRight: `10px solid ${_services_utils__WEBPACK_IMPORTED_MODULE_9__["Utils"].avatarColor(pipe.transform(a))}` };
        }));
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_6__["NgInject"])(_services_mails__WEBPACK_IMPORTED_MODULE_11__["Mails"])
], BorderRight.prototype, "_service", void 0);
BorderRight = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'borderRight' })
], BorderRight);

let IsCombinedAccount = class IsCombinedAccount extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(a) {
        return a.AccountID == _models__WEBPACK_IMPORTED_MODULE_7__["COMBINED_ACCOUNT_ID"];
    }
};
IsCombinedAccount = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'isCombinedAccount' })
], IsCombinedAccount);

let Count = class Count extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    transform(a) {
        if (!Array.isArray(a)) {
            return 0;
        }
        ;
        return a.length;
    }
};
Count = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Pipe"])({ name: 'count' })
], Count);



/***/ }),

/***/ "./src/ts/routing.ts":
/*!***************************!*\
  !*** ./src/ts/routing.ts ***!
  \***************************/
/*! exports provided: routes */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "routes", function() { return routes; });
/* harmony import */ var _pages_home__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./pages/home */ "./src/ts/pages/home.ts");
/* harmony import */ var _pages_playground__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./pages/playground */ "./src/ts/pages/playground.ts");


const routes = [
    { path: 'playground', component: _pages_playground__WEBPACK_IMPORTED_MODULE_1__["Playground"], data: { withToolbar: true } },
    { path: ':action', component: _pages_home__WEBPACK_IMPORTED_MODULE_0__["Home"], data: { withToolbar: true } },
    { path: '', component: _pages_home__WEBPACK_IMPORTED_MODULE_0__["Home"], data: { withToolbar: true } },
];


/***/ }),

/***/ "./src/ts/services/api.ts":
/*!********************************!*\
  !*** ./src/ts/services/api.ts ***!
  \********************************/
/*! exports provided: Api */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Api", function() { return Api; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @capacitor/core */ "./node_modules/@capacitor/core/dist/esm/index.js");
/* harmony import */ var _ionic_native_http_ngx__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @ionic-native/http/ngx */ "./node_modules/@ionic-native/http/__ivy_ngcc__/ngx/index.js");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm2015/index.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./settings */ "./src/ts/services/settings.ts");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./utils */ "./src/ts/services/utils.ts");












const { Filesystem } = _capacitor_core__WEBPACK_IMPORTED_MODULE_2__["Plugins"];
let Api = class Api extends _base__WEBPACK_IMPORTED_MODULE_7__["BaseClass"] {
    constructor() {
        super();
        this.ready$ = new rxjs__WEBPACK_IMPORTED_MODULE_5__["ReplaySubject"](1);
        this.lastSearchResults = 0;
        this.folderUpdated$ = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.messagesDeleted$ = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.messagesMoved$ = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.messagesUpdated$ = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.sessionExpired$ = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this._ready = false;
        this._url = null;
        this._accounts = [];
        this._init();
        this._settings.serverSet$.subscribe(() => this._init());
    }
    _init() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._server = yield this._settings.getServer();
            if (!!this._server) {
                this._url = `${this._server.url}?/Api/`;
                this._ready = true;
                this.ready$.next(true);
                return;
            }
            this._ready = false;
            this.ready$.next(false);
        });
    }
    _checkReady() {
        if (!this._ready) {
            throw new Error('API_NOT_READY');
        }
    }
    _passRequest(token, module, method, parameters, type, file) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._checkReady();
            let data;
            const headers = { 'Content-Type': 'application/x-www-form-urlencoded' };
            if (token) {
                headers['Authorization'] = `Bearer ${token}`;
            }
            if (!file) {
                data = this._platform.is('desktop') ?
                    `Module=${module}&Method=${method}&Parameters=${encodeURIComponent(JSON.stringify(parameters))}`
                    : { Module: module, Method: method, Parameters: JSON.stringify(parameters) };
            }
            else {
                data = new FormData();
                data.append('Module', module);
                data.append('Method', method);
                data.append('jua-post-type', 'ajax');
                data.append('Parameters', JSON.stringify(parameters));
                data.append('jua-uploader', file.content);
                delete headers['Content-Type'];
            }
            let json;
            if (this._platform.is('desktop') || file) {
                const result = yield fetch(this._url, {
                    method: 'POST',
                    body: data,
                    headers: headers,
                });
                json = yield result.json();
            }
            else {
                console.log('posting request', data, headers);
                const result = yield this._http.sendRequest(this._url, {
                    method: 'post', data: data, headers: headers, responseType: 'json',
                });
                json = result.data;
            }
            const response = _models__WEBPACK_IMPORTED_MODULE_9__["ModelFactory"].instance(json, _models__WEBPACK_IMPORTED_MODULE_9__["HttpResponse"]);
            if (typeof (response.ErrorCode) != 'undefined' && response.ErrorCode != null) {
                throw Error(`${[102, 108].indexOf(response.ErrorCode) != -1 ? 'AUTH_ERROR' : 'HTTP_ERROR'} ${response.ErrorMessage || response.ErrorCode}`);
            }
            return _models__WEBPACK_IMPORTED_MODULE_9__["ModelFactory"].instance(response.Result, type);
        });
    }
    _login(u) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const result = yield this._passRequest(null, 'Core', 'Login', { Login: u.email, Password: u.pass, SignMe: false }, _models__WEBPACK_IMPORTED_MODULE_9__["Authentication"]);
            if (!result || !result.AuthToken) {
                return false;
            }
            u.token = result.AuthToken;
            return true;
        });
    }
    login(users) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const p = [];
            users.forEach(u => p.push(this._login(u)));
            const results = yield Promise.all(p);
            return results.filter(r => !r).length == 0;
        });
    }
    _handleUserExpired(u) {
        this.sessionExpired$.emit(u);
        console.log('user expired', u);
        throw Error('USER_EXPIRED');
    }
    _request(email, module, method, parameters, type, file) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const u = this._userByEmail(email);
            if (!u) {
                throw {
                    message: 'Could not find user for request',
                    user: email,
                    method: method,
                    parameters: parameters,
                    type: type,
                    file: file,
                };
            }
            if (!u.token) {
                this._handleUserExpired(u);
                return null;
            }
            const [err, result] = yield Object(_models__WEBPACK_IMPORTED_MODULE_9__["to"])(this._passRequest(u.token, module, method, parameters, type, file));
            if (err) {
                if (err.message.match(/^AUTH_ERROR/)) {
                    this._handleUserExpired(u);
                    return;
                }
                throw err;
            }
            return result;
        });
    }
    _userByEmail(email) {
        this._checkReady();
        return this._server.users.find(u => u.email == email);
    }
    // Patched
    getAccounts() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            let p = [];
            this._server.users.forEach(u => p.push(this._request(u.email, 'Mail', 'GetAccounts', null, _models__WEBPACK_IMPORTED_MODULE_9__["Account"])));
            const accounts = yield Promise.all(p);
            const result = accounts.reduce((acc, v) => acc.concat(v), []);
            this._accounts = result;
            result.forEach((a) => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
                a.Folders$ = new rxjs__WEBPACK_IMPORTED_MODULE_5__["ReplaySubject"](1);
                const u = this._userByEmail(a.Email);
                if (!u) {
                    a.Folders$.next([]);
                    return;
                }
                const list = [];
                _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].foldersFlatList(a.FoldersOrder, list);
                yield this._setFoldersTypes(a, a.FoldersOrder);
                list.forEach(l => l.AccountID = a.AccountID);
                a.Folders$.next(a.FoldersOrder);
            }));
            const r = result.reduce((acc, v) => acc.concat(v), []);
            if (accounts.length > 1) {
                const a = new _models__WEBPACK_IMPORTED_MODULE_9__["Account"]();
                a.Email = accounts.reduce((acc, v) => acc.concat(v), []).map(a => a.Email).join(",");
                a.AccountID = _models__WEBPACK_IMPORTED_MODULE_9__["COMBINED_ACCOUNT_ID"];
                a.FriendlyName = 'Composed view';
                a.FoldersOrder = [
                    { AccountID: a.AccountID, SubFolders: [], Type: _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Inbox, Name: 'Inbox', Id: _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Inbox.toString() },
                    { AccountID: a.AccountID, SubFolders: [], Type: _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Sent, Name: 'Sent mails', Id: _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Sent.toString() },
                    { AccountID: a.AccountID, SubFolders: [], Type: _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Drafts, Name: 'Drafts', Id: _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Drafts.toString() },
                    { AccountID: a.AccountID, SubFolders: [], Type: _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Spam, Name: 'Spam', Id: _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Spam.toString() },
                    { AccountID: a.AccountID, SubFolders: [], Type: _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Trash, Name: 'Trash', Id: _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Trash.toString() },
                ];
                a.TypesSet = true;
                a.Folders$.next(a.FoldersOrder);
                r.push(a);
            }
            return r;
        });
    }
    // Patched
    getFoldersInfo(account, list, auto) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (account.AccountID != _models__WEBPACK_IMPORTED_MODULE_9__["COMBINED_ACCOUNT_ID"]) {
                return this._request(account.Email, 'Mail', 'GetRelevantFoldersInformation', { AccountID: account.AccountID, Folders: list.map(x => x.Id) }, _models__WEBPACK_IMPORTED_MODULE_9__["FoldersInfoResult"], undefined);
            }
            const p = [];
            account.Email.split(',').forEach(e => {
                const a = this._accounts.find(a => a.Email.toLowerCase() == e.toLowerCase());
                if (!a) {
                    return;
                }
                const list = [];
                _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].foldersFlatList(a.FoldersOrder, list);
                p.push(this.getFoldersInfo(a, list, auto));
            });
            const result = yield Promise.all(p);
            return result;
        });
    }
    _combinedFoldersResult(account, result) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            account.FoldersOrder.forEach(f => {
                f.Count = 0;
                f.Unread = 0;
                account.Email.split(",").forEach((e, idx) => {
                    const a = this._accounts.find(a => a.Email == e);
                    if (!a) {
                        return;
                    }
                    const _f = _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].folderByType(f.Type, a.FoldersOrder);
                    f.Count += result[idx].Counts[_f.Id][0];
                    f.Unread += result[idx].Counts[_f.Id][1];
                });
                this.folderUpdated$.emit(f);
            });
        });
    }
    _processMessages(account, msgs) {
        msgs.Collection.forEach(m => m.AccountID = account.AccountID);
        return msgs;
    }
    _waitFoldersLoaded() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const p = [];
            this._accounts.forEach(a => p.push(a.Folders$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_6__["take"])(1)).toPromise()));
            yield Promise.all(p);
        });
    }
    // Patched
    _getMessages(account, folder, offset, pageSize, search, filters, withThreads, auto, lastUid) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (account.AccountID != _models__WEBPACK_IMPORTED_MODULE_9__["COMBINED_ACCOUNT_ID"]) {
                const params = {
                    AccountID: account.AccountID, Folder: folder, Offset: offset,
                    Limit: pageSize, Search: search, Filters: filters, UseThreading: withThreads
                };
                if (lastUid) {
                    params['InboxUixnext'] = lastUid;
                }
                return this._request(account.Email, 'Mail', 'GetMessages', params, _models__WEBPACK_IMPORTED_MODULE_9__["Messages"], undefined).then(msgs => this._processMessages(account, msgs));
            }
            yield this._waitFoldersLoaded();
            const _folder = account.FoldersOrder.find(f => f.Id == folder);
            if (!_folder) {
                return _models__WEBPACK_IMPORTED_MODULE_9__["ModelFactory"].instance({
                    Filters: filters, Search: search, Limit: pageSize, Offset: offset, Count: 0,
                    Collection: [], MessageResultCount: 0, Uids: [], MessageCount: 0, MessageUnseenCount: 0,
                    FolderName: _folder.Name,
                }, _models__WEBPACK_IMPORTED_MODULE_9__["Messages"]);
            }
            const p = [];
            account.Email.split(',').forEach(e => {
                const a = this._accounts.find(a => a.Email == e);
                if (!a) {
                    return;
                }
                const f = _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].folderByType(_folder.Type, a.FoldersOrder);
                const result = this._getMessages(a, f.Id, offset, pageSize, search, filters, withThreads, auto, lastUid).then(msgs => this._processMessages(a, msgs));
                p.push(result);
            });
            const result = yield Promise.all(p);
            return result
                .reduce((acc, v) => {
                if (!acc) {
                    return v;
                }
                acc.MessageResultCount += v.MessageResultCount;
                acc.Count += v.Count;
                acc.Collection = acc.Collection.concat(v.Collection);
                return acc;
            }, null);
        });
    }
    getMessages(account, folder, offset, pageSize, search = '', filters = '', auto = false, lastUid = null) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (pageSize != 1)
                account.Folders$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_6__["take"])(1)).subscribe((folders) => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
                    const list = [];
                    _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].foldersFlatList(folders, list);
                    const result = yield this.getFoldersInfo(account, list, auto);
                    if (Array.isArray(result)) {
                        yield this._combinedFoldersResult(account, result);
                        return;
                    }
                    Object.keys(result.Counts).forEach(k => {
                        const f = list.find(l => l.Id == k);
                        if (!f) {
                            return;
                        }
                        f.Count = result.Counts[k][0];
                        f.Unread = result.Counts[k][1];
                        this.folderUpdated$.emit(f);
                    });
                }));
            const result = yield this._getMessages(account, folder, offset, pageSize, search, filters, false, auto, lastUid);
            this.lastSearchResults = result.MessageResultCount;
            this.messagesUpdated$.emit(result.Collection);
            return result.Collection;
        });
    }
    // Patched
    getMessageBody(account, msg) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const id = msg.AccountID ? msg.AccountID : account.AccountID;
            const a = this._accounts.find(a => a.AccountID == id);
            if (!a) {
                return null;
            }
            const result = yield this._request(a.Email, 'Mail', 'GetMessagesBodies', { AccountID: a.AccountID, Folder: msg.Folder, Uids: [msg.Uid] }, _models__WEBPACK_IMPORTED_MODULE_9__["MessageBody"]);
            if (!Array.isArray(result) || result.length != 1) {
                return null;
            }
            result[0].AccountID = id;
            // const draft = await this._getFolder(FolderType.Drafts, account);
            // result[0].IsDraft = folder == draft.Id;
            return result[0];
        });
    }
    // For a combined folder, when we perform an operation on a collection of messages, 
    // we need to separate each message and each account and each folder
    _getPayloadInfos(account, folder, msgs) {
        const result = [];
        // Get the original folder if it is a special folder.
        const _folder = _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].isCombinedFolder(folder) ? _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].folderById(account.FoldersOrder, folder) : null;
        Array.from(new Set(msgs.map(m => m.AccountID))).forEach((accountId) => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const a = this._accounts.find(a => a.AccountID == accountId);
            if (!a) {
                return;
            }
            // Search the folder of the given type inside the original account
            const f = _folder == null ? { Id: folder } : _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].folderByType(_folder.Type, a.FoldersOrder);
            result.push({ account: a, folder: f.Id, msgs: msgs.filter(m => m.AccountID == a.AccountID) });
        }));
        return result;
    }
    _executeCombinedAccount(account, folder, msgs, operation) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const promises = [];
            // Get the original folder if it is a special folder.
            this._getPayloadInfos(account, folder, msgs).forEach(p => {
                promises.push(operation(p.account, p.folder, p.msgs));
            });
            return Promise.all(promises);
        });
    }
    // Patched
    _doFlag(flag, account, folder, msgs, action) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (account.AccountID != _models__WEBPACK_IMPORTED_MODULE_9__["COMBINED_ACCOUNT_ID"]) {
                yield this._request(account.Email, 'Mail', flag, { AccountID: account.AccountID, Folder: folder, Uids: msgs.map(m => m.Uid).join(","), SetAction: action });
                return;
            }
            const callback = (account, folder, msgs) => {
                return this._doFlag(flag, account, folder, msgs, action);
            };
            yield this._executeCombinedAccount(account, folder, msgs, callback.bind(this));
        });
    }
    // Patched
    markRead(account, folder, messages, action) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            yield this._doFlag('SetMessagesSeen', account, folder, messages, action);
            account.Folders$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_6__["take"])(1), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_6__["map"])(folders => _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].folderById(folders, folder)), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_6__["filter"])(f => !!f)).subscribe(folder => {
                const factor = action ? -1 : 1;
                folder.Unread += factor * messages.length;
                folder.Count -= factor * messages.length;
                this.folderUpdated$.emit(folder);
            });
            messages.forEach(m => m.IsSeen = action);
        });
    }
    // Patched
    flag(account, folder, messages, action) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            yield this._doFlag('SetMessageFlagged', account, folder, messages, action);
            messages.forEach(m => m.IsFlagged = action);
        });
    }
    _doDeleteMessages(account, folder, messages) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (account.AccountID != _models__WEBPACK_IMPORTED_MODULE_9__["COMBINED_ACCOUNT_ID"]) {
                return this._request(account.Email, 'Mail', 'DeleteMessages', { AccountID: account.AccountID, Folder: folder, Uids: messages.map(m => m.Uid).join(",") });
            }
            const callback = (account, folder, msgs) => {
                return this._doDeleteMessages(account, folder, msgs);
            };
            return this._executeCombinedAccount(account, folder, messages, callback.bind(this));
        });
    }
    _doMoveMessages(account, folder, toFolder, messages) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (account.AccountID != _models__WEBPACK_IMPORTED_MODULE_9__["COMBINED_ACCOUNT_ID"]) {
                const params = { AccountID: account.AccountID, Folder: folder, ToFolder: toFolder, Uids: messages.map(m => m.Uid).join(',') };
                yield this._request(account.Email, 'Mail', 'MoveMessages', params);
                return;
            }
            const callback = (account, toFolder, msgs) => {
                if (!Array.isArray(msgs) || msgs.length == 0) {
                    return;
                }
                const x = msgs[0].Folder;
                const folder = _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].isCombinedFolder(x) ? _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].folderByType(x, account.FoldersOrder).Id : x;
                return this._doMoveMessages(account, folder, toFolder, msgs);
            };
            return this._executeCombinedAccount(account, toFolder, messages, callback);
        });
    }
    // Patched
    deleteMessages(account, folder, messages) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            yield this._doDeleteMessages(account, folder, messages);
            this.messagesDeleted$.emit(messages);
        });
    }
    // Patched
    moveMessages(account, folder, toFolder, messages) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            yield this._doMoveMessages(account, folder, toFolder, messages);
            this.messagesMoved$.emit(messages);
        });
    }
    // Patched
    downloadUrl(account, url, fileName, where, msg) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._checkReady();
            if (msg) {
                account = this._accounts.find(a => a.AccountID == msg.AccountID);
            }
            if (!account) {
                throw { message: "ACCOUNT_NOT_FOUND", msg: msg };
            }
            const fileData = yield this.getAttachmentContent(account, url);
            if (this._platform.is('desktop')) {
                const buf = yield fileData.arrayBuffer();
                const blob = new Blob([buf], { type: 'application/octet-stream' });
                const a = document.createElement('a');
                a.download = fileName;
                const url = URL.createObjectURL(blob);
                a.href = url;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                return null;
            }
            const content = yield new Promise((resolve, reject) => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
                const reader = new FileReader();
                reader.onloadend = () => {
                    resolve(reader.result);
                };
                reader.onerror = () => reject(reader.error);
                reader.readAsBinaryString(fileData);
            }));
            const result = yield Filesystem.writeFile({
                path: fileName,
                data: btoa(content),
                directory: where,
            });
            return result;
        });
    }
    getAttachmentContent(account, url) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._checkReady();
            const user = this._userByEmail(account.Email);
            const data = yield fetch(url, { headers: { Authorization: `Bearer ${user.token}` } });
            return data.blob();
        });
    }
    // Patched
    downloadAttachment(account, att, fileName, where, msg) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._checkReady();
            if (!att.Actions || !att.Actions.download) {
                return null;
            }
            return this.downloadUrl(account, `${this._server.url}/${att.Actions.download}`, fileName, where, msg);
        });
    }
    // Patched
    uploadAttachment(account, file) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            return this._request(account.Email, 'Mail', 'UploadAttachment', { AccountID: account.AccountID }, _models__WEBPACK_IMPORTED_MODULE_9__["UploadResult"], file);
        });
    }
    uploadData(account, data) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            return this._request(account.Email, 'Mail', 'UploadAttachment', { AccountID: account.AccountID }, _models__WEBPACK_IMPORTED_MODULE_9__["UploadResult"], data);
        });
    }
    _setFoldersTypes(account, folders) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const result = yield this._request(account.Email, 'Mail', 'GetFolders', { AccountID: account.AccountID }, Object);
            _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].setFolderTypes(result['Folders']['@Collection'], folders);
            account.TypesSet = true;
        });
    }
    _getFolders(account) {
        return new Promise(resolve => account.Folders$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_6__["take"])(1)).subscribe(folders => resolve(folders)));
    }
    folderByType(type, account) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const folders = yield this._getFolders(account);
            if (!account.TypesSet) {
                yield this._setFoldersTypes(account, folders);
            }
            return _utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].folderByType(type, folders);
        });
    }
    isSpamFolder(f) {
        return f.Type == _models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Spam;
    }
    // Patched
    saveMessage(account, msg) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const draft = yield this.folderByType(_models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Drafts, account);
            const params = msg;
            params['AccountID'] = account.AccountID;
            params['DraftFolder'] = draft.Id;
            return this._request(account.Email, 'Mail', 'SaveMessage', params, _models__WEBPACK_IMPORTED_MODULE_9__["SaveMessageResponse"]);
        });
    }
    // Patched
    sendMessage(account, msg) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const sent = yield this.folderByType(_models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Sent, account);
            const draft = yield this.folderByType(_models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Drafts, account);
            const params = msg;
            params['AccountID'] = account.AccountID;
            params['DraftFolder'] = draft.Id;
            params['SentFolder'] = sent.Id;
            return this._request(account.Email, 'Mail', 'SendMessage', params);
        });
    }
    // Patched
    reloadAttachments(account, attachments) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (!Array.isArray(attachments) || attachments.length == 0) {
                return;
            }
            const result = yield this._request(account.Email, 'Mail', 'SaveAttachmentsAsTempFiles', { Attachments: attachments.map(a => a.Hash), AccountID: account.AccountID }, Object);
            Object.keys(result).forEach(k => {
                const a = attachments.find(a => a.Hash == result[k]);
                if (!a) {
                    return;
                }
                a.TempName = k;
            });
        });
    }
    // Patched
    getOriginalDraftReply(account, msg) {
        const m = _models__WEBPACK_IMPORTED_MODULE_9__["ModelFactory"].instance({ Uid: msg.DraftInfo[1], Folder: msg.DraftInfo[2] }, _models__WEBPACK_IMPORTED_MODULE_9__["Message"]);
        return this.getMessageBody(account, m);
    }
    // Patched
    moveOrDeleteMessages(account, folder, messages) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const trash = yield this.folderByType(_models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Trash, account);
            if (trash.Id == folder) {
                yield this.deleteMessages(account, folder, messages);
            }
            else {
                yield this.moveMessages(account, folder, trash.Id, messages);
            }
        });
    }
    // Patched
    markSpam(account, folder, messages) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const spam = yield this.folderByType(_models__WEBPACK_IMPORTED_MODULE_9__["FolderType"].Spam, account);
            const to = spam.Id == folder ? 'inbox' : spam.Id;
            yield this.moveMessages(account, folder, to, messages);
        });
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_8__["NgInject"])(_settings__WEBPACK_IMPORTED_MODULE_10__["Settings"])
], Api.prototype, "_settings", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_8__["NgInject"])(_ionic_angular__WEBPACK_IMPORTED_MODULE_4__["Platform"])
], Api.prototype, "_platform", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_8__["NgInject"])(_ionic_native_http_ngx__WEBPACK_IMPORTED_MODULE_3__["HTTP"])
], Api.prototype, "_http", void 0);
Api = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
], Api);



/***/ }),

/***/ "./src/ts/services/background.ts":
/*!***************************************!*\
  !*** ./src/ts/services/background.ts ***!
  \***************************************/
/*! exports provided: Background */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Background", function() { return Background; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm2015/index.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _settings__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./settings */ "./src/ts/services/settings.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");









const MAX_BACKGROUND_RETRIES = 3;
const MAX_INTERVAL = 60 * 1000 * 15;
let Background = class Background extends _base__WEBPACK_IMPORTED_MODULE_2__["BaseClass"] {
    constructor() {
        super();
        this._errors = 0;
        this._checkInterval = null;
    }
    configure(callback) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._callback = callback;
            this._checkInterval = yield this._settings.getCheckoutEmailInterval();
            if (this._checkInterval == 0) {
                return;
            }
            if (this._platform.is('desktop')) {
                this._startMailsCheck();
                return;
            }
            this._backgroundTimer = window['BackgroundTimer'];
            console.log('background timer is', this._backgroundTimer);
            if (!this._backgroundTimer) {
                return;
            }
            this._backgroundTimer.onTimerEvent(this._backgroundRun.bind(this));
            const obs = Object(rxjs__WEBPACK_IMPORTED_MODULE_5__["merge"])(this._platform.pause.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_6__["map"])(() => 'pause')), this._platform.resume.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_6__["map"])(() => 'resume')));
            obs.subscribe((ev) => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
                if (ev == 'resume') {
                    console.log('stopping the interval');
                    this._stopBackgroundTimer();
                    // this._zone.run(() => this._loadMessages({first: this._table.first}));
                    if (this._errors >= MAX_BACKGROUND_RETRIES) {
                        this._checkInterval = yield this._settings.getCheckoutEmailInterval();
                    }
                }
                if (ev == 'pause') {
                    this._startBackgroundTimer();
                }
            }));
        });
    }
    _startBackgroundTimer() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._stopBackgroundTimer();
            console.log('starting the interval');
            this._backgroundTimer.start(this._backgroundSuccess.bind(this), this._backgroundFailure.bind(this), {
                timerInterval: this._checkInterval,
                startOnBoot: false,
                stopOnTerminate: true,
            });
        });
    }
    _backgroundSuccess() {
        console.log('executed background thing successfully');
    }
    _backgroundFailure(e) {
        console.log('error with background timer', e);
    }
    _stopBackgroundTimer() {
        this._backgroundTimer.stop(this._backgroundSuccess.bind(this), this._backgroundFailure.bind(this));
    }
    _backgroundRun() {
        return new Promise(resolve => {
            this._zone.run(() => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
                yield this._run();
                resolve();
            }));
        });
    }
    _run() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const [err] = yield Object(_models__WEBPACK_IMPORTED_MODULE_8__["to"])(this._callback());
            console.log('err is', err);
            if (err && ++this._errors >= MAX_BACKGROUND_RETRIES && this._checkInterval < MAX_INTERVAL) {
                console.log('setting the interval to max, due to 3 errors in a row', err);
                this._checkInterval = MAX_INTERVAL;
                this._startBackgroundTimer();
                console.log('set done');
                return;
            }
            if (err) {
                console.log('no action taken due to error', err);
                return;
            }
            else if (this._errors >= MAX_BACKGROUND_RETRIES) {
                this._checkInterval = yield this._settings.getCheckoutEmailInterval();
                console.log('setting the interval back to', this._checkInterval, 'due to no error now');
                this._startBackgroundTimer();
                console.log('set done');
            }
            this._errors = 0;
        });
    }
    _startMailsCheck() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            Object(rxjs__WEBPACK_IMPORTED_MODULE_5__["interval"])(this._checkInterval).subscribe(() => this._callback());
        });
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_angular_core__WEBPACK_IMPORTED_MODULE_1__["NgZone"])
], Background.prototype, "_zone", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_ionic_angular__WEBPACK_IMPORTED_MODULE_4__["Platform"])
], Background.prototype, "_platform", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_settings__WEBPACK_IMPORTED_MODULE_7__["Settings"])
], Background.prototype, "_settings", void 0);
Background = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
], Background);



/***/ }),

/***/ "./src/ts/services/contacts.ts":
/*!*************************************!*\
  !*** ./src/ts/services/contacts.ts ***!
  \*************************************/
/*! exports provided: Contacts */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Contacts", function() { return Contacts; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./store */ "./src/ts/services/store.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/* harmony import */ var _api__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./api */ "./src/ts/services/api.ts");







const CONTACTS_KEY = 'contacts';
let Contacts = class Contacts extends _base__WEBPACK_IMPORTED_MODULE_2__["BaseClass"] {
    constructor() {
        super();
        this.contacts = [];
        this._init();
    }
    _getCollection(a) {
        if (!a || !Array.isArray(a.Collection)) {
            return [];
        }
        return a.Collection;
    }
    _init() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this.contacts = (yield this._store.load(CONTACTS_KEY, _models__WEBPACK_IMPORTED_MODULE_5__["Contact"], []));
            this._api.messagesUpdated$.subscribe((messages) => {
                const list = messages.map(m => this._getCollection(m.From)
                    .concat(this._getCollection(m.To))
                    .concat(this._getCollection(m.Bcc))
                    .concat(this._getCollection(m.Cc)))
                    .reduce((acc, v) => acc.concat(v), []);
                this.add(list);
            });
        });
    }
    add(what) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            (Array.isArray(what) ? what : [what])
                .forEach(c => {
                if (this.contacts.map(c => c.Email).indexOf(c.Email) == -1) {
                    this.contacts.push(c);
                    return;
                }
                const contact = this.contacts.find(_c => _c.Email == c.Email);
                contact.DisplayName = c.DisplayName;
            });
            yield this._store.save(CONTACTS_KEY, this.contacts);
        });
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_store__WEBPACK_IMPORTED_MODULE_4__["Store"])
], Contacts.prototype, "_store", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_api__WEBPACK_IMPORTED_MODULE_6__["Api"])
], Contacts.prototype, "_api", void 0);
Contacts = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
], Contacts);



/***/ }),

/***/ "./src/ts/services/file.ts":
/*!*********************************!*\
  !*** ./src/ts/services/file.ts ***!
  \*********************************/
/*! exports provided: FileService */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FileService", function() { return FileService; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm2015/index.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");






let FileService = class FileService extends _base__WEBPACK_IMPORTED_MODULE_4__["BaseClass"] {
    constructor() {
        super(...arguments);
        this._callback = null;
    }
    read(f) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const reader = new FileReader();
            const r = reader['__zone_symbol__originalInstance'] || reader;
            return new Promise((resolve, reject) => {
                r.onloadend = function () {
                    resolve(this.result);
                };
                r.onerror = function () {
                    return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
                        reject(this.error);
                    });
                };
                r.readAsBinaryString(f);
            });
        });
    }
    get(el) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (this._callback) {
                this._callback([]);
            }
            el.click();
            const files = yield new Promise(resolve => {
                this._callback = resolve;
                Object(rxjs__WEBPACK_IMPORTED_MODULE_2__["fromEvent"])(el, 'change').pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["take"])(1)).subscribe(() => {
                    console.log('files are', el.files);
                    resolve(el.files);
                });
            });
            const result = Array.from(files).map(f => _models__WEBPACK_IMPORTED_MODULE_5__["ModelFactory"].instance({ content: f }, _models__WEBPACK_IMPORTED_MODULE_5__["FileResult"]));
            el.value = '';
            return result;
        });
    }
    serialize(form) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const result = new _models__WEBPACK_IMPORTED_MODULE_5__["FormDataSerialized"]();
            result.boundary = '------WebKitFormBoundaryt32h1LxhGa2YJU6X';
            result.data = '';
            let fileKey;
            form.forEach((value, key) => {
                if (value instanceof File) {
                    fileKey = key;
                    return;
                }
                result.data += `${result.boundary}\x0d\x0aContent-Disposition: form-data; name="${key}"\x0d\x0a\x0d\x0a${value}\x0d\x0a`;
            });
            const f = form.get(fileKey);
            const content = yield this.read(f);
            result.data += `${result.boundary}\x0d\x0aContent-Disposition: form-data; name="${fileKey}"; filename="${f.name}"\x0d\x0aContent-Type: ${f.type}\x0d\x0a\x0d\x0a${content}\x0d\x0a${result.boundary}--\x0d\x0a`;
            return result;
        });
    }
};
FileService = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
], FileService);



/***/ }),

/***/ "./src/ts/services/filepicker.ts":
/*!***************************************!*\
  !*** ./src/ts/services/filepicker.ts ***!
  \***************************************/
/*! exports provided: FilePickerType, FilePicker, FilePickerBuilder, getFilePickerBuilder */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FilePickerType", function() { return FilePickerType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FilePicker", function() { return FilePicker; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "FilePickerBuilder", function() { return FilePickerBuilder; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "getFilePickerBuilder", function() { return getFilePickerBuilder; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/// <reference types="@nextcloud/typings" />


if (window.top && window.top['OC']) {
    window['OC'] = window.top['OC'];
}
var FilePickerType;
(function (FilePickerType) {
    FilePickerType[FilePickerType["Choose"] = 1] = "Choose";
    FilePickerType[FilePickerType["Move"] = 2] = "Move";
    FilePickerType[FilePickerType["Copy"] = 3] = "Copy";
    FilePickerType[FilePickerType["CopyMove"] = 4] = "CopyMove";
})(FilePickerType || (FilePickerType = {}));
class FilePicker {
    constructor(title, multiSelect, mimeTypeFilter, modal, type, directoriesAllowed, path) {
        this.title = title;
        this.multiSelect = multiSelect;
        this.mimeTypeFiler = mimeTypeFilter;
        this.modal = modal;
        this.type = type;
        this.directoriesAllowed = directoriesAllowed;
        this.path = path;
    }
    pick() {
        return new Promise((res, rej) => {
            OC.dialogs.filepicker(this.title, res, this.multiSelect, this.mimeTypeFiler, this.modal, this.type, this.path, {
                allowDirectoryChooser: this.directoriesAllowed
            });
        });
    }
    static download(path) {
        return new Promise(resolve => {
            OC['Files'].getClient().getFileContents(path).then((code, content) => {
                resolve(content);
            });
        });
    }
    static get basePath() {
        return OC['Files'].getClient().getBaseUrl();
    }
    static _getPath(path) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const [err] = yield Object(_models__WEBPACK_IMPORTED_MODULE_1__["to"])(OC['Files'].getClient().getFileInfo(path));
            if (err) {
                return path;
            }
            const p = /^(.*)\.([^\.]+)$/;
            let name = path.replace(p, '$1');
            const ext = name == path ? '' : path.replace(p, '$2');
            const p2 = /^(.*)-([0-9]+)$/;
            let idx = name.replace(p2, '$2');
            if (idx == name) {
                idx = 1;
            }
            else {
                idx = parseInt(idx) + 1;
            }
            name = `${name.replace(p2, '$1')}-${idx.toString()}`;
            return FilePicker._getPath(name + (ext == '' ? '' : '.' + ext));
        });
    }
    static upload(path, content) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const _path = yield FilePicker._getPath(path);
            yield OC['Files'].getClient().putFileContents(_path, content);
            return _path;
        });
    }
}
class FilePickerBuilder {
    constructor(title) {
        this.multiSelect = false;
        this.mimeTypeFiler = [];
        this.modal = true;
        this.type = FilePickerType.Choose;
        this.directoriesAllowed = false;
        this.title = title;
    }
    setMultiSelect(ms) {
        this.multiSelect = ms;
        return this;
    }
    addMimeTypeFilter(filter) {
        this.mimeTypeFiler.push(filter);
        return this;
    }
    setMimeTypeFilter(filter) {
        this.mimeTypeFiler = filter;
        return this;
    }
    setModal(modal) {
        this.modal = modal;
        return this;
    }
    setType(type) {
        this.type = type;
        return this;
    }
    allowDirectories(allow = true) {
        this.directoriesAllowed = allow;
        return this;
    }
    startAt(path) {
        this.path = path;
        return this;
    }
    build() {
        return new FilePicker(this.title, this.multiSelect, this.mimeTypeFiler, this.modal, this.type, this.directoriesAllowed, this.path);
    }
}
function getFilePickerBuilder(title) {
    return new FilePickerBuilder(title);
}


/***/ }),

/***/ "./src/ts/services/layout.ts":
/*!***********************************!*\
  !*** ./src/ts/services/layout.ts ***!
  \***********************************/
/*! exports provided: Layout */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Layout", function() { return Layout; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js");





let Layout = class Layout extends _base__WEBPACK_IMPORTED_MODULE_1__["BaseClass"] {
    get isMobile() {
        return (this._platform.is('desktop') && this._platform.width() < 1024) || this._platform.is('mobile');
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_ionic_angular__WEBPACK_IMPORTED_MODULE_4__["Platform"])
], Layout.prototype, "_platform", void 0);
Layout = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_2__["Injectable"])()
], Layout);



/***/ }),

/***/ "./src/ts/services/logging.ts":
/*!************************************!*\
  !*** ./src/ts/services/logging.ts ***!
  \************************************/
/*! exports provided: Logger, LoggingInstance */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Logger", function() { return Logger; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "LoggingInstance", function() { return LoggingInstance; });
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _environments_environment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../environments/environment */ "./src/environments/environment.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");



class Logger {
    constructor() {
        this.level = typeof (_environments_environment__WEBPACK_IMPORTED_MODULE_1__["environment"].logLevel) == 'undefined' ? _models__WEBPACK_IMPORTED_MODULE_2__["LogLevel"].ERROR : _environments_environment__WEBPACK_IMPORTED_MODULE_1__["environment"].logLevel;
        this.includeStack = _environments_environment__WEBPACK_IMPORTED_MODULE_1__["environment"].logStack;
        this.logged = new _angular_core__WEBPACK_IMPORTED_MODULE_0__["EventEmitter"]();
    }
    // private _sysLog: LoggingService;
    _log(level, ...args) {
        if (level >= this.level) {
            let stack = [];
            if (_environments_environment__WEBPACK_IMPORTED_MODULE_1__["environment"].production) {
            }
            else {
                if (this.includeStack) {
                    stack = Error().stack.split("\n");
                    console.trace();
                    console.log(stack);
                }
                console.log.apply(console, args[0]);
                this.logged.emit({ stack: stack, args: args, level: level });
            }
        }
    }
    handleError(error) {
        console.log('error is', error);
        this._log(_models__WEBPACK_IMPORTED_MODULE_2__["LogLevel"].ERROR, [error.message, (error.stack || '').split("\n")]);
    }
    debug(...args) {
        this._log(_models__WEBPACK_IMPORTED_MODULE_2__["LogLevel"].DEBUG, args);
    }
    info(...args) {
        this._log(_models__WEBPACK_IMPORTED_MODULE_2__["LogLevel"].INFO, args);
    }
    error(...args) {
        this._log(_models__WEBPACK_IMPORTED_MODULE_2__["LogLevel"].ERROR, args);
    }
}
class LoggingInstance {
}
LoggingInstance.logger = new Logger();


/***/ }),

/***/ "./src/ts/services/mails.ts":
/*!**********************************!*\
  !*** ./src/ts/services/mails.ts ***!
  \**********************************/
/*! exports provided: Mails */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Mails", function() { return Mails; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm2015/index.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");
/* harmony import */ var _api__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./api */ "./src/ts/services/api.ts");
/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./store */ "./src/ts/services/store.ts");
/* harmony import */ var _ionic_angular__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @ionic/angular */ "./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js");
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @capacitor/core */ "./node_modules/@capacitor/core/dist/esm/index.js");
/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./utils */ "./src/ts/services/utils.ts");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js");













const { LocalNotifications } = _capacitor_core__WEBPACK_IMPORTED_MODULE_10__["Plugins"];
let Mails = class Mails extends _base__WEBPACK_IMPORTED_MODULE_4__["BaseClass"] {
    constructor() {
        super();
        this.refresh$ = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.refreshed$ = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.newEmails$ = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.folderChanged$ = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
        this.currentAccount$ = new rxjs__WEBPACK_IMPORTED_MODULE_2__["ReplaySubject"](1);
        this._accounts = null;
        this._subscription = null;
        this.setCurrentAccount(null);
        LocalNotifications.addListener('localNotificationActionPerformed', (n) => Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            this._messageClicked(n.notification.extra);
            const pending = yield LocalNotifications.getPending();
            if (pending.notifications.length > 0) {
                LocalNotifications.cancel(pending);
            }
        }));
    }
    get accounts$() {
        if (this._subscription) {
            return this._subscription;
        }
        this._subscription = this._api.ready$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["filter"])(result => result), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["mergeMap"])(() => Object(rxjs__WEBPACK_IMPORTED_MODULE_2__["from"])(this._api.getAccounts())), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["tap"])(accounts => this._accounts = accounts), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["shareReplay"])());
        return this._subscription;
    }
    accountById(id) {
        if (!Array.isArray(this._accounts)) {
            return null;
        }
        return this._accounts.find(a => a.AccountID == id) || null;
    }
    _retrieveFolderById(id, folders) {
        if (folders.length == 0) {
            return null;
        }
        const folder = folders.find(f => f.Id.toLowerCase() == id.toLowerCase());
        if (folder) {
            return folder;
        }
        const subFolders = folders.map(f => f.SubFolders).reduce((acc, v) => acc.concat(v), []);
        return this._retrieveFolderById(id, subFolders);
    }
    folderById$(account, id) {
        return account.Folders$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["take"])(1), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(folders => this._retrieveFolderById(id, folders)));
    }
    setCurrentAccount(email) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (email != null) {
                yield this._store.setCurrentAccount(email);
            }
            return new Promise(resolve => {
                Object(rxjs__WEBPACK_IMPORTED_MODULE_2__["combineLatest"])(Object(rxjs__WEBPACK_IMPORTED_MODULE_2__["from"])(this._store.getCurrentAccount()), this.accounts$).pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["map"])(([email, accounts]) => accounts.length > 0 ? (accounts.find(a => a.Email == email || (email == _models__WEBPACK_IMPORTED_MODULE_6__["COMBINED_ACCOUNT_ID"] && a.AccountID == email)) || accounts[0]) : null), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["take"])(1), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["tap"])(account => this.currentAccount$.next(account)), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_3__["tap"])(() => resolve())).toPromise();
            });
        });
    }
    validate(addresses) {
        if (!Array.isArray(addresses)) {
            return true;
        }
        return addresses.reduce((acc, v) => !acc ? acc : v.Email.match(/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i), true);
    }
    _messageClicked(m) {
        this._router.navigateByUrl(`readmail:${m.Uid}`);
    }
    _getFrom(m) {
        const from = m.From && Array.isArray(m.From.Collection) && m.From.Collection.length > 0 ? m.From.Collection[0] : null;
        if (!from) {
            return 'New message';
        }
        return from.DisplayName || from.Email;
    }
    _doNotify(messages) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const callback = this._messageClicked.bind(this);
            if (this._platform.is('desktop')) {
                if (window.Notification.permission != 'granted') {
                    const perm = yield window.Notification.requestPermission();
                    if (perm != 'granted') {
                        return;
                    }
                }
                const notifications = [];
                messages.forEach(m => {
                    const x = new window.Notification(this._getFrom(m), { body: m.Subject });
                    x.onclick = () => {
                        callback(m);
                        notifications.forEach(n => n.close());
                    };
                    notifications.push(x);
                });
                return;
            }
            const perm = yield LocalNotifications.requestPermission();
            if (!perm.granted) {
                return;
            }
            yield LocalNotifications.schedule({
                notifications: messages.map(m => ({
                    title: this._getFrom(m),
                    body: m.Subject,
                    id: parseInt(m.Uid),
                    extra: m,
                })),
            });
        });
    }
    showNotifications(lastMsg, messages) {
        const ts = (lastMsg && lastMsg.TimeStampInUTC) || 1;
        if (messages[0].TimeStampInUTC <= ts) {
            return;
        }
        this._doNotify(messages.filter(m => m.TimeStampInUTC > ts));
    }
    messageInComposedFolder(msg, folder) {
        if (!_utils__WEBPACK_IMPORTED_MODULE_11__["Utils"].isCombinedFolder(folder.Id)) {
            return msg.Folder == folder.Id;
        }
        if (!this._accounts) {
            return false;
        }
        const a = this._accounts.find(a => a.AccountID == msg.AccountID);
        if (!a) {
            return false;
        }
        const f = a.FoldersOrder.find(f => f.Id == msg.Folder);
        if (!f) {
            return false;
        }
        return f.Type == folder.Type;
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_api__WEBPACK_IMPORTED_MODULE_7__["Api"])
], Mails.prototype, "_api", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_store__WEBPACK_IMPORTED_MODULE_8__["Store"])
], Mails.prototype, "_store", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_ionic_angular__WEBPACK_IMPORTED_MODULE_9__["Platform"])
], Mails.prototype, "_platform", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_5__["NgInject"])(_angular_router__WEBPACK_IMPORTED_MODULE_12__["Router"])
], Mails.prototype, "_router", void 0);
Mails = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
], Mails);



/***/ }),

/***/ "./src/ts/services/navigation.ts":
/*!***************************************!*\
  !*** ./src/ts/services/navigation.ts ***!
  \***************************************/
/*! exports provided: Navigation */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Navigation", function() { return Navigation; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _angular_router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @angular/router */ "./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! rxjs */ "./node_modules/rxjs/_esm2015/index.js");
/* harmony import */ var rxjs_operators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! rxjs/operators */ "./node_modules/rxjs/_esm2015/operators/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");







let Navigation = class Navigation extends _base__WEBPACK_IMPORTED_MODULE_5__["BaseClass"] {
    constructor() {
        super();
        this.routeData$ = new rxjs__WEBPACK_IMPORTED_MODULE_3__["ReplaySubject"](1);
        this.routeParams$ = new rxjs__WEBPACK_IMPORTED_MODULE_3__["ReplaySubject"](1);
        this._router.events.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["filter"])(ev => ev instanceof _angular_router__WEBPACK_IMPORTED_MODULE_2__["NavigationEnd"])).subscribe(() => {
            this.routeData$.next(this._route.root.firstChild.snapshot.data);
            this.routeParams$.next(this._route.firstChild.snapshot.params);
        });
    }
    connectToRoute(key) {
        return this.routeParams$.pipe(Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["filter"])(p => Object.keys(p).indexOf(key) != -1), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["map"])(p => p[key]), Object(rxjs_operators__WEBPACK_IMPORTED_MODULE_4__["distinctUntilChanged"])());
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_6__["NgInject"])(_angular_router__WEBPACK_IMPORTED_MODULE_2__["Router"])
], Navigation.prototype, "_router", void 0);
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_6__["NgInject"])(_angular_router__WEBPACK_IMPORTED_MODULE_2__["ActivatedRoute"])
], Navigation.prototype, "_route", void 0);
Navigation = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
], Navigation);



/***/ }),

/***/ "./src/ts/services/nextcloud.ts":
/*!**************************************!*\
  !*** ./src/ts/services/nextcloud.ts ***!
  \**************************************/
/*! exports provided: Nextcloud */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Nextcloud", function() { return Nextcloud; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _filepicker__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./filepicker */ "./src/ts/services/filepicker.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./store */ "./src/ts/services/store.ts");






const PATH_KEY = 'nextcloud-last-path';
let Nextcloud = class Nextcloud extends _base__WEBPACK_IMPORTED_MODULE_2__["BaseClass"] {
    isNextcloud() {
        return window.top && window.top['OC'];
    }
    _processLastPath(x) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (x.length > 0) {
                yield this._store.save(PATH_KEY, x[0].replace(/^(.*)\/[^\/]+$/g, '$1'));
            }
        });
    }
    pickFile() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const lastPath = yield this._store.load(PATH_KEY, undefined, '/');
            const picker = new _filepicker__WEBPACK_IMPORTED_MODULE_3__["FilePicker"]('Choose a file', true, [], true, 1, false, lastPath);
            const result = yield picker.pick();
            yield this._processLastPath(result);
            return result;
        });
    }
    pickFolder() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const lastPath = yield this._store.load(PATH_KEY, undefined, '/');
            const picker = new _filepicker__WEBPACK_IMPORTED_MODULE_3__["FilePicker"]('Choose a folder', false, ['*.zzz'], true, 1, true, lastPath);
            const result = yield picker.pick();
            yield this._processLastPath([result]);
            return result;
        });
    }
    download(path) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const content = yield fetch(`${_filepicker__WEBPACK_IMPORTED_MODULE_3__["FilePicker"].basePath}/${path}`);
            const blob = yield content.blob();
            const bin = yield blob.arrayBuffer();
            return bin;
            // return new File([content], path.replace(/^.*\/([^\/]+)$/, '$1'));
        });
    }
    upload(path, content) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            return _filepicker__WEBPACK_IMPORTED_MODULE_3__["FilePicker"].upload(path, content);
        });
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_4__["NgInject"])(_store__WEBPACK_IMPORTED_MODULE_5__["Store"])
], Nextcloud.prototype, "_store", void 0);
Nextcloud = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
], Nextcloud);



/***/ }),

/***/ "./src/ts/services/route-reuse.ts":
/*!****************************************!*\
  !*** ./src/ts/services/route-reuse.ts ***!
  \****************************************/
/*! exports provided: DefaultRouteReuseStrategy */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "DefaultRouteReuseStrategy", function() { return DefaultRouteReuseStrategy; });
class DefaultRouteReuseStrategy {
    shouldDetach(route) {
        return false;
    }
    store(route, detachedTree) { }
    shouldAttach(route) {
        return false;
    }
    retrieve(route) {
        return null;
    }
    shouldReuseRoute(future, curr) {
        return true;
    }
}


/***/ }),

/***/ "./src/ts/services/settings.ts":
/*!*************************************!*\
  !*** ./src/ts/services/settings.ts ***!
  \*************************************/
/*! exports provided: Settings */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Settings", function() { return Settings; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators */ "./src/ts/decorators.ts");
/* harmony import */ var _store__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./store */ "./src/ts/services/store.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");






const SERVER_KEY = 'server';
const PAGE_SIZE_KEY = 'page-size';
const MESSAGE_TYPE_KEY = 'message-type';
const CHECK_INTERVAL = 'check-emails-interval';
const EMAIL_INTERVAL_OPTIONS = [
    { label: '1 minute', value: 60 * 1000 },
    { label: '5 minutes', value: 60 * 1000 * 5 },
    { label: '10 minutes', value: 60 * 1000 * 10 },
    { label: '15 minutes', value: 60 * 1000 * 15 },
    { label: 'Never', value: 0 },
];
const MESSAGE_TYPE_OPTIONS = [
    { label: 'Html', value: 'HTML' },
    { label: 'Plain text', value: 'TEXT' },
];
const PAGE_SIZE = [
    { label: '20 messages', value: 20 },
    { label: '50 messages', value: 50 },
    { label: '100 messages', value: 100 },
];
let Settings = class Settings extends _base__WEBPACK_IMPORTED_MODULE_2__["BaseClass"] {
    constructor() {
        super(...arguments);
        this.serverSet$ = new _angular_core__WEBPACK_IMPORTED_MODULE_1__["EventEmitter"]();
    }
    getServer() {
        return this._store.load(SERVER_KEY, _models__WEBPACK_IMPORTED_MODULE_5__["ServerSetting"]);
    }
    setServer(servers) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            servers.users.forEach(u => u.pass = null);
            const result = yield this._store.save(SERVER_KEY, servers);
            this.serverSet$.emit();
            return result;
        });
    }
    getPageSize() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            return this._store.load(PAGE_SIZE_KEY, undefined, 20);
        });
    }
    setPageSize(s) {
        return this._store.save(PAGE_SIZE_KEY, s);
    }
    getMessageType() {
        return this._store.load(MESSAGE_TYPE_KEY, undefined, 'HTML');
    }
    setMessageType(type) {
        return this._store.save(MESSAGE_TYPE_KEY, type);
    }
    getCheckoutEmailInterval() {
        return this._store.load(CHECK_INTERVAL, undefined, 60 * 1000 * 15);
    }
    setCheckoutEmailInterval(value) {
        return this._store.save(CHECK_INTERVAL, value);
    }
    _toAppSetting(x, options) {
        const result = new _models__WEBPACK_IMPORTED_MODULE_5__["AppSetting"]();
        result.model = options.find(o => o.value == x);
        result.options = options;
        return result;
    }
    get appSettings() {
        return new Promise(resolve => {
            const model = new _models__WEBPACK_IMPORTED_MODULE_5__["AppSettings"]();
            const p = [];
            p.push(this.getCheckoutEmailInterval().then(x => model.checkEmailInterval = this._toAppSetting(x, EMAIL_INTERVAL_OPTIONS)));
            p.push(this.getMessageType().then(x => model.composeType = this._toAppSetting(x, MESSAGE_TYPE_OPTIONS)));
            p.push(this.getPageSize().then(x => model.pageSize = this._toAppSetting(x, PAGE_SIZE)));
            p.push(this.getServer().then(x => model.server = x));
            Promise.all(p).then(() => resolve(model));
        });
    }
    saveSettings(settings) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const p = [];
            p.push(this.setServer(settings.server));
            p.push(this.setCheckoutEmailInterval(settings.checkEmailInterval.model.value));
            p.push(this.setMessageType(settings.composeType.model.value));
            p.push(this.setPageSize(settings.pageSize.model.value));
            yield Promise.all(p);
        });
    }
    needAuthenticating(server) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            if (!server) {
                return [];
            }
            const current = yield this.getServer();
            if (!current || current.url != server.url) {
                return server.users;
            }
            return server.users.filter(u => !u.token || u.pass);
        });
    }
};
Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_decorators__WEBPACK_IMPORTED_MODULE_3__["NgInject"])(_store__WEBPACK_IMPORTED_MODULE_4__["Store"])
], Settings.prototype, "_store", void 0);
Settings = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
], Settings);



/***/ }),

/***/ "./src/ts/services/store.ts":
/*!**********************************!*\
  !*** ./src/ts/services/store.ts ***!
  \**********************************/
/*! exports provided: Store */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Store", function() { return Store; });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "./node_modules/tslib/tslib.es6.js");
/* harmony import */ var _angular_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @angular/core */ "./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js");
/* harmony import */ var _capacitor_core__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @capacitor/core */ "./node_modules/@capacitor/core/dist/esm/index.js");
/* harmony import */ var _base__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../base */ "./src/ts/base.ts");
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");





const { Storage } = _capacitor_core__WEBPACK_IMPORTED_MODULE_2__["Plugins"];
const PREFIX = 'afterlogic-client-';
const CURRENT_ACCOUNT = 'current-account';
let Store = class Store extends _base__WEBPACK_IMPORTED_MODULE_3__["BaseClass"] {
    load(key, type, defValue) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            const result = yield Storage.get({ key: PREFIX + key });
            if (!result.value) {
                return defValue ? defValue : null;
            }
            return _models__WEBPACK_IMPORTED_MODULE_4__["ModelFactory"].instance(JSON.parse(result.value).data, type);
        });
    }
    save(key, data) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            Storage.set({ key: PREFIX + key, value: JSON.stringify({ data: data, date: new Date() }) });
        });
    }
    getCurrentAccount() {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            return this.load(CURRENT_ACCOUNT);
        });
    }
    setCurrentAccount(email) {
        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__awaiter"])(this, void 0, void 0, function* () {
            return this.save(CURRENT_ACCOUNT, email);
        });
    }
};
Store = Object(tslib__WEBPACK_IMPORTED_MODULE_0__["__decorate"])([
    Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__["Injectable"])()
], Store);



/***/ }),

/***/ "./src/ts/services/utils.ts":
/*!**********************************!*\
  !*** ./src/ts/services/utils.ts ***!
  \**********************************/
/*! exports provided: Utils */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Utils", function() { return Utils; });
/* harmony import */ var _models__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../models */ "./src/ts/models.ts");

class Utils {
    static avatarColor(contact) {
        const name = contact.DisplayName || contact.Email;
        let hash = 0;
        for (var i = 0; i < name.length; i++) {
            hash = name.charCodeAt(i) + ((hash << 5) - hash);
        }
        let h = hash % 360;
        return 'hsl(' + h + ', 50%, 50%)';
    }
    static extractCollection(c) {
        if (!c || !Array.isArray(c.Collection)) {
            return [];
        }
        return c.Collection;
    }
    static userByEmail(users, email) {
        return users.find(u => u.email == email);
    }
    static _searchFolder(folders, predicate) {
        if (!Array.isArray(folders) || folders.length == 0) {
            return null;
        }
        const result = folders.find(predicate);
        return result || Utils._searchFolder(folders.map(f => f.SubFolders).reduce((acc, v) => acc.concat(v), []), predicate);
    }
    static folderByType(type, folders) {
        return Utils._searchFolder(folders, (f => f.Type == type));
    }
    static setFolderTypes(data, folders) {
        if (data.length == 0) {
            return;
        }
        data.forEach(_f => {
            const f = Utils.folderById(folders, _f['FullName']);
            if (!f) {
                return;
            }
            f.Type = _f['Type'];
        });
        this.setFolderTypes(data
            .filter(d => !!d['SubFolders'] && Array.isArray(d['SubFolders']['@Collection']))
            .map(d => d['SubFolders']['@Collection'])
            .reduce((acc, v) => acc.concat(v), []), folders);
    }
    static folderById(folders, id) {
        return Utils._searchFolder(folders, (f => f.Id == id));
    }
    static isDraftReply(msg) {
        return !!msg.DraftUid && msg.DraftInfo && Array.isArray(msg.DraftInfo) && msg.DraftInfo.length >= 3;
    }
    static emptySearch(model) {
        return !model.from && !model.to && !model.text && !model.till
            && !model.since && !model.simple && !model.subject && !model.attachments;
    }
    static buildUserMenu(server, callback) {
        if (!server || !Array.isArray(server.users)) {
            return [];
        }
        const f = (ev) => callback(ev.item);
        const result = server.users.map(u => ({
            label: u.email, icon: "fa fa-user", command: f, id: u.email,
        }));
        if (server.users.length > 1) {
            result.push({ label: 'Combined view', icon: 'fa fa-users', command: f, id: _models__WEBPACK_IMPORTED_MODULE_0__["COMBINED_ACCOUNT_ID"] });
        }
        result.push({ label: 'Settings', icon: 'fa fa-cog', command: f, id: 'settings' });
        return result;
    }
    static isComposedResult(x) {
        return Array.isArray(x) && x.length > 0 && x[0] instanceof _models__WEBPACK_IMPORTED_MODULE_0__["ComposedResult"];
    }
    static isCombinedFolder(id) {
        if (!id.match(/^[0-9]+$/)) {
            return false;
        }
        return [_models__WEBPACK_IMPORTED_MODULE_0__["FolderType"].Sent, _models__WEBPACK_IMPORTED_MODULE_0__["FolderType"].Spam, _models__WEBPACK_IMPORTED_MODULE_0__["FolderType"].Inbox, _models__WEBPACK_IMPORTED_MODULE_0__["FolderType"].Trash, _models__WEBPACK_IMPORTED_MODULE_0__["FolderType"].Drafts].indexOf(parseInt(id)) != -1;
    }
    static foldersFlatList(folders, result) {
        result.push.apply(result, folders);
        folders.forEach(f => Utils.foldersFlatList(f.SubFolders, result));
    }
    static foldersDiff(f1, f2) {
        if (f1.toLowerCase() == f2.toLowerCase()) {
            return false;
        }
        if (f1.toLowerCase() == "inbox" && f2.toLowerCase() == _models__WEBPACK_IMPORTED_MODULE_0__["FolderType"].Inbox.toString()) {
            return false;
        }
        return f1.toLowerCase() != f2.toLowerCase();
    }
}


/***/ }),

/***/ 0:
/*!***************************!*\
  !*** multi ./src/main.ts ***!
  \***************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

module.exports = __webpack_require__(/*! /home/lixa/programs/afterlogic-client/src/main.ts */"./src/main.ts");


/***/ })

},[[0,"runtime","vendor"]]]);
//# sourceMappingURL=main-es2015.js.map